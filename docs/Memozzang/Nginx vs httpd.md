# Nginx vs Apache httpd

- Youtube [10분 테코톡 피케이의 Nginx](https://www.youtube.com/watch?v=6FAwAXXj5N0)를 보고 실제 성능이 어떻게, 얼마나 차이가 나는지 궁금해짐

- Nginx / Httpd prefork MPM / httpd event MPM 비교

- Nginx
    - 장점
        - 높은 성능: Event driven 비동기 처리 방식으로 고성능 웹서버로 유명함
        - 적은 자원 사용: 단일 스레드 방식으로 동작하여 자원 소비가 적음
        - 높은 안정성: 안정적인 운영 환경을 보장
        - Reverse Proxy 및 Load Balancing 기능 지원: Reverse Proxy 기능을 이용해 요청을 웹 서버 및 애플리케이션 서버로 전달하고, Load Balancing 기능을 이용해 트래픽 분산 처리 가능
    - 단점
        - 정적인 콘텐츠 제공에 최적화되어 있어 동적인 컨텐츠를 처리하는 데는 적합하지 않음
        - SSL/TLS 암호화 처리가 필요한 경우 OpenSSL이 설치돼 있어야 함
- httpd Prefork MPM
    - 장점
        - 다중 프로세스 방식으로 동작하여 안정적인 운영 환경을 보장
        - 정적인 콘텐츠 제공에 최적화되어 있어 단순한 파일 서버로서의 기능을 제공
        - 다양한 모듈을 지원하고, 확장성이 높음
    - 단점
        - 다중 프로세스 방식이기 때문에, 많은 자원을 필요로 하며 트래픽이 많을 때 성능이 저하될 수 있음
        - 다중 프로세스 방식이기 때문에 프로세스 간 통신에 대한 오버헤드가 발생할 수 있음
- httpd Event MPM
    - 장점
        - 이벤트 기반 비동기 처리 방식으로 고성능 웹서버로 유명함
        - 다중 스레드 방식으로 동작하여 Prefork MPM과 달리 성능을 높이면서 자원 소비를 줄일 수 있음
        - 정적인 콘텐츠 제공에 최적화되어 있어 단순한 파일 서버로서의 기능을 제공
    - 단점
        - 다중 스레드 방식이기 때문에, 스레드 간 동기화 문제에 대한 대처가 필요함
        - 프로세스가 생성되는 횟수를 최소화하는 Prefork MPM에 비해, Event MPM의 경우 모듈 등과 같은 추가적인 오버헤드가 발생할 수 있음

Prefork MPM은 각각의 요청이 별도의 프로세스로 처리됩니다. 따라서 각각의 요청에 대해 별도의 메모리 공간을 할당하게 됩니다. 이는 요청당 메모리 사용량이 높은 경우에는 서버의 부하를 높이게 됩니다. 그러나 프로세스 간의 메모리 공간이 분리되어 있기 때문에 안정성 면에서는 이점이 있습니다
open file limit은 Prefork MPM에서 발생하는 경우가 많습니다. Prefork MPM에서는 하나의 프로세스가 하나의 요청을 처리하기 위해 하나의 스레드를 생성하게 됩니다. 이 때문에 많은 요청이 동시에 발생하면 많은 프로세스와 스레드가 생성되어 open file limit을 초과할 가능성이 있습니다. Event MPM에서는 하나의 프로세스 내에서 여러 개의 요청을 처리하기 때문에 Prefork MPM보다 open file limit의 문제가 적습니다.