# Toy-1

!!! tip
    ğŸ’¡ ìœ í˜• : ê°œì¸ í† ì´ í”„ë¡œì íŠ¸

## ëª©í‘œ

---

- ì—¬íƒœ í•™ìŠµí•´ì™”ë˜ ê°ì¢… ê¸°ìˆ ë“¤ì„ ì‹¤ì œë¡œ í™œìš©í•´ë³¸ ê²½í—˜ì„ ê°€ì ¸ë³´ê³  ë¬¸ì œí•´ê²° ëŠ¥ë ¥ì„ í‚¤ìš°ê¸° ê°„ë‹¨í•œ ì¸í”„ë¼ë¥¼ êµ¬ì¶•í•´ë³´ê³  ì‹¶ì—ˆìŠµë‹ˆë‹¤

## ì„œë¹„ìŠ¤ ìš”ì•½

---

- ì¸ë ¥í’€ì— ì§€ì›ìë¥¼ ë“±ë¡í•  ìˆ˜ ìˆëŠ” ì„œë¹„ìŠ¤ë¥¼ ë„ì»¤ë¥¼ í™œìš©í•œ ë©€í‹°ì»¨í…Œì´ë„ˆ ì¸í”„ë¼ë¥¼ ì ìš©í•˜ì—¬ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤

## êµ¬ì„±ë„

---

- Service Flow
    
    ![Project-1/Untitled.png](Project-1/Untitled.png)
    
- DEV Flow
    
    ![Project-1/Untitled%201.png](Project-1/Untitled%201.png)
    
- AWS ì¸í”„ë¼ êµ¬ì„±ë„
    
    ![Project-1/Untitled%202.png](Project-1/Untitled%202.png)
    

## ê° ê¸°ìˆ ë“¤ì˜ ì„ íƒ ì´ìœ 

---

- ë³¸ í”„ë¡œì íŠ¸ëŠ” ì„œë¹„ìŠ¤ê°€ ì›í™œí•˜ê²Œ ë™ì‘í•  ìˆ˜ ìˆëŠ” ì¸í”„ë¼ë¥¼ êµ¬ì„±í•˜ëŠ”ë° ì¤‘ì ì„ ë‘ê³ ìˆìŠµë‹ˆë‹¤. í”„ë¡œê·¸ë˜ë°ì„ ìµœì†Œí™” í•˜ê¸° ìœ„í•´ ì˜ ë‹¤ë£° ìˆ˜ ìˆëŠ” ì–¸ì–´ì¸ Pythonì„ ì‚¬ìš©í•˜ê³ ,  ë¹ ë¥´ê²Œ ì›¹ ì„œë¹„ìŠ¤ë¥¼ êµ¬ë™í•  ìˆ˜ ìˆëŠ” Flask í”„ë ˆì„ì›Œí¬ë¥¼ ì´ìš©í–ˆìŠµë‹ˆë‹¤.
- CICD ì†”ë£¨ì…˜ìœ¼ë¡œ Cloudbase + public repository ë¬´ë£Œ + multi container ì‚¬ìš©ê°€ëŠ¥ ì¡°ê±´ì„ ë§ì¶°ì¤„ ìˆ˜ ìˆëŠ” Travis CIë¥¼ ì±„íƒí•˜ì˜€ìŠµë‹ˆë‹¤
[https://djangostars.com/blog/continuous-integration-circleci-vs-travisci-vs-jenkins/](https://djangostars.com/blog/continuous-integration-circleci-vs-travisci-vs-jenkins/)
- Apacheì™€ Nginxì¤‘ ë¹„ë™ê¸°ë¥¼ ì´ìš©í•´ ë§ì€ ë™ì‹œì ‘ì† íŠ¸ë˜í”½ì´ ìˆ˜ìš©ê°€ëŠ¥í•œ Nginxë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤ [https://kinsta.com/blog/nginx-vs-apache/](https://kinsta.com/blog/nginx-vs-apache/)
- Flaskì˜ ê¸°ë³¸ ë‚´ì¥ì„œë²„ëŠ” ëŒ€ìš©ëŸ‰ì²˜ë¦¬ì— ë¶€ì í•©í•˜ê¸° ë•Œë¬¸ì— WSGIë¥¼ ì ìš©í–ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%203.png](Project-1/Untitled%203.png)
    
- WSGIêµ¬í˜„ì— gunicornì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤
- DBìƒì„± í›„ ìŠ¤í‚¤ë§ˆë¥¼ ë³€ê²½í•  ì¼ì´ ì—†ê¸° ë–„ë¬¸ì— SQLì„ ì‚¬ìš©í•˜ëŠ”ë°, ì¶”í›„ RDSë¡œ ë§ˆì´ê·¸ë ˆì´ì…˜ë„ ê°€ëŠ¥í•œ MySQLì„ ì‚¬ìš©í•˜ì˜€ìŠµë‹ˆë‹¤
- ë©€í‹°ì»¨í…Œì´ë„ˆìš© Beanstalkë³´ë‹¨ ì¶”í›„ ì»¤ìŠ¤í…€ì´ ììœ ë¡œìš´ EC2 ì„œë¹„ìŠ¤ë¥¼ ì„ íƒí•˜ì˜€ìŠµë‹ˆë‹¤
- fault toleranceì•Œê³ ë¦¬ì¦˜ì„ ìœ„í•´ EC2 ì¸ìŠ¤í„´ìŠ¤ ìˆ˜ëŠ” í™€ìˆ˜ë¡œ êµ¬ì„±í•˜ì˜€ìŠµë‹ˆë‹¤
[https://docs.docker.com/engine/swarm/admin_guide/](https://docs.docker.com/engine/swarm/admin_guide/)

## ì—ëŸ¬ ìˆ˜ì • ê¸°ë¡

---

- Dockerì—ì„œ Flask ì„œë²„ë¥¼ ë„ìš¸ ë•Œ Hostì£¼ì†ŒëŠ” 0.0.0.0
- wsgiìš© íŒŒì´ì¬ íŒŒì¼ì„ ë³„ë„ë¡œ ë¶„ë¦¬í•˜ê³  í¬íŠ¸ í• ë‹¹í•˜ê¸°
- ìµœì‹  uWSGIëŠ” [musl](https://en.wikipedia.org/wiki/Musl)ì„ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì— [https://stackoverflow.com/questions/36217250/cannot-install-uwsgi-on-alpine](https://stackoverflow.com/questions/36217250/cannot-install-uwsgi-on-alpine)
[https://github.com/gliderlabs/docker-alpine/issues/158](https://github.com/gliderlabs/docker-alpine/issues/158)
RUN apk add python3-dev build-base linux-headers pcre-dev ëª…ë ¹ì„ ì¶”ê°€í•©ë‹ˆë‹¤
- ì´ìœ ì—†ì´ ë­”ê°€ ì˜ ì•ˆë˜ë©´ ì¼ë‹¨ YAML ë„ì–´ì“°ê¸°ë¶€í„° í™•ì¸
- Nginx ë¼ìš°íŒ… ì„¤ì •ì‹œ URI ë§ˆì§€ë§‰ì— / ì¶”ê°€
[https://askubuntu.com/questions/1173951/all-routes-except-return-404-from-nginx-running-flask-wsgi](https://askubuntu.com/questions/1173951/all-routes-except-return-404-from-nginx-running-flask-wsgi)
- EC2 ì¸ìŠ¤í„´ìŠ¤ì— ê¹Œë¨¹ì§€ ë§ê³  ì‚¬ìš©ì ë°ì´í„° ëª…ì‹œí•  ê²ƒ
user_data ì‚¬ìš©ì‹œ terraform init ë‹¤ì‹œ í•´ì•¼ í•¨
- EC2 ì¸ìŠ¤í„´ìŠ¤ì— ìë™ìœ¼ë¡œ CodeDeploy Agent ì„¤ì¹˜í•˜ë ¤ë©´ CodeDeploy ì ‘ê·¼ê°€ëŠ¥ ì—­í• ì„ ë¨¼ì € ë¶€ì—¬í•  ê²ƒ
- ì˜¤ë¥˜ í•´ê²°ì„ ìœ„í•´ ì´ê²ƒ ì €ê²ƒ í•´ë³´ëŠë¼ ëª‡ ì‹œê°„ ê¹Œì§€ ê±¸ë¦¬ëŠ” ê²ƒì€ ë‹¹ì—°í•œ ê²ƒ..
    
    ![Project-1/Untitled%204.png](Project-1/Untitled%204.png)
    
- ìœ ì €ë°ì´í„°ì— í”„ë¡œê·¸ë¨ ì„¤ì¹˜ ëª…ë ¹ì„ ë„£ìœ¼ë©´ ë‹¹ì—°íˆ ì„¤ì¹˜ ë  ë•Œ ê¹Œì§€ ê¸°ë‹¤ë ¤ì•¼ í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%205.png](Project-1/Untitled%205.png)
    
- HTTPë‘ HTTPSë‘ í—·ê°ˆë¦¬ì§€ ë§ê²ƒã…œã…œã…œã…œ(ì œì¼ ì–´ì´ ì—†ë˜ ë¶€ë¶„)
- HTMLì€ ì˜ ë‚˜ì˜¤ì§€ë§Œ CSS, JS ë¡œë“œê°€ ì•ˆë˜ë©´ Nginx ì„¤ì • ë¬¸ì œ
- ì •ì ì»¨í…ì¸  s3 í˜¸ìŠ¤íŒ…ì„ ìœ„í•œ ì´ë™ìœ¼ë¡œ cp */*/*.css */*/*.js ./deploy ì´ëŸ°ê²ƒë„ ê°€ëŠ¥
- S3ì— static resource ë¶„ë¦¬í•  ë•Œ public access ê¶Œí•œ ì ê²€í•˜ê¸°
- S3 ë²„í‚·ì •ì±… ë§Œë“¤ ë•Œ ë¦¬ì†ŒìŠ¤ì— /* ë¶™ì´ê¸°[https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources](https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources)
- í…Œë¼í¼ì—ì„œ ë³´ì•ˆê·¸ë£¹ ìŠ¤ìŠ¤ë¡œë¥¼ ì†ŒìŠ¤ë¡œ ì‚¬ìš©í•˜ë ¤ë©´ IDë¥¼ ë„£ì§€ ë§ê³  self = true ì´ìš©í•˜ê¸°
[https://stackoverflow.com/questions/49995417/self-reference-not-allowed-in-security-group-definition](https://stackoverflow.com/questions/49995417/self-reference-not-allowed-in-security-group-definition)
- ì˜¤ì¼€ìŠ¤íŠ¸ë ˆì´ì…˜ êµ¬ì¶•í•  ë–„ í¼ë¸”ë¦­ IP ë§ê³  í”„ë¼ì´ë¹— IPë¡œ êµ¬ì¶•
- EC2 í”„ë¼ì´ë¹— IP ê°€ì ¸ì˜¤ê¸°â­
    - /sbin/ifconfig eth0 | grep 'inet' | cut -d: -f2 | awk '{print $2}'
    - hostname -i
- ì§„ìí…œí”Œë¦¿ ì‚¬ìš©ì‹œ ëŒ€ì†Œë¬¸ì êµ¬ë¶„ í•„ìˆ˜(íŠ¹íˆ ë©”ì†Œë“œ ë¶€ë¶„)
- Nginxì—ì„œ ë°”ë¡œ POST ë©”ì†Œë“œë¥¼ ì‚¬ìš©í• ê²½ìš° ë¦¬ë‹¤ì´ë ‰ì…˜ ë°œìƒ
    
    â†’ [https://stackoverflow.com/questions/27795068/nginx-rewrite-post-data](https://stackoverflow.com/questions/27795068/nginx-rewrite-post-data)
    
- Applyì„œë²„ì— POST, Resultì„œë²„ì— GET ë°©ì‹ì„ ì ìš©í–ˆìŠµë‹ˆë‹¤
- ê¹ƒ ë¸Œëœì¹˜ë¡œ ê´€ë¦¬í•  ë–„ í…Œë¼í¼ ì—‰ë§ì´ ë˜ì§€ ì•Šë„ë¡ ì£¼ì˜í•˜ê¸°
- ë„ì»¤ìŠ¤ì›œì€ ë„ì»¤ì»´í¬ì¦ˆíŒŒì¼ì„ ìŠ¤íƒìœ¼ë¡œ ì´ìš©í•´ êµ¬ë™ ê°€ëŠ¥[https://docs.docker.com/engine/swarm/stack-deploy/](https://docs.docker.com/engine/swarm/stack-deploy/)
- ë„ì»¤ìŠ¤íƒ êµ¬ë™ì‹œ ì»¨í…Œì´ë„ˆ ì‹¤í–‰ìì²´ê°€ ë¬¸ì œì¼ ê²½ìš° ì»´í¬ì¦ˆë¥¼ í•œ ë²ˆ ëŒë ¤ë³´ë©´ ì‹¤ë§ˆë¦¬ë¥¼ ì°¾ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%206.png](Project-1/Untitled%206.png)
    
- RDSê°€ í”„ë¼ì´ë¹— ì„œë¸Œë„·ì— ì¡´ì¬í•˜ë©´ Travisì—ì„œ ì½”ë“œí…ŒìŠ¤íŠ¸ë¥¼ ì§„í–‰í•  ë•Œ RDSì— ì ‘ì†ì‹¤íŒ¨í•˜ì—¬ í…ŒìŠ¤íŠ¸ ì‹¤íŒ¨ë¡œ ì´ì–´ì§€ëŠ” ê²ƒì— ì£¼ì˜
- MySQL ì ‘ì† ì»¤ë§¨ë“œ
    
    ```s
    mysql -h myapp.cnr20hoyd3cu.ap-northeast-2.rds.amazonaws.com -P 3306 -u root -p
    ```
    
- ë„ì»¤ ìŠ¤ì›œëª¨ë“œ ì—ëŸ¬ í™•ì¸
    
    â†’  docker service logs {SERVICE} ëª…ë ¹ìœ¼ë¡œ ë¡œê·¸ í™•ì¸ ê°€ëŠ¥
    
    ![Project-1/Untitled%207.png](Project-1/Untitled%207.png)
    

## TODO

---

- IaC
    - [x]  Terraform
    - [ ]  Terraform ê³ ë„í™”
- CICD
    - [x]  Container(Dockerfile)
        - [x]  Flask + gunicorn
        - [x]  MySQL
        - [x]  Nginx
    - [x]  Docker Compose
    - [x]  Travis CI
    - [x]  CodeDeploy
    - [x]  ë°°í¬ ì™„ë£Œ í›„ êµ¬ë™ ì„¸íŒ…
    - [x]  EC2
    - [ ]  CIë¥¼ ìœ„í•œ í…ŒìŠ¤íŠ¸ì½”ë“œ ì‘ì„±
- Server
    - [x]  HTML CSS í‹€ ë§Œë“¤ê¸°
    - [x]  RDS, MySQL ì—°ê²°
    - [x]  ê¸°ëŠ¥ ì œì‘
- Orchestration
    - [x]  Swarm Mode

# Part 1 - CICD

## CodeDeploy(ì½˜ì†”)

1. ìƒˆë¡œìš´ CodeDeploy ì‘ì—… ìƒì„±
    
    ![Project-1/Untitled%208.png](Project-1/Untitled%208.png)
    
2. ë°°í¬ê·¸ë£¹ ìƒì„±
    
    ![Project-1/Untitled%209.png](Project-1/Untitled%209.png)
    
3. íƒœê·¸ë¥¼ ì´ìš©í•´ EC2ë¥¼ ì§€ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2010.png](Project-1/Untitled%2010.png)
    
4. AWS SMì„ ì‚¬ìš©í•˜ì§€ ì•Šê³  ì§ì ‘ CodeDeployë¥¼ ì„¤ì¹˜í•˜ì˜€ìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2011.png](Project-1/Untitled%2011.png)
    
5. CodeDeployì— ë°°í¬ ê´€ë ¨ ì„¤ì •ì„ ì§„í–‰í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2012.png](Project-1/Untitled%2012.png)
    

## EC2 ë°°í¬ ì„¤ì •

---

1. CodeDeploy Agent ì„¤ì¹˜
    
    ```s
    aws s3 cp s3://aws-codedeploy-ap-northeast-2/latest/install . --region ap-northeast-2
    sudo yum install -y ruby wget
    chmod +x ./install
    sudo ./install auto
    sudo service codedeploy-agent start
    sudo service codedeploy-agent status
    ```
    
2. Docker ì„¤ì¹˜
    
    ```s
    sudo yum -y install docker
    sudo systemctl start docker
    sudo systemctl enable docker 
    sudo usermod -aG docker ec2-user
    ```
    
    ê¶Œí•œ ë¬¸ì œë¡œ docker ps -a ëª…ë ¹ì´ ë¶ˆê°€ëŠ¥ í•  ê²½ìš°
    
    ```s
    sudo chmod 666 /var/run/docker.sock
    ```

3. ë”°ë¼ì„œ í…Œë¼í¼ì— ì‘ì„±í•  EC2 ì¸ìŠ¤í„´ìŠ¤ì˜ ì‚¬ìš©ì ë°ì´í„°ëŠ” ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤
        
    ```s
    <<-EOF
        #!/bin/bash
        aws s3 cp s3://aws-codedeploy-ap-northeast-2/latest/install . --region ap-northeast-2
        sudo yum install -y ruby wget git
        chmod +x ./install
        sudo ./install auto
        sudo service codedeploy-agent start
        sudo yum -y install docker
        sudo systemctl start docker
        sudo systemctl enable docker
        sudo usermod -aG docker ec2-user
        sudo chmod 666 /var/run/docker.sock
        sudo curl -L "https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
        sudo chmod +x /usr/local/bin/docker-compose
        EOF
    ```
        
4. CICDë¥¼ ìœ„í•œ .travis.yml ì‘ì„±

    ```yaml title=".travis.yml"
    language: generic

    services:
        - docker

    before_install:
        - docker build -t dotoryeee/test-submit-server -f ./flask-submit-server/Dockerfile ./flask-submit-server

    script:
        - docker run -e CI=true dotoryeee/test-submit-server python3 test.py

    after_success:
        - docker build -t dotoryeee/flask-submit-server ./flask-submit-server
        - docker build -t dotoryeee/flask-result-server ./flask-result-server
        - docker build -t dotoryeee/nginx ./nginx

        - echo "$DOCKER_HUB_PASSWORD" | docker login -u "$DOCKER_HUB_ID" --password-stdin

        - docker push dotoryeee/flask-submit-server
        - docker push dotoryeee/flask-result-server
        - docker push dotoryeee/nginx

    before_deploy:
        - zip -r myapp.zip ./* #CI ì™„ë£Œ í›„ ëª¨ë“  íŒŒì¼ì„ myapp.zipë¡œ ì••ì¶•
        - mkdir -p deploy  # deploy ë””ë ‰í„°ë¦¬ ìƒì„±
        - mv myapp.zip ./deploy #myapp.zipë¥¼ deploy ë””ë ‰í„°ë¦¬ë¡œ ì´ë™

    deploy:
        - provider: s3
        access_key_id: $AWS_ACCESS_KEY
        secret_access_key: $AWS_SECRET_ACCESS_KEY
        bucket: dotoryeee-s3
        region: ap-northeast-2
        skip_cleanup: true #ì••ì¶•íŒŒì¼ ì‚­ì œ ë°©ì§€
        local_dir: deploy #deploy ë””ë ‰í„°ë¦¬ì˜ íŒŒì¼ì„ S3ì— ì „ì†¡
        wait-until-deployed: true
        on:
            branch: main
        - provider: codedeploy
        access_key_id: $AWS_ACCESS_KEY
        secret_access_key: $AWS_SECRET_ACCESS_KEY
        bucket: dotoryeee-s3
        key: myapp.zip
        bundle_type: zip
        application: talentpool
        deployment_group: CICD-test
        region: ap-northeast-2
        wait-until-deployed: true #AWSì— íŒŒì¼ ì „ë‹¬ ì´í›„ì—ë„ ì—ëŸ¬ í™•ì¸ ê°€ëŠ¥
        on:
            branch: main
    ```

5. CodeDeploy ì´í›„ ì‘ì—… ëª…ì‹œë¥¼ ìœ„í•œ appspec.yml ì‘ì„±
    
    ```yaml title="appspec.yml"
    version: 0.0
    os: linux
    files:
        - source: /
        destination: /home/ec2-user/app
        overwrite: yes
    hooks:
        AfterInstall:
        - location: execute-deploy.sh
            timeout: 300
    ```
    
1. ì„œë²„ì—ì„œ êµ¬ë™ ìœ„í•œ docker-compose-ec2.yml ì‘ì„±
    
    ```yaml title="docker-compose-ec2.yml"
    version: "3"
    services:
    flask-submit-server:
        image: dotoryeee/flask-submit-server
        restart: always
        container_name: flask-submit-server
        ports:
        - "8000:8000"
        command: gunicorn -w 1 -b 0.0.0.0:8000 wsgi:server
    
    flask-result-server:
        image: dotoryeee/flask-result-server
        restart: always
        container_name: flask-result-server
        ports:
        - "7000:7000"
        volumes:
        - ./flask-result-server:/usr/src/app
        command: gunicorn -w 1 -b 0.0.0.0:7000 wsgi:server
    
    nginx:
        image: dotoryeee/nginx
        container_name: nginx
        restart: always
        ports:
        - "80:80"
        #flask ì»¨í…Œì´ë„ˆ ë¡œë“œê°€ ëë‚˜ë©´ Nginxë¥¼ ì‹œì‘í•©ë‹ˆë‹¤
        depends_on:
        - flask-submit-server
        - flask-result-server
    ```
    
7. ì—°ë™í•˜ì—¬ ì„œë²„ ì‹œì‘ ëª…ë ¹ì´ ëª…ì‹œëœ execute-deploy ìŠ¤í¬ë¦½íŠ¸ ì‘ì„±
        
    ```bash title="execute-deploy.sh"
    #!/bin/bash
    sudo curl -L "https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)" -o /usr/local/bin/docker-compose
    sudo chmod +x /usr/local/bin/docker-compose
    docker-compose -f /home/e2-user/app/docker-compose-ec2.yml rm -fs
    docker system prune -a -f
    docker-compose -f /home/e2-user/app/docker-compose-ec2.yml up
    ```
    

## ë™ì‘ í™•ì¸

---

1. Terraform Applyë¥¼ ì´ìš©í•´ ì¸í”„ë¼ë¥¼ ìƒì„±í•©ë‹ˆë‹¤
    - Terraform Apply
        
    ```json
    An execution plan has been generated and is shown below.
    Resource actions are indicated with the following symbols:
        + create

    Terraform will perform the following actions:

        # aws_instance.public_01 will be created
        + resource "aws_instance" "public_01" {
            + ami                          = "ami-006e2f9fa7597680a"
            + arn                          = (known after apply)
            + associate_public_ip_address  = (known after apply)
            + availability_zone            = (known after apply)
            + cpu_core_count               = (known after apply)
            + cpu_threads_per_core         = (known after apply)
            + get_password_data            = false
            + host_id                      = (known after apply)
            + iam_instance_profile         = "EC2_role_for_codedeploy"
            + id                           = (known after apply)
            + instance_state               = (known after apply)
            + instance_type                = "t2.micro"
            + ipv6_address_count           = (known after apply)
            + ipv6_addresses               = (known after apply)
            + key_name                     = "dotoryeee"
            + outpost_arn                  = (known after apply)
            + password_data                = (known after apply)
            + placement_group              = (known after apply)
            + primary_network_interface_id = (known after apply)
            + private_dns                  = (known after apply)
            + private_ip                   = (known after apply)
            + public_dns                   = (known after apply)
            + public_ip                    = (known after apply)
            + secondary_private_ips        = (known after apply)
            + security_groups              = (known after apply)
            + source_dest_check            = true
            + subnet_id                    = (known after apply)
            + tags                         = {
                + "Name" = "talentpool-webserver"
            }
            + tenancy                      = (known after apply)
            + user_data                    = "37dd0b56bc65486734172a29cc30def4180da21a"
            + vpc_security_group_ids       = (known after apply)

            + ebs_block_device {
                + delete_on_termination = (known after apply)
                + device_name           = (known after apply)
                + encrypted             = (known after apply)
                + iops                  = (known after apply)
                + kms_key_id            = (known after apply)
                + snapshot_id           = (known after apply)
                + tags                  = (known after apply)
                + throughput            = (known after apply)
                + volume_id             = (known after apply)
                + volume_size           = (known after apply)
                + volume_type           = (known after apply)
            }

            + enclave_options {
                + enabled = (known after apply)
            }

            + ephemeral_block_device {
                + device_name  = (known after apply)
                + no_device    = (known after apply)
                + virtual_name = (known after apply)
            }

            + metadata_options {
                + http_endpoint               = (known after apply)
                + http_put_response_hop_limit = (known after apply)
                + http_tokens                 = (known after apply)
            }

            + network_interface {
                + delete_on_termination = (known after apply)
                + device_index          = (known after apply)
                + network_interface_id  = (known after apply)
            }

            + root_block_device {
                + delete_on_termination = (known after apply)
                + device_name           = (known after apply)
                + encrypted             = (known after apply)
                + iops                  = (known after apply)
                + kms_key_id            = (known after apply)
                + tags                  = (known after apply)
                + throughput            = (known after apply)
                + volume_id             = (known after apply)
                + volume_size           = (known after apply)
                + volume_type           = (known after apply)
            }
        }

        # aws_instance.public_02 will be created
        + resource "aws_instance" "public_02" {
            + ami                          = "ami-006e2f9fa7597680a"
            + arn                          = (known after apply)
            + associate_public_ip_address  = (known after apply)
            + availability_zone            = (known after apply)
            + cpu_core_count               = (known after apply)
            + cpu_threads_per_core         = (known after apply)
            + get_password_data            = false
            + host_id                      = (known after apply)
            + iam_instance_profile         = "EC2_role_for_codedeploy"
            + id                           = (known after apply)
            + instance_state               = (known after apply)
            + instance_type                = "t2.micro"
            + ipv6_address_count           = (known after apply)
            + ipv6_addresses               = (known after apply)
            + key_name                     = "dotoryeee"
            + outpost_arn                  = (known after apply)
            + password_data                = (known after apply)
            + placement_group              = (known after apply)
            + primary_network_interface_id = (known after apply)
            + private_dns                  = (known after apply)
            + private_ip                   = (known after apply)
            + public_dns                   = (known after apply)
            + public_ip                    = (known after apply)
            + secondary_private_ips        = (known after apply)
            + security_groups              = (known after apply)
            + source_dest_check            = true
            + subnet_id                    = (known after apply)
            + tags                         = {
                + "Name" = "talentpool-webserver"
            }
            + tenancy                      = (known after apply)
            + user_data                    = "37dd0b56bc65486734172a29cc30def4180da21a"
            + vpc_security_group_ids       = (known after apply)

            + ebs_block_device {
                + delete_on_termination = (known after apply)
                + device_name           = (known after apply)
                + encrypted             = (known after apply)
                + iops                  = (known after apply)
                + kms_key_id            = (known after apply)
                + snapshot_id           = (known after apply)
                + tags                  = (known after apply)
                + throughput            = (known after apply)
                + volume_id             = (known after apply)
                + volume_size           = (known after apply)
                + volume_type           = (known after apply)
            }

            + enclave_options {
                + enabled = (known after apply)
            }

            + ephemeral_block_device {
                + device_name  = (known after apply)
                + no_device    = (known after apply)
                + virtual_name = (known after apply)
            }

            + metadata_options {
                + http_endpoint               = (known after apply)
                + http_put_response_hop_limit = (known after apply)
                + http_tokens                 = (known after apply)
            }

            + network_interface {
                + delete_on_termination = (known after apply)
                + device_index          = (known after apply)
                + network_interface_id  = (known after apply)
            }

            + root_block_device {
                + delete_on_termination = (known after apply)
                + device_name           = (known after apply)
                + encrypted             = (known after apply)
                + iops                  = (known after apply)
                + kms_key_id            = (known after apply)
                + tags                  = (known after apply)
                + throughput            = (known after apply)
                + volume_id             = (known after apply)
                + volume_size           = (known after apply)
                + volume_type           = (known after apply)
            }
        }

        # aws_internet_gateway.main will be created
        + resource "aws_internet_gateway" "main" {
            + arn      = (known after apply)
            + id       = (known after apply)
            + owner_id = (known after apply)
            + tags     = {
                + "Name" = "igw-talent-pool"
            }
            + vpc_id   = (known after apply)
        }

        # aws_key_pair.dotoryeee will be created
        + resource "aws_key_pair" "dotoryeee" {
            + arn         = (known after apply)
            + fingerprint = (known after apply)
            + id          = (known after apply)
            + key_name    = "dotoryeee"
            + key_pair_id = (known after apply)
            + public_key  = "ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDD5D5mHSD/vdgcGmh6Kd57DqLxebcvbrUsHj8DYDW0+9MSvvK874Bm4hpqHliYze/ht7VnzL5+A5qZkCevKGBDeJNmR/QDHccCsCfRuyEmzMlvj3SxzYSH2N4lBG6eZZbQ+0yRl7ny3aeyol5boDkztLZ/PZwVR5IH6BgsNiGClSDtuf2CYoKN7hQufjeuCDcLlQa+ItFa4abMe/mWtMeEh7+ZpC+0KAFFvqY80OCtuUdqq7tcP8uHzQy9mPKvKBieJYitUoStjFEMAro1v34u6193Qgk6DAhyMom4GmLc2+tTyKMsvBlRKUOb87F+2zsATX3Ahz9cMpEkfPTkY15V dotoryeee@i5-6500"
        }

        # aws_route.default will be created
        + resource "aws_route" "default" {
            + destination_cidr_block     = "0.0.0.0/0"
            + destination_prefix_list_id = (known after apply)
            + egress_only_gateway_id     = (known after apply)
            + gateway_id                 = (known after apply)
            + id                         = (known after apply)
            + instance_id                = (known after apply)
            + instance_owner_id          = (known after apply)
            + local_gateway_id           = (known after apply)
            + nat_gateway_id             = (known after apply)
            + network_interface_id       = (known after apply)
            + origin                     = (known after apply)
            + route_table_id             = (known after apply)
            + state                      = (known after apply)
        }

        # aws_route_table.private will be created
        + resource "aws_route_table" "private" {
            + id               = (known after apply)
            + owner_id         = (known after apply)
            + propagating_vgws = (known after apply)
            + route            = (known after apply)
            + tags             = {
                + "Name" = "RT-private-talent-pool"
            }
            + vpc_id           = (known after apply)
        }

        # aws_route_table.public will be created
        + resource "aws_route_table" "public" {
            + id               = (known after apply)
            + owner_id         = (known after apply)
            + propagating_vgws = (known after apply)
            + route            = (known after apply)
            + tags             = {
                + "Name" = "RT-public-talent-pool"
            }
            + vpc_id           = (known after apply)
        }

        # aws_route_table_association.private-asso-2a will be created
        + resource "aws_route_table_association" "private-asso-2a" {
            + id             = (known after apply)
            + route_table_id = (known after apply)
            + subnet_id      = (known after apply)
        }

        # aws_route_table_association.private-asso-2c will be created
        + resource "aws_route_table_association" "private-asso-2c" {
            + id             = (known after apply)
            + route_table_id = (known after apply)
            + subnet_id      = (known after apply)
        }

        # aws_route_table_association.public-asso-2a will be created
        + resource "aws_route_table_association" "public-asso-2a" {
            + id             = (known after apply)
            + route_table_id = (known after apply)
            + subnet_id      = (known after apply)
        }

        # aws_route_table_association.public-asso-2c will be created
        + resource "aws_route_table_association" "public-asso-2c" {
            + id             = (known after apply)
            + route_table_id = (known after apply)
            + subnet_id      = (known after apply)
        }

        # aws_security_group.public_ec2 will be created
        + resource "aws_security_group" "public_ec2" {
            + arn                    = (known after apply)
            + description            = "allow SSH from anywhere"
            + egress                 = [
                + {
                    + cidr_blocks      = [
                        + "0.0.0.0/0",
                    ]
                    + description      = ""
                    + from_port        = 0
                    + ipv6_cidr_blocks = []
                    + prefix_list_ids  = []
                    + protocol         = "-1"
                    + security_groups  = []
                    + self             = false
                    + to_port          = 0
                },
            ]
            + id                     = (known after apply)
            + ingress                = [
                + {
                    + cidr_blocks      = [
                        + "0.0.0.0/0",
                    ]
                    + description      = ""
                    + from_port        = 22
                    + ipv6_cidr_blocks = []
                    + prefix_list_ids  = []
                    + protocol         = "tcp"
                    + security_groups  = []
                    + self             = false
                    + to_port          = 22
                },
                + {
                    + cidr_blocks      = [
                        + "0.0.0.0/0",
                    ]
                    + description      = ""
                    + from_port        = 80
                    + ipv6_cidr_blocks = []
                    + prefix_list_ids  = []
                    + protocol         = "tcp"
                    + security_groups  = []
                    + self             = false
                    + to_port          = 80
                },
            ]
            + name                   = "allow SSH and HTTP"
            + name_prefix            = (known after apply)
            + owner_id               = (known after apply)
            + revoke_rules_on_delete = false
            + tags                   = {
                + "Name" = "SG-EC2-webserver"
            }
            + vpc_id                 = (known after apply)
        }

        # aws_subnet.private-2a will be created
        + resource "aws_subnet" "private-2a" {
            + arn                             = (known after apply)
            + assign_ipv6_address_on_creation = false
            + availability_zone               = "ap-northeast-2a"
            + availability_zone_id            = (known after apply)
            + cidr_block                      = "10.0.2.0/24"
            + id                              = (known after apply)
            + ipv6_cidr_block_association_id  = (known after apply)
            + map_public_ip_on_launch         = false
            + owner_id                        = (known after apply)
            + tags                            = {
                + "Name" = "private-2a"
            }
            + vpc_id                          = (known after apply)
        }

        # aws_subnet.private-2c will be created
        + resource "aws_subnet" "private-2c" {
            + arn                             = (known after apply)
            + assign_ipv6_address_on_creation = false
            + availability_zone               = "ap-northeast-2c"
            + availability_zone_id            = (known after apply)
            + cidr_block                      = "10.0.3.0/24"
            + id                              = (known after apply)
            + ipv6_cidr_block_association_id  = (known after apply)
            + map_public_ip_on_launch         = false
            + owner_id                        = (known after apply)
            + tags                            = {
                + "Name" = "private-2c"
            }
            + vpc_id                          = (known after apply)
        }

        # aws_subnet.public-2a will be created
        + resource "aws_subnet" "public-2a" {
            + arn                             = (known after apply)
            + assign_ipv6_address_on_creation = false
            + availability_zone               = "ap-northeast-2a"
            + availability_zone_id            = (known after apply)
            + cidr_block                      = "10.0.0.0/24"
            + id                              = (known after apply)
            + ipv6_cidr_block_association_id  = (known after apply)
            + map_public_ip_on_launch         = true
            + owner_id                        = (known after apply)
            + tags                            = {
                + "Name" = "public-2a-talent-pool"
            }
            + vpc_id                          = (known after apply)
        }

        # aws_subnet.public-2c will be created
        + resource "aws_subnet" "public-2c" {
            + arn                             = (known after apply)
            + assign_ipv6_address_on_creation = false
            + availability_zone               = "ap-northeast-2c"
            + availability_zone_id            = (known after apply)
            + cidr_block                      = "10.0.1.0/24"
            + id                              = (known after apply)
            + ipv6_cidr_block_association_id  = (known after apply)
            + map_public_ip_on_launch         = true
            + owner_id                        = (known after apply)
            + tags                            = {
                + "Name" = "public-2c-talent-pool"
            }
            + vpc_id                          = (known after apply)
        }

        # aws_vpc.main will be created
        + resource "aws_vpc" "main" {
            + arn                              = (known after apply)
            + assign_generated_ipv6_cidr_block = false
            + cidr_block                       = "10.0.0.0/16"
            + default_network_acl_id           = (known after apply)
            + default_route_table_id           = (known after apply)
            + default_security_group_id        = (known after apply)
            + dhcp_options_id                  = (known after apply)
            + enable_classiclink               = (known after apply)
            + enable_classiclink_dns_support   = (known after apply)
            + enable_dns_hostnames             = true
            + enable_dns_support               = true
            + id                               = (known after apply)
            + instance_tenancy                 = "default"
            + ipv6_association_id              = (known after apply)
            + ipv6_cidr_block                  = (known after apply)
            + main_route_table_id              = (known after apply)
            + owner_id                         = (known after apply)
            + tags                             = {
                + "Name" = "vpc-talent-pool"
            }
        }

    Plan: 17 to add, 0 to change, 0 to destroy.

    Do you want to perform these actions?
        Terraform will perform the actions described above.
        Only 'yes' will be accepted to approve.

        Enter a value: yes

    aws_key_pair.dotoryeee: Creating...
    aws_vpc.main: Creating...
    aws_key_pair.dotoryeee: Creation complete after 1s [id=dotoryeee]
    aws_vpc.main: Still creating... [10s elapsed]
    aws_vpc.main: Creation complete after 11s [id=vpc-0c885c480266a1609]
    aws_route_table.public: Creating...
    aws_subnet.private-2c: Creating...
    aws_subnet.public-2a: Creating...
    aws_route_table.private: Creating...
    aws_internet_gateway.main: Creating...
    aws_subnet.public-2c: Creating...
    aws_subnet.private-2a: Creating...
    aws_security_group.public_ec2: Creating...
    aws_route_table.private: Creation complete after 0s [id=rtb-007ecd93701976184]
    aws_route_table.public: Creation complete after 0s [id=rtb-07a3c28f427d9d9b0]
    aws_internet_gateway.main: Creation complete after 1s [id=igw-08b4682de4ec8f301]
    aws_subnet.private-2c: Creation complete after 1s [id=subnet-0f054920c100a9591]
    aws_subnet.private-2a: Creation complete after 1s [id=subnet-05bfc7af15120b423]
    aws_route_table_association.private-asso-2c: Creating...
    aws_route.default: Creating...
    aws_route_table_association.private-asso-2a: Creating...
    aws_route_table_association.private-asso-2c: Creation complete after 0s [id=rtbassoc-0dbe25bb20f9f3fbf]
    aws_route_table_association.private-asso-2a: Creation complete after 0s [id=rtbassoc-099fe2753e2de8eeb]
    aws_route.default: Creation complete after 0s [id=r-rtb-07a3c28f427d9d9b01080289494]
    aws_security_group.public_ec2: Creation complete after 2s [id=sg-0a3b2cfbd654e0211]
    aws_subnet.public-2a: Still creating... [10s elapsed]
    aws_subnet.public-2c: Still creating... [10s elapsed]
    aws_subnet.public-2c: Creation complete after 11s [id=subnet-08dd1b40e3066df36]
    aws_subnet.public-2a: Creation complete after 11s [id=subnet-03874ee39103bba68]
    aws_route_table_association.public-asso-2c: Creating...
    aws_route_table_association.public-asso-2a: Creating...
    aws_instance.public_01: Creating...
    aws_instance.public_02: Creating...
    aws_route_table_association.public-asso-2a: Creation complete after 0s [id=rtbassoc-0b6bc559f38878ca0]
    aws_route_table_association.public-asso-2c: Creation complete after 0s [id=rtbassoc-0eaa97ebcf00bcfd6]
    aws_instance.public_01: Still creating... [10s elapsed]
    aws_instance.public_02: Still creating... [10s elapsed]
    aws_instance.public_01: Still creating... [20s elapsed]
    aws_instance.public_02: Still creating... [20s elapsed]
    aws_instance.public_01: Creation complete after 21s [id=i-00cb9f1261ba14494]
    aws_instance.public_02: Creation complete after 21s [id=i-0a84d66623f8c2a83]

    Apply complete! Resources: 17 added, 0 changed, 0 destroyed.
    ```
        
    
    ![Project-1/Untitled%2013.png](Project-1/Untitled%2013.png)
    
2. EC2ê°€ ì˜ ìƒì„±ë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2014.png](Project-1/Untitled%2014.png)
    
3. ë³´ì•ˆê·¸ë£¹ê³¼ ì—­í• ì´ ì˜ ë¶€ì—¬ë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2015.png](Project-1/Untitled%2015.png)
    
4. SSHë¡œ ì¸ìŠ¤í„´ìŠ¤ì— ì ‘ì†í•´ Dockerê°€ ì„¤ì¹˜ëœ ê²ƒì„ í™•ì¸í•©ë‹ˆë‹¤
ìµœì´ˆ ì ‘ì†ì„ì—ë„ ë¶ˆêµ¬í•˜ê³  ë„ì»¤ê°€ ì„¤ì¹˜ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2016.png](Project-1/Untitled%2016.png)
    
5. ê¹ƒí—™ì— Push í•˜ì—¬ CICD íŒŒì´í”„ë¼ì¸ì— ì‹œë™ì„ ê±¸ì–´ë´…ë‹ˆë‹¤
    
    ![Project-1/Untitled%2017.png](Project-1/Untitled%2017.png)
    
6. ê¹ƒí—™ì— Push í•˜ë©´ Travis CIê°€ ìë™ìœ¼ë¡œ í†µí•© í…ŒìŠ¤íŠ¸ë¥¼ ì‹œí–‰í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2018.png](Project-1/Untitled%2018.png)
    
7. CIê°€ ì„±ê³µí•˜ë©´
    
    ![Project-1/Untitled%2019.png](Project-1/Untitled%2019.png)
    
8. AWS S3ì— ì½”ë“œë¥¼ ì—…ë¡œë“œ í•˜ê³  CodeDeployì˜ ë°°í¬ íŠ¸ë¦¬ê±°ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2020.png](Project-1/Untitled%2020.png)
    
9. S3ì— ì†ŒìŠ¤ì½”ë“œê°€ ì—…ë¡œë“œ ë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2021.png](Project-1/Untitled%2021.png)
    
10. CodeDeployê°€ ì„¤ì •ì— ë§¤ì¹­ë˜ëŠ” EC2ë¥¼ ì°¾ìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2022.png](Project-1/Untitled%2022.png)
    
11. CodeDeployì— ìƒˆë¡œìš´ ì¼ê±°ë¦¬ê°€ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2023.png](Project-1/Untitled%2023.png)
    
12. CodeDeployê°€ S3 â†’ EC2ë¡œ ì†ŒìŠ¤ì½”ë“œë¥¼ ì§‘ì–´ë„£ê³  ì••ì¶•ì„ í’€ì–´ì¤ë‹ˆë‹¤
    
    ![Project-1/Untitled%2024.png](Project-1/Untitled%2024.png)
    
13. ì‹¤íŒ¨í•˜ë©´ ì—ëŸ¬ê°€ ë§¤ìš° ì˜ ë‚˜ì˜µë‹ˆë‹¤. CodeDeployê°€ ì´ ë¶€ë¶„ì´ ë„ˆë¬´ ì˜ ë˜ì–´ìˆì–´ì„œ ë¹ˆìŠ¤í†¡ì€ ëª» ì“°ê² ìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2025.png](Project-1/Untitled%2025.png)
    
    ![Project-1/Untitled%2026.png](Project-1/Untitled%2026.png)
    
14. Travis CIì—ì„œ wait-until-deployedì˜µì…˜ì„ ì‚¬ìš©í–ˆê¸° ë•Œë¬¸ì— ë°°í¬ê°€ ìµœì¢… ì™„ë£Œë  ë•Œ ê¹Œì§€ ì§€ì¼œë³´ê³  ìˆìŠµë‹ˆë‹¤. ë„ì»¤ ì»´í¬ì¦ˆ ëë‚˜ëŠ” ê²ƒ ê¹Œì§€ í¬í•¨í•´ì„œ ë°°í¬ ì´ ê³¼ì •ì´ ì–¼ë§ˆë‚˜ ê±¸ë¦¬ëŠ”ì§€ ì•Œ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    
    ![Project-1/Untitled%2027.png](Project-1/Untitled%2027.png)
    
15. ë‘ ì¸ìŠ¤í„´ìŠ¤ ëª¨ë‘ ë°°í¬ê°€ ì„±ê³µí•˜ê²Œ ë˜ë©´
    
    ![Project-1/Untitled%2028.png](Project-1/Untitled%2028.png)
    
16. EC2ì— íŒŒì¼ì´ ì˜ ìƒì„±ë˜ì–´ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2029.png](Project-1/Untitled%2029.png)
    
17. ëª¨ë“  ë°°í¬ê³¼ì •ì„ ë§ˆì¹˜ë©´ EC2ì—ì„œ ìë™ìœ¼ë¡œ ì»´í¬ì¦ˆë¥¼ ì´ìš©í•´ Hubì— ì—…ë¡œë“œëœ ì´ë¯¸ì§€ë¥¼ ê°€ì ¸ì™€ ì‹¤í–‰í•©ë‹ˆë‹¤.
18. ì„œë²„ê°€ ì˜ ì‹¤í–‰ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2030.png](Project-1/Untitled%2030.png)
    
19. EC2ì˜ í¼ë¸”ë¦­ DNSë¡œ ì ‘ì†í•˜ë©´ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2031.png](Project-1/Untitled%2031.png)
    

# Part 2 - Service

---

## ë¸Œëœì¹˜

1. ë¸Œëœì¹˜ë¥¼ í•˜ë‚˜ ë§Œë“¤ì–´ì„œ ì‘ì—…ì„ ì‹œì‘í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2032.png](Project-1/Untitled%2032.png)
    
2. ë¸Œëœì¹˜ë¥¼ ìƒì„±í•´ì„œ ì‘ì—…í•˜ê³  Pull Requestë¡œ ë¨¸ì§€ë¥¼ ìš”ì²­ â†’ ë¨¸ì§€ í›„ íŠ¸ë ˆë¹„ìŠ¤ê°€ í…ŒìŠ¤íŠ¸ë¥¼ í•©ë‹ˆë‹¤. ê¹ƒí—™ í˜ì´ì§€ì—ì„œ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2033.png](Project-1/Untitled%2033.png)
    
3. ì„œë²„ê°€ ì™„ì„±ë˜ë©´ pull requestë¥¼ ìš”ì²­í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2034.png](Project-1/Untitled%2034.png)
    
4. ê¹ƒí—™ì—ì„œ ì½”ë“œ ê²€ì‚¬ í›„ í•©ë³‘ ê°€ëŠ¥í•˜ë©´ Mergeë¥¼ ì§„í–‰í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2035.png](Project-1/Untitled%2035.png)
    
5. PRì„ ìš”ì²­ë˜ë©´ ìë™ìœ¼ë¡œ íŠ¸ë ˆë¹„ìŠ¤ì—ì„œ ê²€ì‚¬ë¥¼ ì‹œì‘í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2036.png](Project-1/Untitled%2036.png)
    
6. ê²€ì‚¬ ì‹œì‘
    
    ![Project-1/Untitled%2037.png](Project-1/Untitled%2037.png)
    
7. ê²€ì‚¬ê°€ ì™„ë£Œë˜ì—ˆìŠµë‹ˆë‹¤. í•˜ì§€ë§Œ PRìš”ì²­ì— ë”°ë¥¸ ê²€ì‚¬ì´ê¸° ë–„ë¬¸ì— ë°°í¬ëŠ” ì§„í–‰í•˜ì§€ ì•ŠìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2038.png](Project-1/Untitled%2038.png)
    
8. githubì— í…ŒìŠ¤íŠ¸ ì„±ê³µ ê²°ê³¼ê°€ ì •ìƒì ìœ¼ë¡œ ë¦¬í„´ë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2039.png](Project-1/Untitled%2039.png)
    
9. ê·¸ë™ì•ˆ ì„œë²„ ì œì‘ ë¸Œëœì¹˜ë¥¼ ì´ìš©í•´ì£¼ì…”ì„œ ê°ì‚¬í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2040.png](Project-1/Untitled%2040.png)
    
10. PRë‚´ì—­ì€ ëª¨ë‘ ê¹ƒí—™ì— ê¸°ë¡ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2041.png](Project-1/Untitled%2041.png)
    
11. Main Branchì— Merge ë˜ì—ˆê¸° ë•Œë¬¸ì— ë‹¤ì‹œ íŠ¸ë ˆë¹„ìŠ¤ê°€ ë°˜ì‘í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2042.png](Project-1/Untitled%2042.png)
    
12. Deployê°€ ì‹œì‘ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2043.png](Project-1/Untitled%2043.png)
    
13. AWS CodeDeploy ë°°í¬ ì„±ê³µ
    
    ![Project-1/Untitled%2044.png](Project-1/Untitled%2044.png)
    
14. ì›¹ì„œë²„ê°€ RDSì™€ ì—°ê²°í•˜ì—¬ ì˜ ë™ì‘í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2045.png](Project-1/Untitled%2045.png)
    

## ì •ì ì»¨í…ì¸  S3ì— ë¶„ë¦¬í•˜ê¸°

1. ì •ì ì»¨í…ì¸ ë¥¼ S3ë¡œ ë¶„ë¦¬í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2046.png](Project-1/Untitled%2046.png)
    
    ![Project-1/Untitled%2047.png](Project-1/Untitled%2047.png)
    
2. ë‹¹ì—°íˆ ê¶Œí•œì„ ì—´ì–´ì¤˜ì•¼ í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2048.png](Project-1/Untitled%2048.png)
    
3. ë¬¸ì œëŠ” CICDì— ì˜í•´ ë‹¤ì‹œ S3ì— ì—…ë¡œë“œí•˜ë©´ ê¶Œí•œì´ ì‚¬ë¼ì§‘ë‹ˆë‹¤
    
    ![Project-1/Untitled%2049.png](Project-1/Untitled%2049.png)
    
4. ë”°ë¼ì„œ ì •ì±…ìƒì„±ê¸°ë¡œ ì´ë™ í›„
    
    [AWS Policy Generator](http://awspolicygen.s3.amazonaws.com/policygen.html)
    
5. ë‹¤ìŒê³¼ ê°™ì´ ì •ì±…ì„ ìƒì„±í•˜ê³  ë³µì‚¬í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2050.png](Project-1/Untitled%2050.png)
    
6. S3 ë²„í‚·ì •ì±…ì„ ìˆ˜ì •í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2051.png](Project-1/Untitled%2051.png)
    
7. ì—ëŸ¬ë¥¼ ì‹ ë‚˜ê²Œ ë¿œì–´ë‚´ëŠ”ë° ë²„í‚·ì •ì±…ì—ì„œ resouce ë§ˆì§€ë§‰ì— /*ì„ ë¶™ì—¬ì¤˜ì•¼ í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2052.png](Project-1/Untitled%2052.png)
    
8. ì´ì œ ì™¸ë¶€ì—ì„œ ì ‘ê·¼ì´ ì˜ ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2053.png](Project-1/Untitled%2053.png)
    

## RDS ì—°ê²°í•˜ê¸°

1. í™˜ê²½ë³€ìˆ˜ë¥¼ ì´ìš©í•´ íƒœê·¸ê°’ì„ ê°€ì ¸ì˜¤ê¸° ìœ„í•´ ê¸°ì¡´ EC2 ì—­í• ì— ê¶Œí•œì„ ì¶”ê°€í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2054.png](Project-1/Untitled%2054.png)
    
2. ë‹¤ìŒê³¼ ê°™ì´ EC2 ì—ì„œ RDSì— ì—°ê²°í•  ìˆ˜ ìˆë„ë¡ ì„¤ì •ì„ í•´ë‘¡ë‹ˆë‹¤
        
    ```s
    mysql -u root -p --host myapp.cnr20hoyd3cu.ap-northeast-2.rds.amazonaws.com
    ```
    
    ![Project-1/Untitled%2055.png](Project-1/Untitled%2055.png)
    
3. ë‹¤ìŒê³¼ ê°™ì´ í…Œì´ë¸”ì„ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤
    
    í•©ê²© ê²°ê³¼ë¥¼ ë„ì–´ì¤„ resultëŠ” ê¸°ë³¸ ê°’ì— 0ì„ ë¶€ì—¬í•©ë‹ˆë‹¤
    
    ```sql
    create table {RDS_TABLE} (number int auto_increment primary key, name char(10) not null ,contact text not null ,resume text, blog text, result BOOLEAN default 0)
    ```
    
4. ë‹¤ìŒê³¼ ê°™ì´ í…ŒìŠ¤íŠ¸ í•´ë´…ë‹ˆë‹¤. ì˜ ì—°ê²°ë˜ì—ˆìŠµë‹ˆë‹¤.
    
    ![Project-1/Untitled%2056.png](Project-1/Untitled%2056.png)
    
5. ë“±ë¡ì„œë²„ ì™„ì„±
    
    ![Project-1/Untitled%2057.png](Project-1/Untitled%2057.png)
    
6. ê²°ê³¼ì„œë²„ ì™„ì„±
    
    ![Project-1/Untitled%2058.png](Project-1/Untitled%2058.png)
    

# Part 3 - Orchestration

---

## Swarm mode

1. ìŠ¤ì›œì„ ìœ„í•œ í¬íŠ¸ë¥¼ ê°œë°©í•©ë‹ˆë‹¤
    - tcp 2377 - í´ëŸ¬ìŠ¤í„° ë§¤ë‹ˆì§€ë¨¼íŠ¸
    - tcp udp 7946 - ë…¸ë“œê°„ í†µì‹ 
    - udp 4789 - ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬
2. ë‘˜ ì¤‘ì— ë§ˆìŒì— ë“œëŠ”ê±¸ë¡œ ì‚¬ìš©í•˜ë©´ ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2059.png](Project-1/Untitled%2059.png)
    
    ![Project-1/Untitled%2060.png](Project-1/Untitled%2060.png)
    
    ![Project-1/Untitled%2061.png](Project-1/Untitled%2061.png)
    
3. ë§¤ë‹ˆì € ë…¸ë“œë¥¼ ì‹œì‘í•©ë‹ˆë‹¤

    ```s
    docker swarm init --advertise-addr {ADDR}
    ```
        
    ![Project-1/Untitled%2062.png](Project-1/Untitled%2062.png)
    
4. ì›Œì»¤ ë…¸ë“œë¥¼ ì¶”ê°€í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2063.png](Project-1/Untitled%2063.png)
    
    ![Project-1/Untitled%2064.png](Project-1/Untitled%2064.png)
    
    ![Project-1/Untitled%2065.png](Project-1/Untitled%2065.png)
    
5. ë‹¤ìŒê³¼ ê°™ì€ ë°©ì‹ìœ¼ë¡œ Nginx ì»¨í…Œì´ë„ˆë¥¼ ë¡œë“œí•˜ê³  ì •ë³´ë¥¼ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ```s
    docker service create --name nginx -p 80:80 nginx
    docker service ls
    docker service ps nginx
    ```
    
    ![Project-1/Untitled%2066.png](Project-1/Untitled%2066.png)
    
6. ì–´ë–¤ ì¸ìŠ¤í„´ìŠ¤ë¡œ ì ‘ì†í•˜ë˜ ìƒê´€ì—†ì´ Nginx ì»¨í…Œì´ë„ˆì— ì—°ê²°ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2067.png](Project-1/Untitled%2067.png)
    
7. ë„ì»¤ ìŠ¤ì›œì€ detachedë¥¼ ê¸°ë³¸ ì „ì œë¡œ ê¹”ê³  ê°€ê¸° ë•Œë¬¸ì— ë‹¤ìŒê³¼ ê°™ì´ processê°€ ì¢…ë£Œë˜ëŠ” ì»¨í…Œì´ë„ˆë¥¼ ì‹¤í–‰í•˜ë©´ í•´ë‹¹ ì»¨í…Œì´ë„ˆê°€ ì—ëŸ¬ê°€ ë°œìƒí•œ ê²ƒìœ¼ë¡œ íŒë‹¨í•˜ì—¬ ë¬´í•œ ì¬ì‹¤í–‰ ë©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2068.png](Project-1/Untitled%2068.png)
    
8. 
9. ì»¨í…Œì´ë„ˆ í•˜ë‚˜ì”© ë¡œë“œí•  ìˆ˜ ì—†ëŠ” ê²½ìš° ìŠ¤íƒì„ ì´ìš©í•©ë‹ˆë‹¤
    
    ![Project-1/Untitled%2069.png](Project-1/Untitled%2069.png)

    ```s
    docker stack deploy --compose-file docker-compose-swarm.yml test
    ```

10. ì„œë¹„ìŠ¤ê°€ ì˜ ì‹¤í–‰ë˜ë©´ RDSì— 2ê°œì˜ ì—°ê²°ì´ ìƒì„±ëœ ê²ƒì„ í™•ì¸í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2070.png](Project-1/Untitled%2070.png)
    
11. ì„œë¹„ìŠ¤ê°€ ì˜ ë¡œë“œë˜ì—ˆìŠµë‹ˆë‹¤
    
    ![Project-1/Untitled%2071.png](Project-1/Untitled%2071.png)
    

## Links

---

- Docker Best Practices
    
    [Docker Security Best Practices from the Dockerfile](https://cloudberry.engineering/article/dockerfile-security-best-practices/)
    
- AWS ECS@beanstalk ë©€í‹°ì»¨í…Œì´ë„ˆ DOCS
    
    [ë©€í‹°ì»¨í…Œì´ë„ˆ Docker í”Œë«í¼(Amazon Linux AMI)](https://docs.aws.amazon.com/ko_kr/elasticbeanstalk/latest/dg/create_deploy_docker_ecs.html)
    
- EC2
    - User_data ****í•˜ë“œì½”ë”©
        
        [Terraform by examples. Part 1](https://medium.com/@dhelios/terraform-by-examples-part-1-ef3e3be7b88b)
        
    - EC2 User_data YAML ì‘ì„±ë²•
        
        [Cloud config examples - cloud-init 21.1 documentation](https://cloudinit.readthedocs.io/en/latest/topics/examples.html)
        
    - EC2ì—ì„œ í™˜ê²½ë³€ìˆ˜ë¡œ íƒœê·¸ ê°€ì ¸ì˜¤ëŠ” ë°©ë²•
        
        [AWS EC2 Tagsë¥¼ ENVë¡œ ì‚¬ìš©í•˜ê¸°](https://say8425.github.io/ec2-tags-env/)
        
- Nginx ì„¤ì •
    - ê¸°ë³¸
        
        [NGINX í™˜ê²½ì„¤ì • - NGINX](https://opentutorials.org/module/384/4526)
        
    - Nginx ë¡œê·¸
        
        [](https://ktdsoss.tistory.com/410)
        
- Nginxì˜ ì—­í• 
    
    
    [Nginx ì´í•´í•˜ê¸° ë° ê¸°ë³¸ í™˜ê²½ì„¤ì • ì„¸íŒ…í•˜ê¸°](https://whatisthenext.tistory.com/123?category=779890)
    
    [NGINX ì†Œê°œ - NGINX](https://opentutorials.org/module/384/3462)
    
- WSGIë€
    
    [WSGIì— ëŒ€í•œ ì„¤ëª…, WSGIë€ ë¬´ì—‡ì¸ê°€?](https://paphopu.tistory.com/entry/WSGI%EC%97%90-%EB%8C%80%ED%95%9C-%EC%84%A4%EB%AA%85-WSGI%EB%9E%80-%EB%AC%B4%EC%97%87%EC%9D%B8%EA%B0%80)
    
    [wsgië¥¼ ì™œ ì“°ë‚˜ìš”](https://uiandwe.tistory.com/1268)
    
- Flask + uWSGI + Nginx
    - ì‚¬ë¡€
        
        [[Python] Flask + uWSGI + Nginxë¥¼ ì—°ê²° ë° ë°°í¬](https://soyoung-new-challenge.tistory.com/118)
        
        [í•˜í•˜ í˜¸í˜¸ ì¦ê¸°ëŠ” ê°œë°œã†ë³´ì•ˆ ë¸”ë¡œê·¸ ê‰‚ê‰‚(áµ”á—œáµ”*) : ë„¤ì´ë²„ ë¸”ë¡œê·¸](https://blog.naver.com/dsz08082/222255617542)
        
    - Docs
        
        [Nginx support - uWSGI 2.0 documentation](https://uwsgi-docs.readthedocs.io/en/latest/Nginx.html)
        
    - uWSGI.ini ì„¤ëª…
        
        [[uWSGI] iniíŒŒì¼ì„ í†µí•´ uWSGI ì‹¤í–‰í•˜ê¸°](https://twpower.github.io/43-run-uwsgi-by-using-ini-file)
        
- Flask + gunicorn + Nginx
    - uWSGI â†’ gunicornìœ¼ë¡œ ë³€ê²½í•œ ì‚¬ë¡€
        
        [pythonê°œë°œì uwsgië¥¼ ë²„ë¦¬ê³  gunicornìœ¼ë¡œ ê°ˆì•„íƒ€ë‹¤.](https://elastic7327.medium.com/python%EA%B0%9C%EB%B0%9C%EC%9E%90-uwsgi%EB%A5%BC-%EB%B2%84%EB%A6%AC%EA%B3%A0-gunicorn%EC%9C%BC%EB%A1%9C-%EA%B0%88%EC%95%84%ED%83%80%EB%8B%A4-df1c95f220c5)
        
    - Docs
        
        [Full Example Configuration](https://www.nginx.com/resources/wiki/start/topics/examples/full/)
        
    - ì‚¬ë¡€
        
        [Flask + Gunicorn + Nginx + Dockerë¥¼ ì‚¬ìš©í•˜ì—¬ ML ëª¨ë¸ì„ ë°°í¬í•˜ëŠ” ë°©ë²•](https://ichi.pro/ko/flask-gunicorn-nginx-dockerleul-sayonghayeo-ml-model-eul-baepohaneun-bangbeob-10664946283472)
        
- Python â†” RDS
    
    [[AWS] RDSì— ì—°ê²°ëœ MySQL ê³¼ Python ì—°ë™í•˜ê¸°, MySQL ì˜ìƒ ì €ì¥í•˜ê¸°](https://0-sunny.tistory.com/45)
    
    [[AWS/RDS]RDSì™€ Python ì—°ê²°í•˜ê¸°(4) - pymysqlì„ ì‚¬ìš©í•´ pythonìœ¼ë¡œ DB ìš´ì˜í•˜ê¸°](https://leo-bb.tistory.com/26)
    
- Flask â†” RDS
    - ì—°ê²°
        
        [AWS EC2ì—ì„œ RDS ì—°ë™í›„ Flask ì ìš©](https://seyeon-hello.tistory.com/4)
        
    - ë°ì´í„° ì œì–´
        
        [AWS RDS with MySQL using Flask](https://medium.com/aws-pocket/aws-rds-with-mysql-using-flask-f1c6d8cc7eff)
        
- íŒŒì´ì¬ í…ŒìŠ¤íŠ¸ì½”ë“œ ê¸°ë³¸ ì˜ˆì‹œ
    
    [Travis-cië¥¼ ì´ìš©í•˜ì—¬ python 'Hello world' ì‘ì„±í•˜ê¸°](https://cjh5414.github.io/travis-ci/)
    
- MySQL my.cnf ì‘ì„±ë²•
    
    [make my.cnf](https://good-dba.gitbooks.io/mariadb-installation/content/make_mycnf.html)
    
    [MySQL ì„¤ì •íŒŒì¼ my.cnf](https://zetawiki.com/wiki/MySQL_%EC%84%A4%EC%A0%95%ED%8C%8C%EC%9D%BC_my.cnf)
    
- AWS Elastic Beanstalk
    - Beanstalkí™˜ê²½ì—ì„œ Docker ì»¨í…Œì´ë„ˆ ì •ì˜ ë°©ë²•
        
        [Docker êµ¬ì„±](https://docs.aws.amazon.com/ko_kr/elasticbeanstalk/latest/dg/single-container-docker-configuration.html#docker-configuration.no-compose)
        
    - Beanstalk ì‘ì—…ì •ì˜ ê³µì‹ ì‘ì„± ê°€ì´ë“œ
        
        [ë©€í‹°ì»¨í…Œì´ë„ˆ Docker êµ¬ì„±](https://docs.aws.amazon.com/ko_kr/elasticbeanstalk/latest/dg/create_deploy_docker_v2config.html)
        
- Terraform
    - Beanstalk Docs
        
        [](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/elastic_beanstalk_application)
        
    - EC2ì— í™˜ê²½ë³€ìˆ˜ ë„£ëŠ” ë²•
        
        [Set environment variables in an AWS instance](https://stackoverflow.com/questions/50668315/set-environment-variables-in-an-aws-instance)
        
    - VPC Docs
        
        [](https://registry.terraform.io/providers/hashicorp/aws/latest/docs/resources/vpc)
        
- Travis CI
    - CodeDeploy Docs
        
        [Travis CI Documentation](https://docs.travis-ci.com/user/deployment/codedeploy/)
        
- Docker Swarm Docs
    - Docker official
        
        [Getting started with swarm mode](https://docs.docker.com/engine/swarm/swarm-tutorial/#open-protocols-and-ports-between-the-hosts)
        
    - Stack ì‚¬ìš©ë²•
        
        [Deploy a stack to a swarm](https://docs.docker.com/engine/swarm/stack-deploy/)
        
    - Terraform Module
        
        [](https://registry.terraform.io/modules/terraform-aws-modules/security-group/aws/2.3.0/submodules/docker-swarm)
        
    - ì˜¤ë²„ë ˆì´ ë„¤íŠ¸ì›Œí¬ì—ì„œ ì»¨í…Œì´ë„ˆ ì°¾ê¸°
        
        [How to use Docker swarm DNS/Service names in Nginx upstream](https://stackoverflow.com/questions/43896846/how-to-use-docker-swarm-dns-service-names-in-nginx-upstream)
        
    - ìŠ¤ì›œëª¨ë“œë¥¼ ìœ„í•œ ìŠ¤íƒ ì‘ì„±
        
        [ë„ì»¤ ì‹œì‘í•˜ê¸° 11 : ë„ì»¤ ìŠ¤ì›œ - ë„¤íŠ¸ì›Œí¬](https://javacan.tistory.com/entry/docker-start-11-swarm-network)
        
    - ì„œë¹„ìŠ¤ ì‹œì‘ ì—ëŸ¬
        
        [Troubleshooting swarm service create](https://forums.docker.com/t/troubleshooting-swarm-service-create/55161)
        
    - ë°œí‘œìš© ppt
        
        [ê°œì¸í”Œì .pptx](Project-1.pptx)
        
