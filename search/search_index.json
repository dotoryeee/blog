{"config":{"lang":["en"],"separator":"[\\s\\-]+","pipeline":["stopWordFilter"]},"docs":[{"location":"","title":"\ubb34\uacc4\ud68d \uacf5\ubd80 \uc804\ubb38","text":""},{"location":"#study-todo-list","title":"Study TODO List","text":"<ul> <li> Kubernetes \uac15\uc758 \uc218\uac15</li> <li> Kafka \uac15\uc758 \uc218\uac15</li> <li> Certification<ul> <li> AWS SOA</li> <li> AWS SAP</li> <li> K8S \uc790\uaca9\uc99d \uc544\ubb34\uac70\ub098</li> </ul> </li> <li> Python \ud074\ub9b0\ucf54\ub4dc \uc77d\uc5b4\ubcf4\uae30</li> <li> Python \uc18c\ud504\ud2b8\uc6e8\uc5b4 \uc544\ud0a4\ud14d\ucc98 \uc77d\uc5b4\ubcf4\uae30</li> <li> Speak \uacf5\ubd80 \ub9e4\uc77c \ud558\uae30</li> </ul>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/","title":"3-Tier \uae30\ubcf8 \uc778\ud504\ub77c \uad6c\uc131","text":""},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#_1","title":"\uac1c\ub150\ub3c4","text":""},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#todo","title":"TODO","text":"<ul> <li> VPC\uc0dd\uc131</li> <li> \uc11c\ube0c\ub137\uc0dd\uc131(public X 2, private X 2)</li> <li> public\uc11c\ubc84\uc5d0 \uac01\uac01 bastion host \uc778\uc2a4\ud134\uc2a4 \uc0dd\uc131</li> <li> ELB\uc0dd\uc131\ud6c4 Auto Scaling \uc5f0\uacc4 \u2192 \uc6f9 \uc11c\ubc84 \uc778\uc2a4\ud134\uc2a4 \uc790\ub3d9\uc0dd\uc131(2~6\uac1c)</li> <li> HOST \u2192 WebServer \uc811\uc18d \ud655\uc778</li> <li> RDS DB\uc0dd\uc131(MySQL)</li> <li> HOST \u2192 Bastion Host \u2192 DB \uc811\uc18d \ud655\uc778\ud558\uae30</li> <li> MySQL Workbench \uc5f0\uacb0 (SSH \ud130\ub110\ub9c1) (SQL IDE)</li> <li> Jetbrains DataGrip \uc5f0\uacb0  (SSH \ud130\ub110\ub9c1) (SQL IDE)</li> </ul>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#vpc","title":"VPC","text":"<ol> <li> <p>VPC \uc0dd\uc131</p> <p></p> </li> <li> <p>\uc11c\ube0c\ub137 \uc0dd\uc131(public 2ea, private 2ea)</p> <p></p> </li> <li> <p>\uc11c\ube0c\ub137 \ud655\uc778</p> <p></p> </li> <li> <p>\ud37c\ube14\ub9ad\uc11c\ube0c\ub137\uc758 public-IP \uc790\ub3d9\ud560\ub2f9 \uc0ac\uc6a9</p> <p></p> <p></p> <p>\u2192 \ud37c\ube14\ub9ad\uc11c\ube0c\ub137(\ucd1d 2\uac1c)\uc5d0 \ubaa8\ub450 \uc801\uc6a9</p> </li> <li> <p>\ub77c\uc6b0\ud305\ud14c\uc774\ube14 \uc0dd\uc131</p> <p></p> <p></p> <p></p> <p>\u2192 VPC\ub2f9 IGW\ub294 1\uac1c \uc774\ubbc0\ub85c public route table\uc740 1\uac1c, private route table\uc740 2\uac1c \uc0dd\uc131</p> </li> <li> <p>IGW \uc0dd\uc131</p> <p></p> </li> <li> <p>IGW\ub97c VPC\uc5d0 attach</p> <p></p> </li> <li> <p>Final-Public-RT\uc758 \ub77c\uc6b0\ud2b8 \uc124\uc815</p> <p></p> </li> <li> <p>private\uc11c\ube0c\ub137\uc5d0\ub294 NAT gateway \uc0dd\uc131 \ud6c4 \ud560\ub2f9(\uc694\uae08 \ubc1c\uc0dd\uc73c\ub85c \uc778\ud574 \uc2e4\uc2b5X)</p> </li> <li> <p>\ub77c\uc6b0\ud305\ud14c\uc774\ube14\uc744 \uc11c\ube0c\ub137\uc5d0 \uc5f0\uacb0</p> <p></p> <p></p> <p>\u2192 Final-Public-02\ub3c4 \ub9c8\ucc2c\uac00\uc9c0\ub85c Final-Public-RT\uc5d0 \uc5f0\uacb0</p> <p>\u2192 Final-Private-01, Final-Private-02 \uc740 \uac01\uac01 Final-Private-01-RT, Final-Private-02-RT \uc5f0\uacb0</p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#ec2-instance","title":"EC2 Instance","text":"<ol> <li> <p>SSH\uc811\uc18d\uc744 \uc704\ud55c Key pair \uc0dd\uc131</p> <p></p> <p>\u2192 putty \uc4f0\ub824\uba74 ppk\uc120\ud0dd(\ubc94\uc6a9\uc131\uc774 \ub5a8\uc5b4\uc838 \uad8c\uc7a5\ud558\uc9c0 \uc54a\uc74c)</p> </li> <li> <p>Bastion Host \uc6a9 SG(\ubcf4\uc548\uadf8\ub8f9) \uc0dd\uc131</p> <p></p> </li> <li> <p>Bastion Host Instance \uc0dd\uc131 * 2ea</p> <p></p> <p></p> <p></p> <p></p> <p></p> <p></p> <p>\u2192 VPC, Subnet, SG \ub9cc \uc54c\ub9de\uac8c \uc870\uc808</p> </li> <li> <p>\uc774\uc804\uc5d0 \uc0dd\uc131\ud55c \ud0a4\ud398\uc5b4 \uc120\ud0dd</p> <p></p> </li> <li> <p>\uac19\uc740 \uc791\uc5c5\uc744 \ubc18\ubcf5\ud558\uc5ec Bastion-Host(2c) \uc0dd\uc131</p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#bastion-host","title":"Bastion Host \uc811\uc18d","text":"<ol> <li> <p>Bastion Host(2a)\uc758 public IP \ud560\ub2f9\uc744 \ud655\uc778</p> <p></p> </li> <li> <p>\ud130\ubbf8\ub110 \uc5f4\uc5b4\uc11c \ud0a4\ud398\uc5b4\ud30c\uc77c \uc704\uce58\ub85c \uc774\ub3d9 \ud6c4 \ub2e4\uc74c \uba85\ub839\uc744 \uc774\uc6a9\ud558\uc5ec \uc811\uc18d</p> <pre><code>ssh -i FINAL-KEY.pem [ec2-user@13.125.83.172](mailto:ec2-user@13.125.83.172)\n</code></pre> </li> <li> <p>SSH \ucd5c\ucd08 \uc811\uc18d\uc2dc hash \uac12 \ud655\uc778 \u2192 yes \uc785\ub825</p> </li> <li> <p>\uc811\uc18d \ud655\uc778(bastion host \uc815\uc0c1\uc791\ub3d9)</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#elb","title":"ELB \ub9cc\ub4e4\uae30","text":"<ol> <li> <p>LoadBalancer(internet Facing)\ub97c \uc704\ud55c SG(\ubcf4\uc548\uadf8\ub8f9)\uc744 \uc0dd\uc131\ud574\uc90d\ub2c8\ub2e4</p> <p></p> <p>\u2192 internetFacing\uc774\uae30 \ub54c\ubb38\uc5d0 \ubaa8\ub4e0 \ud3ec\ud2b8\ub97c \uc624\ud508\ud574\uc90d\ub2c8\ub2e4</p> </li> <li> <p>WebServer\ub97c \uc704\ud55c SG\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p></p> <p>\u2192 \ubcf4\uc548\uadf8\ub8f9\uccb4\uc774\ub2dd\uc744 \uc774\uc6a9\ud558\uc5ec ELB\uc5d0\uac8c\ub9cc HTTP\ud3ec\ud2b8\ub97c \uc624\ud508\ud574\uc90d\ub2c8\ub2e4</p> </li> <li> <p>\uc88c\uce21 \uba54\ub274\uc758 Load Balancing \u2192 Target Groups\uc5d0\uc11c \uc0c8\ub85c\uc6b4 Target Group\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> <p>\u2192 VPC\ub9cc \uc124\uc815\ud558\uace0 \ub2e4\ub978 \ubd80\ubd84\uc740 \uae30\ubcf8\uac12\uc73c\ub85c \uc9c4\ud589\ud569\ub2c8\ub2e4</p> </li> <li> <p>\uc77c\ub2e8 \uc778\uc2a4\ud134\uc2a4 \ucd94\uac00 \uc5c6\uc774 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Load Balancing \u2192 Load Balancers\uc5d0\uc11c \uc0c8 LB\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Internet-Facing LB \uc774\ubbc0\ub85c \ud37c\ube14\ub9ad\uc11c\ube0c\ub137\uc5d0 \uc0dd\uc131\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\uc804\uc5d0 \uc0dd\uc131\ud574\ub454 LB\uc6a9 SG\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Target Group\ub3c4 \uc0ac\uc804\uc5d0 \ub9cc\ub4e4\uc5b4\ub454 TG-21-01-12\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#auto-scaling","title":"Auto Scaling","text":"<ol> <li> <p>EC2 \uc88c\uce21 \uba54\ub274 Auto Scaling \u2192 Launch Configuration \uc5d0\uc11c \uc0c8\ub85c \uc791\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ub984\uc744 \ud560\ub2f9\ud558\uace0 AMI\ub97c \uc120\ud0dd\ud574\uc90d\ub2c8\ub2e4. \ubbf8\ub9ac \ub9cc\ub4e4\uc5b4\ub454 AMI\uac00 \uc5c6\uc73c\uba74 \uc0c8\ub85c \ub9cc\ub4e4\uba74 \ub429\ub2c8\ub2e4</p> <p></p> <p>\u2192 \uc6f9 \uc11c\ubc84\uc6a9 SG\ub97c \uc120\ud0dd\ud558\uace0 \ud0a4\ud398\uc5b4\ub3c4 \uc5f0\uacb0\ud574\uc90d\ub2c8\ub2e4</p> </li> <li> <p>\uc88c\uce21\uba54\ub274 Auto Scaling Groups\uc744 \uc9c4\uc785\ud558\uace0 Create Auto Scaling Group\uc744 \ud074\ub9ad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc624\ud1a0\uc2a4\ucf00\uc77c\ub7ec \uc774\ub984\uc744 \ud560\ub2f9\ud558\uace0 Launch Configuration\uc744 \uc120\ud0dd\ud574\uc90d\ub2c8\ub2e4.</p> <p></p> <p>\u2192 \ubaa9\ub85d\uc5d0 \uc548 \ubcf4\uc774\uba74 \ubc11\uc904 \uce5c \ubd80\ubd84\uc744 \ub204\ub974\uba74 \ub429\ub2c8\ub2e4</p> </li> <li> <p>\uc624\ud1a0\uc2a4\ucf00\uc77c\uc744 \uc801\uc6a9\ud560 \uc11c\ube0c\ub137(private)\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774 \uc804\uc5d0 \ub9cc\ub4e4\uc5b4\ub454 \ub85c\ub4dc\ubc38\ub7f0\uc11c\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubaa9\ud45c, \ucd5c\uc18c, \ucd5c\ub300 \uc778\uc2a4\ud134\uc2a4 \uac1c\uc218\uc640 \uc2a4\ucf00\uc77c\ub9c1 \uc815\ucc45\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc2a4\ucf00\uc77c\ub7ec\uc5d0 \uc758\ud574 \uc2dc\uc791\ub41c \uc778\uc2a4\ud134\uc2a4\uc5d0 \ubd99\uc77c \ud0dc\uadf8\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 \ub4e4\uc5b4\uac00\ubcf4\uba74 2-4\uc758 \ubaa9\ud45c\uac12\uc778 '2\uac1c'\ub9cc\ud07c \uc778\uc2a4\ud134\uc2a4\uac00 \uc2e4\ud589\ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>ELB\uc758 DNS \uc8fc\uc18c\ub97c \ucc3e\uc544\ubd05\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud574\ub2f9 DNS\uc8fc\uc18c\uc5d0 \uc811\uc18d\ud558\uba74 \uc6f9\uc11c\ubc84\ub85c \uc9c4\uc785\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>\uc0ac\uc804\uc5d0 \uc0dd\uc131\ud574\ub454 \uc11c\ubc84 \ud654\uba74\uc774 \ud45c\uc2dc\ub429\ub2c8\ub2e4.</p> <p></p> <p>\u2192 \ud654\uba74\uc5d0\uc120 AZ \uba54\ud0c0\uc815\ubcf4(2a)\ub97c \ud655\uc778\ud574\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>\ub77c\uc6b4\ub4dc\ub85c\ube48 \ubc29\uc2dd\uc758 LB\uc774\uae30 \ub54c\ubb38\uc5d0 \uc811\uc18d\uc744 \ud560 \ub54c \ub9c8\ub2e4 \uc11c\ubc84\uac00 \ubcc0\uacbd\ub429\ub2c8\ub2e4.</p> <p>\uc0c8\ub85c\uace0\uce68\uc744 \ud558\uba74 \ub2e4\ub978 AZ(2c)\uc758 \uc6f9\uc11c\ubc84\uc5d0 \uc811\uc18d\ub41c \uac78 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#bastion-host_1","title":"Bastion Host \u2192 \uc6f9 \uc11c\ubc84 \uc811\uc18d","text":"<ol> <li> <p>SSH\ub85c Bastion host\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>PEM\ud0a4 \ud30c\uc77c\uc744 Bastion \uc5d0 \ub2e4\uc6b4\ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <p>\ub2e8\uc21c \uc2e4\uc2b5\uc744 \uc704\ud574 AWS S3\uc5d0 \uc5c5\ub85c\ub4dc \ud6c4 wget\uc744 \uc774\uc6a9\ud558\uc5ec \ub2e4\uc6b4\ub85c\ub4dc \ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p>\ub098\uc911\uc5d0 \ud604\uc7a5\uc5d0\uc11c \uc774\ub807\uac8c \uc77c \ud558\uba74 \uc548\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Webserver SG\uc5d0 bastion host \ub97c \uc704\ud55c SSH \ud3ec\ud2b8\ub97c \uac1c\ubc29\ud569\ub2c8\ub2e4</p> <p>\uccb4\uc774\ub2dd\ub41c source SG\ub294 FINAL-SG-Bastion\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc2a4\ucf00\uc77c\ub7ec\uc5d0 \uc758\ud574 \uc0dd\uc131\ub41c \uc11c\ubc84\uc758 \ub0b4\ubd80 IP\ub97c \ucc3e\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Bastion\uc758 \ud130\ubbf8\ub110\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc740 \uba85\ub839\uc73c\ub85c Webserver\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>ssh -i FINAL-KEY.pem ec2-user@10.77.3.93\n</code></pre> </li> <li> <p>\ub2e4\uc74c \uc5d0\ub7ec \ubc1c\uc0dd\uc2dc chmod\ub97c \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> <pre><code>chmod 400 FINAL-KEY.pem\n</code></pre> </li> <li> <p>\uc7ac\uc811\uc18d \ud558\uba74 \uc815\uc0c1\uc801\uc73c\ub85c WebServer\uc5d0 \uc5f0\uacb0\ub41c \uac83\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#rdsmysql","title":"RDS(MySQL)","text":"<ol> <li> <p>DB\uc11c\ubc84\ub97c \uc704\ud55c SG\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p>BastionHost\uc640 WebServer\uc5d0\uc11c 3306\ud3ec\ud2b8\ub97c \uc811\uc18d\ud560 \uc218 \uc788\ub3c4\ub85d SG\uccb4\uc774\ub2dd\uc744 \ub123\uc5b4\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS RDS\ud398\uc774\uc9c0\uc5d0\uc11c DB\uc5d0 \uc0ac\uc6a9\ud560 \uc11c\ube0c\ub137 \uc124\uc815\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p>DB\ub294 private \uc11c\ube0c\ub137\uc5d0 \uc0c1\uc8fc\ud558\ub294 \uac83\uc744 \uc0dd\uac01\ud558\uace0 \uc54c\ub9de\uac8c \uccb4\ud06c\ud558\uba74 \ub429\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>AWS RDS\ud398\uc774\uc9c0\uc5d0\uc11c Create database\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>MySQL\uc744 \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p>\ud559\uc2b5\uc6a9\uc774\ub2c8 \ud558\ub2e8\uc758 Free Tier\uc81c\ud55c \uc635\uc158\ub3c4 \uc120\ud0dd\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>subnet, SG\ub97c \uc798 \uc120\ud0dd\ud574\uc8fc\uace0 DB\uad00\ub828\ud55c \uac12\uc744 \uc54c\ub9de\uac8c \uc801\uc5b4\uc90d\ub2c8\ub2e4</p> <p>/* </p> <p>DB\uc2dd\ubcc4\uc790 : dbdb(x) \u2192 mydb</p> <p>Master User : DBadmin</p> <p>Password : DB-password</p> <p>DatabaseName : lab</p> <p>*/</p> <p></p> <p></p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#db","title":"DB\ub3d9\uc791 \ud655\uc778","text":"<ol> <li> <p>SSH\ub97c \uc774\uc6a9\ud574 Bastion Host\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc774\uc6a9\ud574 Bastion Host\uc5d0 MySQL\uc744 \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>sudo yum -y install mysql\n</code></pre> </li> <li> <p>\uc11c\ubc84\uc811\uc18d\uc744 \uc704\ud574 \ub2e4\uc74c \uba85\ub839\uc744 \uc774\uc6a9\ud574 MySQL \uc744 \uc0ac\uc6a9\ud569\ub2c8\ub2e4</p> <pre><code>mysql -h {DNS} -P {PORT} -u {USER} -p\n                         \u2193(\uc608\uc2dc)\nmysql -h mydb.cnr20hoyd3cu.ap-northeast-2.rds.amazonaws.com -P 3306 -u DBadmin -p\n</code></pre> </li> <li> <p>'MySQL&gt;' \uc774 \ub728\uba74 \uc811\uc18d \uc131\uacf5\ud55c \uac83\uc785\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#mysql-workbench","title":"MySQL workbench","text":"<ol> <li> <p>MySQL Workbench \ub2e4\uc6b4\ub85c\ub4dc &amp; \uc2e4\ud589</p> <p>MySQL :: Download MySQL Workbench</p> </li> <li> <p>Basiton Host \uc0ac\uc6a9\uc2dc \uc544\ub798\uc640 \uac19\uc774 \uc785\ub825</p> <p></p> </li> <li> <p>\uc62c\ubc14\ub974\uac8c \uc791\uc131\ub41c \uc608\uc2dc</p> <p></p> </li> <li> <p>OK\ub204\ub974\uba74 \ube44\ubc00\ubc88\ud638 \uc785\ub825\ucc3d\uc774 \ub739\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc811\uc18d \uc644\ub8cc\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/3-Tier%20Basic%20Infra/#jetbrains-datagrip","title":"Jetbrains DataGrip","text":"<ol> <li> <p>DataGrip\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>MySQL \uc5f0\uacb0\uc744 \uc0c8\ub85c \ub9cc\ub4ed\ub2c8\ub2e4</p> <p></p> </li> <li> <p>SSH\ub97c \uc120\ud0dd\ud558\uace0 \ud130\ub110\ub9c1 \uc124\uc815\uc744 \uc5fd\ub2c8\ub2e4</p> <p></p> </li> <li> <p>BastionHost\uc758 \uc815\ubcf4\ub97c \uc785\ub825\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>General\ub85c \ub3cc\uc544\uc640\uc11c host, port, User, password \uc785\ub825\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc811\uc18d\uc5d0 \uc131\uacf5\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/API%20Gateway%20with%20Lambda/","title":"API Gateway with Lambda","text":""},{"location":"Cloud%20Infra/API%20Gateway%20with%20Lambda/#_1","title":"\ubaa9\uc801","text":"<ul> <li>API Gateway\uc758 \uae30\ucd08\uc801\uc778 \uc0ac\uc6a9\ubc95 \ud655\uc778</li> <li>API Gateway\uc5d0 Lambda\ub97c \uc5f0\uacb0\ud558\uc5ec \ub3d9\uc791 \ud655\uc778</li> <li>HTTP GET Parameter(\ub9e4\uac1c\ubcc0\uc218) \uc804\uc1a1\uacfc \uc751\ub2f5 \ud655\uc778</li> <li>\ub450 \uac1c\uc758 Lambda Function\uc744 \uc0dd\uc131\ud558\uc5ec Root\u00b7Resource Page\uc5d0 \uac01\uac01 \uc801\uc6a9\ud558\uae30</li> </ul>"},{"location":"Cloud%20Infra/API%20Gateway%20with%20Lambda/#_2","title":"\uc2e4\uc2b5","text":"<ol> <li> <p>Lambda \ub3d9\uc791\uc5d0 \ud544\uc694\ud55c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud558\uae30 \uc704\ud574 Role \uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Lambda\uc758 \ucd5c\uc18c \uad8c\ud55c\uc778 CloudWatch \uc811\uadfc \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc704 Role\uc744 \ud65c\uc6a9\ud560 \uc218 \uc788\ub294 Lambda\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>Root Page(/)\uc5d0 \uc801\uc6a9\ud560 \uccab \ubc88\uc9f8 Lambda Function\uc758 \ucf54\ub4dc\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc785\ub825\ud569\ub2c8\ub2e4</p> <pre><code>import json\ndef lambda_handler(event, context):\nmyParam = event['myParam']\nprint('myFunction1 excuted')\nreturn {\n'statusCode': 200,\n'body': json.dumps(myParam)\n}\n</code></pre> <p></p> </li> <li> <p>\ucf54\ub4dc \uc791\uc131\uc744 \uc644\ub8cc\ud558\uc600\uc73c\uba74 \ubc30\ud3ec\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>(/resource)\ud398\uc774\uc9c0\uc5d0 \uc801\uc6a9\ud560 \ub450 \ubc88\uc9f8 \ud568\uc218\ub3c4 \uac19\uc740 \uc124\uc815\uc73c\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub450\ubc88\uc9f8 Lambda Function\uc758 \ucf54\ub4dc\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \uc785\ub825\ud569\ub2c8\ub2e4</p> <pre><code>import json\ndef lambda_handler(event, context):\nmyParam = event['myParam']\nprint('myFunction2 excuted')\nreturn {\n'statusCode': 200,\n'body': json.dumps(myParam)\n}\n</code></pre> <p></p> </li> <li> <p>\ub9c8\ucc2c\uac00\uc9c0\ub85c \ub450 \ubc88\uca30 \ucf54\ub4dc\ub3c4 \uc791\uc131\uc744 \uc644\ub8cc\ud558\uc600\uc73c\uba74 \ubc30\ud3ec\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>API Gateway\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. \ud0c0\uc785\uc740 REST API\ub85c \uc124\uc815\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uccab API \uc774\ub984\uc740 \ud3c9\ubc94\ud558\uac8c myAPI\ub85c \uc124\uc815\ud558\uaca0\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub8e8\ud2b8\ud398\uc774\uc9c0\ub97c GET \ud560\ub54c myFunction1\uc744 \ud638\ucd9c\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>/resource\ud398\uc774\uc9c0\ub97c GET \ud560 \ub54c myFunction2\ub97c \ud638\ucd9c\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud398\uc774\uc9c0\ubcc4 Function\uc744 \uc5f0\uacb0\ud588\uc73c\uba74 Integration Request \uba54\ub274\uc5d0\uc11c GET \uc694\uccad\uc2dc \ud30c\ub77c\uba54\ud130\uac12\uc744 \uac00\uc838\uc62c \uc218 \uc788\ub3c4\ub85d \uc124\uc815\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc544\ub798\uc640 \uac19\uc774 \ud15c\ud50c\ub9bf\uc744 \uc124\uc815\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> <pre><code>{\n\"myParam\": \"$input.params('myParam')\"\n}\n</code></pre> </li> <li> <p>\ud1b5\ud569\ubcf4\uace0 \uacbd\uace0\uac00 \ub728\uba74 YES\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>/resource \uc758 Request \uc5d0\ub3c4 \ub611\uac19\uc774 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> </li> <li> <p>\uc124\uc815\uc774 \uc644\ub8cc\ub418\uba74 API\ub97c \ubc30\ud3ec\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc30\ud3ec\ud560 API\uc774\ub984\uc740 testAPI\ub85c \uc124\uc815\ud558\uaca0\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc30\ud3ec\uac00 \uc644\ub8cc\ub418\uba74 API\uac00 \uc801\uc6a9\ub41c DNS\uc8fc\uc18c\uac00 \ubc1c\uc0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud574\ub2f9 DNS\ub294 HOST\uc5d0\uc11c \ubc14\ub85c \uc811\uadfc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>API\uac00 Lambda\ub97c \uc798 \ud638\ucd9c\ud558\ub294 \uac83\uc744 Cloudwatch\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub9ac\ub205\uc2a4 \ud130\ubbf8\ub110\uc744 \uc774\uc6a9\ud574 \uac04\ud3b8\ud558\uac8c API\ub97c \ud14c\uc2a4\ud2b8 \ud574\ubd05\uc2dc\ub2e4</p> </li> <li> <p>curl \uc744 \uc0ac\uc6a9\ud574 \uc811\uadfc\ud569\ub2c8\ub2e4</p> <pre><code>curl -X GET '{DNS ADDRESS}'\n</code></pre> </li> <li> <p>\uc811\uc18d\uc774 \uac00\ub2a5\ud558\uace0 \ud30c\ub77c\uba54\ud130\uac12\uc774 \uc5c6\uae30 \ub584\ubb38\uc5d0 \ub9ac\ud134\uac12\ub3c4 \uc5c6\uc74c\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> </ol> <p></p> <ol> <li> <p>curl \uba85\ub839\uc5d0 \ud30c\ub77c\uba54\ud130\uac12\ub3c4 \uac19\uc774 \ub0a0\ub824\ubd05\ub2c8\ub2e4</p> <pre><code>curl -X GET '{DNS ADDRESS}?myParam=HELLO'\n</code></pre> </li> <li> <p>API\uac00 \ud30c\ub77c\uba54\ud130\uac12\uc5d0 \uc815\uc0c1\uc801\uc73c\ub85c \ubc18\uc751\ud558\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> </ol> <p></p> <ol> <li> <p>/resource\ud398\uc774\uc9c0\ub3c4 \uc815\uc0c1\uc801\uc73c\ub85c \ubc18\uc751\ud558\ub294 \uac83\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>curl -X GET '{DNS ADDRESS}/resource?myParam=HELLO'\n</code></pre> </li> </ol>"},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/","title":"Access S3, DynamoDB with Lambda","text":""},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>AWS Lambda\ub97c \uc774\uc6a9\ud574 AWS S3, DynamoDB \uc774\ubca4\ud2b8\uc5d0 \ubc18\uc751\ud558\uae30</li> <li>Test Event \uc0ac\uc6a9\ud574\uc11c \ud6a8\uc728\uc131 \ub192\uc774\uae30</li> </ul>"},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/#lambda","title":"Lambda \uc0dd\uc131\ud558\uae30","text":"<ol> <li> <p>Lambda\uc5d0\uc11c \uc0ac\uc6a9\ud560 \uad8c\ud55c\uc744 Role\ub85c \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4</p> <p>CloudWatch\uc5d0 \uc758\ud574 \uc774\ubca4\ud2b8\uac00 \uc2e4\ud589\ub418\ubbc0\ub85c \ubc18\ub4dc\uc2dc CloudWatch\uc4f0\uae30 \uad8c\ud55c\uc744 \ubd80\uc5ec\ud574\uc57c \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Lambda\uc774\ub984\uacfc Role\ub9cc \uc9c0\uc815\ud558\uace0 \uae30\ubcf8\uac12\uc73c\ub85c \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Deploy\ud558\uace0 Test \u2192 Create\ub97c \ub204\ub974\uba74 \uc0d8\ud50c\ucf54\ub4dc\uac00 \uc2e4\ud589\ub429\ub2c8\ub2e4</p> </li> <li> <p>select a test event \u2192 configure test events \u2192 create\ub85c \uc0d8\ud50c \uc774\ubca4\ud2b8\ub97c \uc0dd\uc131\ud574\uc90d\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>print(event) \ucf54\ub4dc\ub97c \ucd94\uac00\ud558\uace0 Deploy\ud55c \ud6c4 Test\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>lambda\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/#aws-s3","title":"AWS S3 \uac1d\uccb4 \uc0dd\uc131 \uc774\ubca4\ud2b8\uc5d0 \ubc18\uc751\ud558\uae30","text":"<ol> <li> <p>Lambda\uc5d0 S3 \uc811\uadfc \uad8c\ud55c\uc774 \uc788\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud2b8\ub9ac\uac70\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774 \ud2b8\ub9ac\uac70\ub294 S3\uc758 create\uc774\ubca4\ud2b8\uc5d0 \ubc18\uc751\ud558\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4</p> <p>S3 Bucket, Event Type\uc744 \uc9c0\uc815\ud558\uace0 \uc694\uae08\uc774 \ub9ce\uc774 \ub098\uc62c \uc218 \uc788\ub294\uac83\uc5d0 \uc8fc\uc758\ud558\ub77c\ub294 \uacbd\uace0\ub3c4 \ub3d9\uc758\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>lambda\uc640 S3\uac00 \uc798 \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc544\ub798 \ucf54\ub4dc\ub97c lambda_function\uc5d0 \ub36e\uc5b4\uc50c\uc6cc\uc90d\ub2c8\ub2e4</p> Lambda function Calculator exercise<pre><code>from __future__ import print_function\nimport re\nimport boto3\ndef lambda_handler(event, context):\n\"Process upload event\"\nbucket = event['Records'][0][\"s3\"][\"bucket\"][\"name\"]\nkey = event['Records'][0][\"s3\"][\"object\"][\"key\"]\nresult = \"No numbers found in file\"\nprint(\"Received event. Bucket: [%s], Key: [%s]\" % (bucket, key))\n# construct s3 client\ns3 = boto3.client('s3')\nresponse = s3.get_object(\nBucket=bucket,\nKey=key\n)\n# get the object contents\nfile_contents = response['Body'].read().decode(\"utf-8\").strip()\n# find matches of all positive or negative numbers\nnumbers = [int(n) for n in re.findall(r\"-?\\d+\", file_contents)]\nif numbers:\n# caclulate min/max/average\nmn, mx, avg = min(numbers), max(numbers), sum(numbers)/len(numbers)\nresult = \"Min: %s Max: %s Average: %s\" % (mn, mx, avg)\nprint(\"Result: %s\" % result)\nreturn result\n</code></pre> </li> <li> <p>\u2b50\ucf54\ub4dc \uc791\uc131 \uc644\ub8cc \ud6c4 \ubc18\ub4dc\uc2dc Deploy \ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \uc22b\uc790\ub370\uc774\ud130\uac00 \ub4e4\uc5b4\uc788\ub294 txt\ud30c\uc77c\uc744 \uc900\ube44\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc5f0\uacb0\ud55c S3\uc5d0 txt\ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>AWS CloudWatch \u2192 Logs \u2192 Log groups\uc758 sample-lambda\uc5d0 \uc0c8\ub85c\uc6b4 Log\uac00 \uae30\ub85d\ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>log\ub97c \ud655\uc778\ud558\uba74 \ucf54\ub4dc\uac00 \uc798 \uc2e4\ud589\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/#lambda-test-event","title":"Lambda test event \ud65c\uc6a9\ud558\uae30","text":"<ol> <li>\ucf54\ub4dc\ub97c Deploy \ud560 \ub54c\ub9c8\ub2e4 S3\uc5d0 \ub9e4\ubc88 \uc5c5\ub85c\ub4dc\ud558\uace0 CloudWatch \ub85c\uadf8\uc5d0 \ub4e4\uc5b4\uac00 \uc624\ub958\ub97c \uc810\uac80\ud558\uae30\ub294 \ub108\ubb34 \ud798\ub4dc\ub2c8 test event\ub97c \uc0ac\uc6a9\ud574\ubd05\uc2dc\ub2e4</li> <li> <p>test\ubaa9\ub85d\uc744 \uc5f4\uace0 configure test events\uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \ucf54\ub4dc\ub97c \uc774\uc6a9\ud574 \uc0c8\ub85c\uc6b4 test event\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>{\n\"Records\": [\n{\n\"s3\": {\n\"bucket\": {\n\"name\": \"kekekekeke\"\n},\n\"object\": {\n\"key\": \"numbers.txt\"\n}\n}\n}\n]\n}\n</code></pre> <p></p> </li> <li> <p>AWS\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 \uc0d8\ud50c test event\ub3c4 \uc0ac\uc6a9\ud574\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc29\uae08 \ub9cc\ub4e0 \ud14c\uc2a4\ud2b8\ub97c \uc120\ud0dd\ud558\uace0 Test \ubc84\ud2bc\uc744 \ub204\ub985\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub9c8\uce58 S3\uc5d0 \uc0c8\ub85c\uc6b4 \ud30c\uc77c\uc774 \uc5c5\ub85c\ub4dc \ub41c \uac83 \uac19\uc774 \ucf54\ub4dc\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Access%20S3%2C%20DynamoDB%20with%20Lambda/#dynamodb","title":"DynamoDB \uc5f0\ub3d9\ud558\uae30","text":"<ol> <li> <p>DynamoDB Inventory \ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Lambda Role\uc5d0 DynamoDB \uad8c\ud55c \ubd80\uc5ec\ud558\uae30</p> <p></p> <p></p> </li> <li> <p>Lambda\uc5d0 \ub2e4\uc74c \ucf54\ub4dc\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code># Load-Inventory Lambda function\n# This function is triggered by an object being created in an Amazon S3 bucket. \n# The file is downloaded and each line is inserted into a DynamoDB table. \nimport json, urllib, boto3, csv \n# Connect to S3 and DynamoDB \ns3 = boto3.resource('s3') \ndynamodb = boto3.resource('dynamodb')\n# Connect to the DynamoDB tables \ninventoryTable = dynamodb.Table('Inventory'); \n# This handler is executed every time the Lambda function is triggered \ndef lambda_handler(event, context): \n# Show the incoming event in the debug log \nprint(\"Event received by Lambda function: \" + json.dumps(event, indent=2)) \n# Get the bucket and object key from the event \nbucket = event['Records'][0]['s3']['bucket']['name'] \nkey = urllib.parse.unquote_plus(event['Records'][0]['s3']['object']['key']) \nlocalFilename = '/tmp/inventory.txt' \n# Download the file from S3 to the local filesystem \ntry: \ns3.meta.client.download_file(bucket, key, localFilename) \nexcept Exception as e: \nprint(e) \nprint('Error getting object {} from bucket {}. Make sure they exist and your bucket is in the same region as this function.'.format(key, bucket)) \nraise e \n# Read the Inventory CSV file \nwith open(localFilename) as csvfile: \nreader = csv.DictReader(csvfile, delimiter=',')\n# Read each row in the file \nrowCount = 0 \nfor row in reader: \nrowCount += 1 \n# Show the row in the debug log \nprint(row['store'], row['item'], row['count']) \ntry:\n# Insert Store, Item, and Count into the Inventory table \ninventoryTable.put_item( \nItem={ \n'Store': row['store'], \n'Item': row['item'], \n'Count': int(row['count'])}) \nexcept Exception as e: \nprint(e) \nprint(\"Unable to insert data into DynamoDB table\".format(e)) \n# Finished! \nreturn \"%d counts inserted\" % rowCount\n</code></pre> </li> <li> <p>\ucf54\ub4dc\ub97c Deploy \ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ubca4\ud2b8 \ud2b8\ub9ac\uac70\ub97c \uac00\uc9c0\uace0 \uc788\ub294 S3\uc5d0 \uc0d8\ud50c\ud30c\uc77c\uc744 \uc5c5\ub85c\ub4dc \ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/","title":"Failover for HA","text":""},{"location":"Cloud%20Infra/Failover%20for%20HA/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\ub97c \uc774\uc6a9\ud55c HA \uad6c\ud604</li> <li>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 GUI\ub3c4\uad6c\ub97c \uc774\uc6a9\ud55c \uc26c\uc6b4 \uc774\ud574</li> <li>Master\uac00 \ub2e4\uc6b4\ub418\uba74 \uc790\ub3d9\uc73c\ub85c Fail-Over \ub3d9\uc791</li> <li>\uc778\uc704\uc801\uc73c\ub85c \ub9c8\uc2a4\ud130\ub97c \ub2e4\uc6b4\uc2dc\ucf1c\uc11c \ub3d9\uc791 \ud655\uc778</li> <li>\uc0ac\ub78c\uc758 \uac1c\uc785 \uc5c6\uc774 \uc790\ub3d9\uc73c\ub85c FailOver\uac00 \uc774\ub904\uc9c0\ub3c4\ub85d \uc790\ub3d9\ud654\ub97c \uad6c\ud604</li> </ul>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#_2","title":"\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \uc138\ud305","text":""},{"location":"Cloud%20Infra/Failover%20for%20HA/#_3","title":"\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \ucee8\ud14c\uc774\ub108 \ub85c\ub4dc","text":"<ol> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4(openarkcode/orchestrator)</p> <p>\uc774\uc804\uc5d0 \uc0dd\uc131\ud55c mybridge\uc5d0 \uc5f0\uacb0\ud558\uba70 \ud638\uc2a4\ud2b8\ud3ec\ud2b8 3000\uc5d0 \ub9e4\ud551\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name orchestrator -h orchestrator --net mybridge --net-alias=orchestrator -p 3000:3000 -d openarkcode/orchestrator:latest\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uac00 \uc798 \ub85c\ub4dc\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>docker ps --format \"table {{.ID}}\\t{{.Names}}\\t{{.Status}}\"\n</code></pre> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#db","title":"\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\ub97c \uc704\ud55c DB \uc124\uc815","text":"<ol> <li> <p>\uc774\uc804\uc758 \uc791\uc5c5\uc744 \uc774\uc5b4\uc11c \ud558\uae30 \uc704\ud574 DB\ucee8\ud14c\uc774\ub108\ub97c \uc7ac\uc2dc\uc791 \ud569\ub2c8\ub2e4</p> <p>\ucee8\ud14c\uc774\ub108(\ub3c4\ucee4 \ud638\uc2a4\ud2b8)\ub97c \uc885\ub8cc\ud558\uc9c0 \uc54a\uc558\ub2e4\uba74 \uc0dd\ub7b5\ud569\ub2c8\ub2e4</p> <pre><code>docker start db001 db002 db003\n</code></pre> </li> <li> <p>db001 SQL DB\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\ub97c \uc704\ud55c MySQL \uc720\uc800 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER orc_client_user@'172.%' IDENTIFIED BY 'orc_client_password';\n</code></pre> </li> <li> <p>\ud544\uc694\ud55c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4 1</p> <pre><code>GRANT SUPER, PROCESS, REPLICATION SLAVE, RELOAD ON *.* TO orc_client_user@'172.%';\n</code></pre> </li> <li> <p>\ud544\uc694\ud55c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4 2</p> <pre><code>GRANT SELECT ON mysql.slave_master_info TO orc_client_user@'172.%';\n</code></pre> </li> <li> <p>\uc6f9\ube0c\ub77c\uc6b0\uc800\uc5d0\uc11c \ud638\uc2a4\ud2b8\uc758 3000\ubc88 \ud3ec\ud2b8\uc5d0 \uc5f0\uacb0\ud558\uc5ec \uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 GUI\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>http://{DOCKER HOST IP}:3000\n//EC2 \uc778\uc2a4\ud134\uc2a4\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0 \ub124\ud2b8\uc6cc\ud06c \uc778\ubc14\uc6b4\ub4dc\uc5d0 3000\ubc88 \ud3ec\ud2b8\ub97c \uc5f4\uc5b4\uc918\uc57c\ud569\ub2c8\ub2e4\n</code></pre> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#_4","title":"\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \uc124\uc815","text":"<ol> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\uc5d0 \ucee8\ud14c\uc774\ub108\ub97c \ucd94\uac00\ud558\uae30 \uc704\ud574 Clusters \u2192 Discover\ub85c \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uc758 \uc774\ub984\uacfc (\ud638\uc2a4\ud2b8)\ud3ec\ud2b8 \ubc88\ud638\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\uac00 db001\uc744 \ucc3e\ub294\ub370 \uc131\uacf5\ud588\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Dashboard\uc5d0\uc11c db001 \ucee8\ud14c\uc774\ub108\uc758 ID\ub97c \ub20c\ub7ec \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\uac00 SLAVE\ub85c \uc5f0\uacb0\ub41c DB\uae4c\uc9c0 \uc798 \ucc3e\uc558\uc2b5\ub2c8\ub2e4</p> <p></p> <p>\ub9c8\uc2a4\ud130\uc640 \uc2ac\ub808\uc774\ube0c\uac00 \uc5f0\uacb0\ub420 \ub54c \uae4c\uc9c0 \uc2dc\uac04\uc774 \uc870\uae08 \uac78\ub9b4 \uc218 \uc788\uc2b5\ub2c8\ub2e4 </p> </li> <li> <p>\uc774\ub54c \ucee8\ud14c\uc774\ub108 ID\uac00 \uc544\ub2cc \ubcc4\uce6d\uc73c\ub85c \ucf58\uc194\uc744 \uc81c\uc5b4\ud558\uace0 \uc2f6\uc73c\uba74 \ucee8\ud14c\uc774\ub108\ub97c \uc0dd\uc131\ud560 \ub54c -h \uc635\uc158\uc73c\ub85c hostname\uc744 \ubd80\uc5ec\ud558\uba74 \ub429\ub2c8\ub2e4</p> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#ha","title":"HA(\uace0\uac00\uc6a9\uc131) \ud14c\uc2a4\ud2b8","text":"<ol> <li> <p>\uc7a5\uc560\uc0c1\ud669\uc744 \ub9cc\ub4e4\uae30 \uc704\ud574 \ub9c8\uc2a4\ud130DB \ucee8\ud14c\uc774\ub108(db001)\uc744 \uc815\uc9c0\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db001\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uac00 \uc815\uc9c0\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\uac00 db001\uc5d0 \uc811\uc18d \ubd88\uac00\ub2a5\ud574\uc9c4\uac83\uc744 \ud655\uc778\ud588\uace0, Recover\uac00 \ud544\uc694\ud568\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Recover(\ubcf5\uad6c) \uba54\ub274\uc5d0\uc11c db002\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc7a5\uc560\uac00 \ubc1c\uc0dd\ud55c db001\uc740 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c \uaca9\ub9ac\ub418\uace0</p> <p></p> </li> <li> <p>db002\uac00 Master\ub85c \uc2b9\uaca9\ub418\uc5c8\uc73c\uba70, db003\uc740 Slave\ub85c\uc368 db002\ub97c Master \ubc14\ub77c\ubcf4\uace0 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub9c8\uc2a4\ud130\uac00 \ub41c db002\ub294 ReadOnly \uac12\uc774 OFF \ub41c \uac83\uc744 \ucf58\uc194\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud130\ubbf8\ub110\uc5d0\uc11c \uc9c1\uc811 \ud655\uc778\ud574\ubcfc\uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4</p> <p>db002 SQL DB\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db002 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>slave \uc0c1\ud0dc\uc870\ud68c \uba85\ub839\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>show slave status \\G\n</code></pre> </li> <li> <p>\ud604\uc7ac Slave \uc0c1\ud0dc\uac00 \uc544\ub2c8\uae30 \ub54c\ubb38\uc5d0 empty set\uc744 \ub9ac\ud134\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#fail-over","title":"Fail-Over \uc774\ud6c4 \ubcf5\uad6c","text":"<ol> <li> <p>\uae30\uc874\uc5d0 Master\uc600\ub358 db001 \ucee8\ud14c\uc774\ub108\ub97c \ub2e4\uc2dc \uad6c\ub3d9\ud569\ub2c8\ub2e4</p> <pre><code>docker start db001\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uac00 \uc811\uc18d \uac00\ub2a5\ud55c \uc0c1\ud0dc\uc774\uc9c0\ub9cc \uc5ec\uc804\ud788 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c \ubd84\ub9ac\ub418\uc5b4 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>db001 \ucee8\ud14c\uc774\ub108\uc758 MySQL\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>db001\uc744 slave\ub85c \ub3d9\uc791\uc2dc\ud0a4\uae30 \uc704\ud574 read_only\ub85c \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>set global read_only=1;\n</code></pre> </li> <li> <p>db002 MASTER\ub97c \ubc14\ub77c\ubcf4\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>CHANGE MASTER TO MASTER_HOST='db002', MASTER_USER='repl', MASTER_PASSWORD='repl', MASTER_AUTO_POSITION=1;\n</code></pre> </li> <li> <p>slave\ub85c\uc368\uc758 \ub3d9\uc791\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>start slave;\n</code></pre> </li> <li> <p>slave \uc0c1\ud0dc\ub97c \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>show slave status \\G\n</code></pre> </li> <li> <p>db001\uc774 db002\ub97c \ub9c8\uc2a4\ud130\ub85c \ubc14\ub77c\ubcf4\uace0 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c db002\uac00 Master\ub85c\uc368 \ub3d9\uc791\ud558\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud398\uc77c\uc624\ubc84\uac00 \ubc1c\uc0dd\ud588\uc74c\uc744 \ud655\uc778\ud558\uae30 \uc704\ud574  \ucf58\uc194\uc5d0\uc11c \ud398\uc77c\uc624\ubc84 \ub0b4\uc5ed\uc744  Acknowledge \ucc98\ub9ac\ud569\ub2c8\ub2e4</p> <p></p> <p>ack\ub4f1 \ucf54\uba58\ud2b8\ub97c \uc785\ub825\ud574\uc11c \ud655\uc778</p> </li> </ol>"},{"location":"Cloud%20Infra/Failover%20for%20HA/#auto-fail-over","title":"AUTO Fail-Over","text":"<ol> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \ucee8\ud14c\uc774\ub108\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it orchestrator /bin/bash\n</code></pre> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \uc124\uc815 \ud30c\uc77c\uc744 \uc218\uc815\ud569\ub2c8\ub2e4</p> <pre><code>vi /etc/orchestrator.conf.json\n</code></pre> </li> <li> <p>JSON\uc5d0 \ub2e4\uc74c \uac12\uc744 \uc218\uc815 \ud569\ub2c8\ub2e4. db001, db002\uac04\uc758 Failover\ub9cc \ud14c\uc2a4\ud2b8 \ud558\uae30 \uc704\ud574 db003\uc774 \ub9c8\uc2a4\ud130\ub85c \uc2b9\uaca9\ub418\ub294 \uc77c\uc774 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub3c4\ub85d \uc81c\uc678\ud574\ub461\ub2c8\ub2e4.</p> <p>\uc774\ub300\ub85c \uad6c\ud604\ub418\uba74 db001 \u2194 db002 \uac04\uc5d0 \uc7a5\uc560 \ubc1c\uc0dd\uc2dc \ubc88\uac08\uc544\uac00\uba70 Master\ub85c \uc2b9\uaca9\ub429\ub2c8\ub2e4</p> <pre><code>\"RecoverMasterClusterFilters\":[\n\"*\"\n],\n\"PromotionIgnoreHostnameFilters\":[\n\"db003\"\n]\n</code></pre> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130 \ucee8\ud14c\uc774\ub108\ub97c \uc7ac\uc2dc\uc791 \ud569\ub2c8\ub2e4</p> <pre><code>docker restart orchestrator\n</code></pre> </li> <li> <p>Auto Failover\uac00 \uc798 \uc124\uc815\ub418\uba74 \ud558\ud2b8 \ud45c\uc2dc\uc5d0 \ubd88\uc774 \ub4e4\uc5b4\uc635\ub2c8\ub2e4</p> <p></p> </li> <li> <p>db002 \ucee8\ud14c\uc774\ub108\ub97c \uc911\uc9c0\ud558\uc5ec Fail-Over\ub97c \ud14c\uc2a4\ud2b8\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db002\n</code></pre> </li> <li> <p>\ubcc4 \ub2e4\ub978 \uc791\uc5c5\uc744 \ud558\uc9c0 \uc54a\uc544\ub3c4 db002\uac00 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c \ubd84\ub9ac\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc606\uc9d1 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c db001\uc774 \ub9c8\uc2a4\ud130\ub85c \uc798 \uc0b4\uace0 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud398\uc77c\uc624\ubc84\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\uc73c\uba74 \ubcf5\uad6c\ub97c \uc704\ud574 db002\ub97c \ub2e4\uc2dc \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker start db002\n</code></pre> </li> <li> <p>db002\uc758 MySQL\uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db002 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>db001\uc744 \ub9c8\uc2a4\ud130\ub85c \ubc14\ub77c\ubcf4\ub3c4\ub85d db002\ub97c slave\ub85c \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>CHANGE MASTER TO MASTER_HOST='db001', MASTER_USER='repl', MASTER_PASSWORD='repl', MASTER_AUTO_POSITION=1;\nSTART SLAVE;\n</code></pre> </li> <li> <p>\uc774\ucc98\ub7fc GUI \ucf58\uc194\uc744 \uc774\uc6a9\ud558\uba74 \ubcc0\ud654\ub97c \uc27d\uac8c \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Cloud%20Infra/Transaction%20on%20GCP%20Spanner/","title":"Transaction on GCP Spanner","text":""},{"location":"Cloud%20Infra/Transaction%20on%20GCP%20Spanner/#_1","title":"\uc548\ub0b4","text":"<p>Notice</p> <p>\ud83d\udca1 \ub2e4\uc74c \uc11c\uc801\uc744 \uacf5\ubd80\ud558\uba70 \uc694\uc57d\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p>"},{"location":"Cloud%20Infra/Transaction%20on%20GCP%20Spanner/#spanner","title":"Spanner\ub97c \uc65c \uc0ac\uc6a9\ud574\uc57c \ud560\uae4c","text":"<p>\uac04\ub2e8\ud558\uac8c \uc694\uc57d\ud558\uc790\uba74, \uc2dc\ub300\uac00 \ubc1c\uc804\ud568\uc5d0 \ub530\ub77c \ucef4\ud4e8\ud130\uac00 \uac00\uc9c0\uac8c \ub418\ub294 \ub370\uc774\ud130\uc758 \uc591\uc774 \ub108\ubb34 \ub298\uc5c8\uace0 \uc774\ub294 \ud1b5\uc81c\uac00 \ub9e4\uc6b0 \uc5b4\ub835\uc2b5\ub2c8\ub2e4. \uc774\ub97c \uc704\ud574 \uae30\uc874 RDB\uc5d0 \ud2b8\ub799\uc7ad\uc158, \uac15\ub825\ud55c \uc77c\uad00\uc131, \uc218\ud3c9\ud655\uc7a5\uc131 \ub4f1 \ub2e4\uc591\ud55c \uae30\ub2a5\uc744 \uc9c0\uc6d0\ud558\ub294 NewSQL DB\uac00 \ub4f1\uc7a5\ud558\uc600\uace0, Spanner\ub294 \uc774\ub97c \uc9c0\uc6d0\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4.</p> <p>\uc774\ub7ec\ud55c Spanner\ub294 SQL\uc758 \uae30\ub2a5\uc744 \uc0ac\uc6a9\ud560 \uc218 \uc788\uc74c\uc740 \ubb3c\ub860 \ucffc\ub9ac\ubcf5\uc7a1\ub3c4, \ub0b4\uad6c\uc131, \uc18d\ub3c4, \ucc98\ub9ac\ub7c9 \ubd80\ubd84\uc5d0\uc11c \ub9e4\uc6b0 \uc6b0\uc218\ud558\uae30\ub54c\ubb38\uc5d0 \ub300\uaddc\ubaa8 \uc2e4\uc2dc\uac04 \ucc98\ub9ac\uac00 \ud544\uc694\ud55c \uacbd\uc6b0 \uace0\ub824\ud560 \uc218 \uc788\ub294 \uc218\ub2e8 \uc911 \ud558\ub098\uc785\ub2c8\ub2e4.</p>"},{"location":"Cloud%20Infra/Transaction%20on%20GCP%20Spanner/#_2","title":"\uc2e4\uc2b5","text":"<ol> <li> <p>Spanner \uc0ac\uc6a9\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Spanner\uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc774\ub54c Instance ID\ub294 API \ud638\ucd9c\uc5d0 \ud544\uc694\ud55c \uacf5\uc2dd ID \uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc2a4\ud328\ub108\uc5d0\uc11c \uc0ac\uc6a9\ud560 DB\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>SQL\uc744 \uc774\uc6a9\ud574 DB\ub0b4 \ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud14c\uc774\ube14\uc774 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4.  sql\ub85c \uc0dd\uac01\ud558\uba74 'desc employees' \uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>google cloud SDK(\uc774\ud558 SDK)\uc5d0\uc11c \uc811\uc18d\ud558\uae30 \uc704\ud574 \ub2e4\uc74c \uba85\ub839\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>gcloud auth application-default login {Project ID}\n</code></pre> </li> <li> <p>6.3 \ucf54\ub4dc\ub97c \uc774\uc6a9\ud574 \ud14c\uc774\ube14\uc5d0 \uac12\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4. \uc774\ub54c 6.3 \ucf54\ub4dc\ub294 JSON\uc744 \uc774\uc6a9\ud574 \ub370\uc774\ud130\ub97c \uc0bd\uc785\ud569\ub2c8\ub2e4https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.3.js</p> </li> <li>\ub370\uc774\ud130\uac00 \uc798 \uc0bd\uc785\ub418\uba74 \ub2e4\uc74c\uacfc \uac19\uc774 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</li> <li> <p>@SDK</p> <p></p> </li> <li> <p>@\ucf58\uc194</p> <p></p> </li> <li> <p>6.4 \ucf54\ub4dc\ub97c \uc774\uc6a9\ud574 KEY\uac12\uc774 '1'\uc778 \ud589\uc758 \uc815\ubcf4\ub97c \uac00\uc838\uc635\ub2c8\ub2e4  https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.4.js</p> </li> <li> <p>\uc798 \uc2e4\ud589\ub418\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>6.5 \ucf54\ub4dc\ub97c \uc0ac\uc6a9\ud574 \ubaa8\ub4e0 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc62c \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4 https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.5.js</p> <p></p> </li> <li> <p>SDK\ucf54\ub4dc\uac00 \uc544\ub2cc SQL\uad6c\ubb38\uc744 \uc774\uc6a9\ud574 \uc815\ubcf4\ub97c \ubd88\ub7ec\uc62c \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4. SDK\ucf54\ub4dc\uc5d0 SQL\uad6c\ubb38\uc744 \uc0bd\uc785\ud558\uc5ec \uc2e4\ud589\ud558\ub294 6.6\ucf54\ub4dc\ub97c \uc2e4\ud589\ud574\ubd05\ub2c8\ub2e4 https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.6.js</p> <p></p> </li> <li> <p>\uc774\ub54c where\uc808\uc5d0 \uc635\uc158\uc744 \ub123\uace0 \uc2f6\uc73c\uba74 6.7\ucf54\ub4dc\uc640 \uac19\uc774 \ud30c\ub77c\uba54\ud130\ub97c \uc0bd\uc785\ud569\ub2c8\ub2e4 https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.7.js</p> <p></p> </li> <li> <p>\ud14c\uc774\ube14\uc758 \uc2a4\ud0a4\ub9c8\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ub450 \uac00\uc9c0 \ubc29\ubc95\uc73c\ub85c \ubcc0\uacbd\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>\u2460 \ucf58\uc194\uc5d0\uc11c DDL\uc744 \uc774\uc6a9\ud574 \uc9c1\uc811 \ubcc0\uacbd\ud558\uae30</p> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \uc801\uc6a9\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\u2461 SDK\uc5d0 SQL\uad6c\ubb38 \uc9c1\uc811 \uc2e4\uc5b4\ubcf4\ub0b4\uae30</p> <pre><code>gcloud spanner databases ddl update test-database --instance=test-instance --ddl=\"ALTER TABLE employees ALTER COLUMN name STRING(MAX) NOT NULL;\"\n</code></pre> </li> <li> <p>\uc0c9\uc778\uc744 \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \uc0c9\uc778\ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE INDEX employees_by_name ON employees (name)\n</code></pre> <p></p> </li> <li> <p>\uc0c9\uc778 \ud6c4 \ub2e4\uc2dc \ub370\uc774\ud130\ub85c \ub3cc\uc544\uac00 \ucd94\uac00 \ub370\uc774\ud130\ub97c \uac00\uc838\uc624\ub294 \uac83\uc744 \ube44\ud6a8\uc728\uc801\uc774\uae30 \ub54c\ubb38\uc5d0 \uc560\ucd08\uc5d0 \uc0c9\uc778\ud14c\uc774\ube14\uc5d0 \ub2e4\ub978 \ub370\uc774\ud130\ub3c4 \ucd94\uac00\ub85c \uc0bd\uc785\ud574\ub458 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>CREATE INDEX employees_by_name ON employees (name) STORING (start_date)\n</code></pre> </li> <li> <p>\uc0c9\uc778\ud14c\uc774\ube14\uc5d0 \ub2e4\ub978\ub370\uc774\ud130 \uc5f4\uc774 \ucd94\uac00\ub85c \uc9c0\uc815\ub41c \ubaa8\uc2b5\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud2b8\ub79c\uc7ad\uc158\uc744 \uacbd\ud5d8\ud574\ubcf4\uae30 \uc704\ud574 6.18\ucf54\ub4dc\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4 https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.18.js \ucf54\ub4dc\ub97c \uc0b4\ud3b4\ubcf4\uba74 \ud2b8\ub79c\uc7ad\uc158 \uc678\ubd80\uc5d0\uc11c \uc791\uc5c5\ud55c \ud6c4 \uc801\uc6a9\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc77d\uae30/\uc4f0\uae30 \ud2b8\ub79c\uc7ad\uc158\uc740 \uc694\uc57d\uc774 \ubd88\uac00\ub2a5 \ud558\ubbc0\ub85c \uc11c\uc801\uc5d0 \uc791\uc131\ub41c \uae00\uc744 \ubaa8\ub450 \uc77d\uc5b4\uc57c \ud569\ub2c8\ub2e4</p> </li> <li>\ub3d9\uc77c\ud589\uc744 \ucc98\ub9ac\ud558\ub294 \ud2b8\ub79c\uc7ad\uc158\uc740 6.20\ucf54\ub4dc\ub97c \uc0b4\ud3b4\ubcf4\uba74 \ub429\ub2c8\ub2e4 https://github.com/Jpub/GCP/blob/master/Chapter_6/list6.20.js</li> </ol>"},{"location":"Cloud%20Infra/VPC%20Endpoint%20with%20Role/","title":"VPC Endpoint with Role","text":""},{"location":"Cloud%20Infra/VPC%20Endpoint%20with%20Role/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>Bastion Host\ub97c \uc774\uc6a9\ud55c Private Network\uc758 \uc6f9 \uc11c\ubc84 \uc811\uc18d</li> <li>Endpoint\ub97c \uc774\uc6a9\ud574 \uac8c\uc774\ud2b8\uc6e8\uc774 \uc5c6\uc774 VPC\uc5d0\uc11c S3, DynamoDB \uc811\uc18d</li> <li>Credential\uc774 \uc544\ub2cc Role\uc744 \uc774\uc6a9\ud55c \uad8c\ud55c\uc801\uc6a9\uc73c\ub85c \ubcf4\uc548\uc131 \ud655\ubcf4</li> </ul>"},{"location":"Cloud%20Infra/VPC%20Endpoint%20with%20Role/#_2","title":"\uad6c\uc131\ub3c4","text":""},{"location":"Cloud%20Infra/VPC%20Endpoint%20with%20Role/#_3","title":"\uc2e4\uc2b5","text":"<ol> <li> <p>AWS IAM\uc5d0\uc11c CLI\uc6a9 \uacc4\uc815 \uc0dd\uc131</p> <p></p> <p>\uad8c\ud55c\uc740 \uc544\ubb34\uac83\ub3c4 \uc8fc\uc9c0 \uc54a\uc558\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>\uacc4\uc815 \uc124\uc815\uc5d0\uc11c Access Key\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc0dd\uc131\ub41c Access Key \uc640 Secret access key\ub97c \uc798 \ubcf4\uad00\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Bastion Host \uc5d0 SSH \uc811\uc18d</p> <p></p> </li> <li> <p>SSH\ub97c \ud55c \ubc88 \ub354 \uc0ac\uc6a9\ud558\uc5ec Private \ub124\ud2b8\uc6cc\ud06c\uc5d0 \uc788\ub294 \uc6f9 \uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc0ac\uc6a9\ud574 AWS Boto\uac00 \uc815\uc0c1 \uc791\ub3d9\ud558\ub294 \uac83\uc744 \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>aws --version // aws boto \ubc84\uc804 \ud655\uc778\n</code></pre> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc0ac\uc6a9\ud574 aws CLI\uc5d0 \ub85c\uadf8\uc778 \ud560 \uacc4\uc815 \uc815\ubcf4\ub97c \uc785\ub825\ud569\ub2c8\ub2e4</p> <p>\uc55e\uc11c 3\ubc88\uc5d0\uc11c \uc0dd\uc131\ub41c \ud0a4\uac12\uacfc \ub9ac\uc804\uc744 \uc785\ub825\ud574\uc90d\ub2c8\ub2e4. \uc11c\uc6b8 \ub9ac\uc804\uc740 ap-northeast-2\uc785\ub2c8\ub2e4.</p> <p>Output format\uc740 JSON \uc785\ub825\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <pre><code>aws configure\n</code></pre> <p></p> </li> <li> <p>\ub77c\uc6b0\ud305 \uacbd\ub85c\uac00 \uc5c6\uc5b4 \uc811\uc18d\uc774 \ubd88\uac00\ub2a5 \ud55c \uc0c1\ud0dc\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc6f9 \uc11c\ubc84 \uc11c\ube0c\ub137\uc758 \ub77c\uc6b0\ud305 \uc0c1\ud0dc\uc785\ub2c8\ub2e4. \uc5f0\uacb0\ub41c \uac8c\uc774\ud2b8\uc6e8\uc774\uac00 \uc5c6\uc5b4 \ud604\uc7ac \ud145\ud145 \ube44\uc5b4\uc788\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>VPC\uc5d0 S3\uc640 DynamoDB\ub85c \ud5a5\ud558\ub294 Endpoint\ub97c \uac01\uac01 \uc0dd\uc131\ud574\uc90d\ub2c8\ub2e4</p> <p></p> <p>Name tag : EP-for-S3</p> <p></p> <p>Name tag : EP-for-DynamoDB</p> </li> <li> <p>private \uc11c\ube0c\ub137\uc758 Route Table\uc744 \ud655\uc778\ud558\uba74 \uc5d4\ub4dc\ud3ec\uc778\ud2b8 2\uac1c\uac00 \uc5f0\uacb0\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>S3 \u2194 VPC \u2194 DynamoDB\uac04\uc758 \uc5f0\uacb0\uc774 \uc644\ub8cc\ub418\uc5c8\uc73c\ub2c8 </p> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc0ac\uc6a9\ud574 \uad8c\ud55c \ubd80\uc871\uc73c\ub85c S3, DynamoDB \uc811\uc18d\uc774 \uac70\ubd80\ub418\ub294 \uac83\uc744 \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>aws s3 ls // S3 \ubaa9\ub85d \ubcf4\uae30\naws dynamodb list-tables // DynamoDB \ubaa9\ub85d \ubcf4\uae30\n</code></pre> <p></p> </li> <li> <p>AWS IAM \u2192 Roles \uc5d0\uc11c \uc0c8\ub85c\uc6b4 Role \uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p>\ud604\uc7ac Bastion Host\ub294 AWS EC2 Instance \uc774\ubbc0\ub85c \uc544\ub798\uc640 \uac19\uc774 \uc124\uc815\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>S3\uc640 DynamoDB Full Access \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>\ucd5c\uc885\uc801\uc73c\ub85c \uc544\ub798\uc640 \uac19\uc740 \uc124\uc815\uc774 \ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2 \uc778\uc2a4\ud134\uc2a4 Actions\uc5d0\uc11c Role Modify\uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc29\uae08 \ub9cc\ub4e0 \uc5ed\ud560\uc744 \uc120\ud0dd\ud574\uc8fc\uba74 \ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>SSH\ub85c \ub3cc\uc544\uc640\ubcf4\uba74 \uc6f9 \uc11c\ubc84\ub294 \uc5ec\uc804\ud788 \uad8c\ud55c\uc774 \uc5c6\uc2b5\ub2c8\ub2e4. </p> <p></p> </li> <li> <p>\uad8c\ud55c \uc6b0\uc120\uc21c\uc704\ub294 Credential\uc774 Role\ubcf4\ub2e4 \ub192\uae30 \ub584\ubb38\uc5d0</p> <p>\uc6f9 \uc11c\ubc84 Credential\uc744 \uc9c0\uc6cc\uc11c Role\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> </li> </ol> <pre><code>rm ~/.aws/credentials\n</code></pre> <pre><code>![VPC Endpoint with Role/Untitled%2021.png](VPC Endpoint with Role/Untitled%2021.png)\n</code></pre> <ol> <li> <p>\ub2e4\uc2dc \uc2dc\ub3c4\ud574\ubcf4\uba74 S3\uc640 DynamoDB\uc5d0 \uc811\uc18d\uc744 \uc131\uacf5\ud558\uac8c \ub429\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>\uba54\ud0c0\ub370\uc774\ud130 \ud655\uc778\uc744 \ud1b5\ud574 Role\uc124\uc815\uc744 \uc870\ud68c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc73c\ub85c S3 \ubc84\ud0b7\ub3c4 \ub9cc\ub4e4\uc5b4 \ubd05\ub2c8\ub2e4</p> <pre><code>aws s3 mb s3://mybucket\n</code></pre> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc73c\ub85c DynamoDB \ud14c\uc774\ube14\ub3c4 \ub9cc\ub4e4\uc5b4 \ubd05\ub2c8\ub2e4</p> <pre><code>aws dynamodb create-table \\\n    --table-name Music \\\n    --attribute-definitions \\\n        AttributeName=Artist,AttributeType=S \\\n        AttributeName=SongTitle,AttributeType=S \\\n    --key-schema \\\n        AttributeName=Artist,KeyType=HASH \\\n        AttributeName=SongTitle,KeyType=RANGE \\\n    --billing-mode PAY_PER_REQUEST \\\n    --stream-specification StreamEnabled=true,StreamViewType=NEW_AND_OLD_IMAGES \\\n    --region us-east-2\n</code></pre> <p>\uc790\uc2b5\uc11c: \uc804\uc5ed \ud14c\uc774\ube14 \uc0dd\uc131</p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/","title":"CICD on Single container","text":""},{"location":"DevOps/CICD%20on%20Single%20container/#_1","title":"\ubaa9\ud45c","text":"<ol> <li>\ub3c4\ucee4, \ub3c4\ucee4\ucef4\ud3ec\uc988\ub97c \uc774\uc6a9\ud55c \ud14c\uc2a4\ud2b8\ubca0\ub4dc, \uc6b4\uc601\ud658\uacbd \uc2e4\ud589\ud658\uacbd \uad6c\uc131</li> <li>Travis CI\ub97c \uc774\uc6a9\ud574 Github \u2192 Travic CI \u2192 AWS Beanstalk \ud30c\uc774\ud504\ub77c\uc778 \uad6c\ud604</li> <li>CICD \uccb4\ud5d8\uc774 \ubaa9\uc801\uc774\uae30 \ub584\ubb38\uc5d0 Nginx, \ub9ac\uc561\ud2b8\ub294 \uc791\uc5c5\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4</li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#init","title":"Init","text":""},{"location":"DevOps/CICD%20on%20Single%20container/#react-setup","title":"React setup","text":"<ol> <li> <p>\uc791\uc5c5 \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4     <pre><code>mkdir simple_app\ncd simple_app\n</code></pre></p> </li> <li> <p>\ud604\uc7ac \ub514\ub809\ud130\ub9ac\uc5d0 react\ub97c \uc124\uce58\ud569\ub2c8\ub2e4     <pre><code>npx create-react-app ./\n</code></pre></p> <p></p> </li> <li> <p>\ub9ac\uc561\ud2b8\uac00 \uc798 \ub3d9\uc791\ud569\ub2c8\ub2e4</p> <ul> <li> <p>npm run test</p> <p></p> </li> <li> <p>npm run start</p> <p></p> </li> </ul> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#dockerfile","title":"Dockerfile","text":"<ol> <li>\uac1c\ubc1c\ud658\uacbd(dev)\uacfc \uc6b4\uc601\ud658\uacbd(prod)\ub294 \ud2b9\uc131\uc774 \ub2e4\ub97c \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 \ub3c4\ucee4\ud30c\uc77c\uc744 \ubd84\ub9ac\ud574\uc57c\ud569\ub2c8\ub2e4</li> <li> <p>\uac1c\ubc1c \ud658\uacbd\uc758 \ub3c4\ucee4\ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4     <pre><code>code dockerfile.dev\n</code></pre></p> <pre><code>FROM node:alpine\nWORKDIR /usr/src/app\nCOPY package.json ./\n\nRUN npm install\n\nCOPY ./ ./\n\nCMD [\"npm\", \"run\", \"start\"]\n</code></pre> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#deploy-container","title":"Deploy container","text":"<ol> <li> <p>\uc774\ubbf8\uc9c0\ub97c \ube4c\ub4dc\ud574\ubd05\ub2c8\ub2e4     !!! tip         \ud83d\udca1 \ub3c4\ucee4 \ud658\uacbd\uc5d0\uc11c node\ub97c \uc2e4\ud589\ud560 \ub54c\ub294 \ub85c\uceec\uc5d0 node_module\uac00 \ud544\uc694\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4         \uc4f8\ub370\uc5c6\uc774 \ube4c\ub4dc \uc2dc\uac04\ub9cc \uae38\uc5b4\uc9c0\uac8c \ud558\ub294 node_module\ub97c \uc9c0\uc6b0\uace0 \uc774\ubbf8\uc9c0\ub97c \ube4c\ub4dc \ud569\ub2c8\ub2e4         rm -rf node_modules</p> <p>Warning</p> <p>\ud83d\udca1 \ud604\uc7ac \ub3c4\ucee4\ud30c\uc77c \uc774\ub984\uc740 dockerfile\uc774 \uc544\ub2c8\ubbc0\ub85c -f \ud30c\ub77c\uba54\ud130\ub85c \uc9c0\uc815\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>docker build -t dotoryeee/simple-app -f dockerfile.dev ./\n</code></pre> </li> <li> <p>\uc0dd\uc131\uc774 \uc644\ub8cc\ub418\uc5c8\uc73c\uba74 \ucee8\ud14c\uc774\ub108\ub85c \ub3cc\ub824\ubd05\ub2c8\ub2e4     <pre><code>docker run -it -p 3000:3000 dotoryeee/simple-app\n</code></pre></p> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \uc11c\ubc84\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\uc2b5\ub2c8\ub2e4     </p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#mapping-volume","title":"Mapping volume","text":"<ol> <li> <p>\uc2e4\ud5d8\uc744 \uc704\ud574 app.js \ub0b4\uc6a9\uc744 \uc0b4\uc9dd \ubcc0\uacbd\ud574\uc90d\ub2c8\ub2e4     </p> </li> <li> <p>\ud638\uc2a4\ud2b8\uc5d0\uc11c node_moules \ud3f4\ub354\ub97c \uc0ad\uc81c\ud588\uae30 \ub54c\ubb38\uc5d0 \uc608\uc678\ucc98\ub9ac \ud574\uc90d\ub2c8\ub2e4     <pre><code>docker run -it -p 3000:3000 -e CHOKIDAR_USEPOLLING=true -v /usr/src/app/node_modules -v $(pwd):/usr/src/app dotoryeee/simple-app\n</code></pre></p> </li> <li> <p>\ud604\uc7ac WSL\uc5d0\uc11c \uc791\uc5c5 \uc2dc \ucee8\ud14c\uc774\ub108 node_module \ud3f4\ub354 \uad8c\ud55c \uc5d0\ub7ec(EACCESS)\ub85c \uc778\ud574 \ub2e4\uc74c\uacfc \uac19\uc774 \uc2e4\ud589\ud588\uc2b5\ub2c8\ub2e4     <pre><code>docker run -it -p 3000:3000 -e CHOKIDAR_USEPOLLING=true -v $(pwd):/usr/src/app dotoryeee/simple-app\n</code></pre></p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#restart","title":"restart","text":"<ol> <li> <p>\ucf54\ub4dc \ubcc0\uacbd\uc774 \uc798 \uc801\uc6a9\ub418\uc5c8\uc2b5\ub2c8\ub2e4     </p> </li> <li> <p>\ucf54\ub4dc \ud3b8\uc9d1 \ud6c4 \uc800\uc7a5\ud558\uba74 \uc0c8\ub85c\uace0\uce68\uc870\ucc28 \ud560 \ud544\uc694 \uc5c6\uc774 \uc2e4\uc2dc\uac04\uc73c\ub85c \ub9ac\uc561\ud2b8\uc5d0 \uc801\uc6a9\ub429\ub2c8\ub2e4     </p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#docker-compose","title":"Docker compose \uc0ac\uc6a9","text":""},{"location":"DevOps/CICD%20on%20Single%20container/#compose","title":"compose \uc124\uc815","text":"<ol> <li>\uc774\ubc88\uc5d0\ub294 \ub3c4\ucee4 \uc2e4\ud589 \uba85\ub839\uc5b4 \ub2e8\ucd95\uc744 \uc704\ud574 compose\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4</li> <li> <p>\ucef4\ud3ec\uc988\ud30c\uc77c \uc791\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>code docker-compose.yml\n</code></pre> <pre><code>version: \"3\" #\ub3c4\ucee4 \ucef4\ud3ec\uc988 \ubc84\uc804\nservices: #\ucef4\ud3ec\uc988\uc5d0\uc11c \uc2e4\ud589\ud560 \ucee8\ud14c\uc774\ub108\ub4e4\uc744 \uc815\uc758\nreact: #\ucee8\ud14c\uc774\ub108 \uc774\ub984\nbuild: #dockerfile \uc815\ubcf4 \u2193\ncontext: . #\ud604\uc7ac \uc704\uce58\uc5d0 \uc788\ub2e4\ndockerfile: dockerfile.dev #\ud30c\uc77c\uc774\ub984\nports: #\ucee8\ud14c\uc774\ub108 \ud3ec\ud2b8 \ub9e4\ud551\n- \"3000:3000\"\nvolumes: #\ud638\uc2a4\ud2b8\uc640 \ubcfc\ub968 \ub9e4\ud551\n- /usr/src/app/node_modules\n- ./:/usr/src/app\nstdin_open: true #\ub9ac\uc561\ud2b8 \uc571\uc744 \uc885\ub8cc\ud560 \ub584 \ud544\uc694\ud55c \uc635\uc158(\uc5c6\uc73c\uba74 \ub9ac\uc561\ud2b8\uc5d0\uc11c \ubc84\uc2a4 \ubc1c\uc0dd)\nenvironment:\n- CHOKIDAR_USEPOLLING=true #\ub9ac\uc561\ud2b8\uc5d0\uc11c \ud56b \ub9ac\ub85c\ub529(\uc2e4\uc2dc\uac04 \uc5c5\ub370\uc774\ud2b8)\ub97c \uc704\ud55c \uc635\uc158\n</code></pre> </li> <li> <p>\ucef4\ud3ec\uc988\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker-compose up\n</code></pre> </li> <li> <p>\ub9ac\uc561\ud2b8\uac00 \uc798 \uc2dc\uc791\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#react-test-container","title":"react test container \uc124\uc815","text":"<ol> <li> <p>\ub3c4\ucee4\uc5d0\uc11c \ub9ac\uc561\ud2b8\ub97c \ud14c\uc2a4\ud2b8 \ud558\ub294 \uae30\ubcf8\uc801\uc778 \uba85\ub839\uc5b4\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>docker run -it {IMAGE} npm run test\n</code></pre> </li> <li> <p>\ud14c\uc2a4\ud2b8\ub3c4 \uc18c\uc2a4\ucf54\ub4dc\ub97c \ud56b \ub9ac\ub85c\ub529 \ud560 \uc218 \uc788\uc73c\uba74 \ub9e4\uc6b0 \ud3b8\ub9ac\ud560 \uac83\uc785\ub2c8\ub2e4</p> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \ucef4\ud3ec\uc988\ud30c\uc77c\uc5d0 \ucee8\ud14c\uc774\ub108\ub97c \ucd94\uac00\ud574\uc8fc\uba74 \ub429\ub2c8\ub2e4</p> <pre><code>tests:\nbuild:\ncontext: .\ndockerfile: Dockerfile.dev\nvolumes:\n- /usr/src/app/node_modules\n- ./:/usr/src/app\ncommand: [\"npm\", \"run\", \"test\"]\n</code></pre> </li> <li> <p>\uc774\ubc88\uc5d0\ub294 \uc7ac\ube4c\ub4dc \ud574\uc57c\ud558\ub2c8 build \uba85\ub839\uc744 \ucd94\uac00\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>docker-compose up --build\n</code></pre> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#dockerfile_1","title":"\uc6b4\uc601\ud658\uacbd\uc744 \uc704\ud55c dockerfile","text":"<ol> <li>\uac1c\ubc1c\ud658\uacbd\uc740 npm run start\ub97c \uc0ac\uc6a9\ud574 \uc11c\ubc84\ub97c \uc2e4\ud589\ud558\uc9c0\ub9cc \uc6b4\uc601\ud658\uacbd\uc740 build\ud6c4 Nginx\ub97c \uc774\uc6a9\ud569\ub2c8\ub2e4</li> <li> <p>\ub3c4\ucee4\ud30c\uc77c \uc791\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>code dockerfile\n</code></pre> </li> <li> <p>\uc6b4\uc601\ud658\uacbd\uc6a9 dockerfile\uc740 \ub450 \ub2e8\uacc4\ub85c \ub098\ub220\uc9d1\ub2c8\ub2e4</p> <ul> <li>Builder stage : \ube4c\ub4dc \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</li> </ul> <pre><code>FROM node:alpine as builder\n#\uc774\uacf3(as)\ubd80\ud130 \ub2e4\uc74c FROM\uc774 \ub098\uc62c \ub584 \uae4c\uc9c0\ub294 builder stage\uc784\uc744 \uba85\uc2dc\nWORKDIR '/usr/src/app'\nCOPY package.json ./\nRUN npm install\nCOPY ./ ./\nRUN npm run build\n#\uc0dd\uc131\ub41c \ube4c\ub4dc \ud30c\uc77c\uc740 /usr/src/app/build\uc5d0 \uc704\uce58\ud558\uac8c \ub429\ub2c8\ub2e4\n</code></pre> <ul> <li>Nginx stage : NginX\ub97c \uac00\ub3d9\ud558\uace0 \uc0dd\uc131\ub41c \ube4c\ub4dc \ud30c\uc77c\uc744 \uc694\uccad\uc5d0 \ub530\ub77c \uc81c\uacf5\ud569\ub2c8\ub2e4(Run stage)</li> </ul> <pre><code>FROM nginx\n#nginx \ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0\nEXPOSE 80\n#AWS\uc5d0 \ubc30\ud3ec\ud558\uae30 \uc704\ud574 80\ud3ec\ud2b8 \uc624\ud508\nCOPY --from=builder /usr/src/app/build /usr/share/nginx/html\n#--from=builder : \ub2e4\ub978 stage\uc5d0 \uc788\ub294 \ud30c\uc77c\uc744 \ubcf5\uc0ac\ud560 \ub54c, \ub2e4\ub978 stage \uc774\ub984\uc744 \uba85\uc2dc\n#/usr/src/app/build , /usr/share/nginx/html : builder stage\uc5d0\uc11c \uc0dd\uc131\ub41c \ud30c\uc77c\uc744 nginx \ud3f4\ub354\uc5d0 \ubcf5\uc0ac\n</code></pre> <ul> <li>\ucc38\uace0 : dockerhub\uc5d0\uc11c \uc81c\uacf5\ud558\ub294 nginx \uacf5\uc2dd \uc124\uba85</li> </ul> <pre><code>FROM nginx\nCOPY static-html-directory /usr/share/nginx/html\n</code></pre> </li> <li> <p>\uc791\uc131\uc774 \uc644\ub8cc\ub418\uba74 \uc774\ubbf8\uc9c0 \ube4c\ub4dc\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>docker build -t dotoryeee/test2 ./\n</code></pre> </li> <li> <p>\uc774\ubbf8\uc9c0 \uc0dd\uc131\uc774 \uc644\ub8cc\ub418\uba74 \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud574\ubd05\ub2c8\ub2e4. nginx\uc758 \uae30\ubcf8 \ud3ec\ud2b8\ub294 80 \uc785\ub2c8\ub2e4</p> <pre><code>docker run -it -p 7070:80 dotoryeee/test2\n</code></pre> </li> <li> <p>nginx\uc5d0\uc11c \ub9ac\uc561\ud2b8\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#travis-ci","title":"Travis CI \uc138\ud305","text":""},{"location":"DevOps/CICD%20on%20Single%20container/#_2","title":"\uc5f0\uacb0","text":"<ol> <li> <p>\ud2b8\ub808\ube44\uc2a4CI\ub97c \uc0ac\uc6a9\ud558\ub824\uba74 github\uacfc \uc5f0\ub3d9\ub418\uc5b4\uc57c \ud569\ub2c8\ub2e4. \uc0ac\uc774\ud2b8\uc5d0 \uc811\uc18d\ud574 \uc5f0\ub3d9\ud574\uc90d\ub2c8\ub2e4</p> <p>Travis CI - Test and Deploy with Confidence</p> </li> <li> <p>\ub85c\uadf8\uc778 \ud6c4 \uae43\ud5d9\uc5d0\uc11c repository \uc811\uadfc \uad8c\ud55c\uc744 \ud5c8\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud2b8\ub808\ube44\uc2a4\uc5d0 repository\uac00 \uc5f0\uacb0\ub41c \uac83\uc744 \ud655\uc778\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#travis-ci-yaml","title":"Travis CI yaml \uc124\uc815","text":"<ol> <li> <p>\ud2b8\ub808\ube44\uc2a4\ub3c4 yaml\ud30c\uc77c\ub85c \uc124\uc815\ud558\uac8c \ub429\ub2c8\ub2e4. \uc791\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p>yaml\ud30c\uc77c\uc740 \ub9e4\uc6b0 \uc9c1\uad00\uc801\uc774\uae30 \ub54c\ubb38\uc5d0 \uc124\uba85\uc774 \ud544\uc694 \uc5c6\uc2b5\ub2c8\ub2e4</p> <ul> <li>\uc5b8\uc5b4\uc124\uc815\uc5d0 generic\uc5d0 \ub300\ud55c \uc124\uba85\uc740 \uc774\uacf3\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</li> <li>\u2014 \u2014coverage \uc635\uc158\uc744 \uc774\uc6a9\ud558\uba74 \ucf58\uc194\uc5d0\uc11c \uc790\uc138\ud55c \ub85c\uadf8\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</li> </ul> <pre><code>code .travis.yml\n</code></pre> <pre><code>sudo: required\nlanguage: generic\nservices:\n- docker\nbefore_install:\n- echo \"building image with dockerfile\"\n- docker build -t dotoryeee/test2 -f dockerfile.dev ./\nscript:\n- docker run -e CI=true dotoryeee/test2 npm run test -- --coverage\nafter_success:\n- echo \"TEST SUCCESS\"\n</code></pre> </li> <li> <p>\uae43\ud5d9\uc5d0 \ud478\uc26c\ud558\uba74 \ud2b8\ub808\ube44\uc2a4\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \uc791\uc5c5\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uccab CI\ub294 \uc5d0\ub7ec\uc785\ub2c8\ub2e4. \ubc14\ub85c \uc774\uba54\uc77c\ub3c4 \ub0a0\ub77c\uc640\uc11c \ud3b8\ub9ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ud6c4 \ucf54\ub4dc\ub97c \uc218\uc815\ud558\uace0 \ub2e4\uc2dc \ucee4\ubc0b \u2192 \ud478\uc2dc \ud574\uc8fc\uba74 travis ci\uac00 \uc790\ub3d9\uc73c\ub85c pull \ud558\uace0 build\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/CICD%20on%20Single%20container/#cd-aws","title":"CD : AWS\uc5d0 \ubc30\ud3ec\ud558\uae30","text":"<ol> <li> <p>AWS Beanstalk \uc5d0\uc11c docker - amazon linux \ud50c\ub7ab\ud3fc\uc73c\ub85c \uc0dd\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Travis \u2192 AWS \uc811\uadfc\uc744 \uc704\ud574 IAM AK, SK\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4. \uc774\ub54c \ud2b8\ub798\ube44\uc2a4yaml\ud30c\uc77c\uc5d0 \uc9c1\uc811 \uae30\uc785\ud558\uba74 \ubcf4\uc548\uc0c1 \uc704\ud5d8\ud558\uae30 \ub584\ubb38\uc5d0 \ud2b8\ub798\ube44\uc2a4 \ud658\uacbd\ubcc0\uc218\uc5d0 AK, SK\ub97c \ub123\uc5b4\uc8fc\uace0 \ubc30\ud3ec\uc2dc\uc5d0 \uac12\uc744 \uac00\uc838\uc624\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4</p> </li> <li> <p>\ud2b8\ub798\ube44\uc2a4\uc5d0\uc11c more option \u2192 setting\uc73c\ub85c \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud2b8\ub798\ube44\uc2a4 \ud658\uacbd\ubcc0\uc218\uc5d0 AWS_ACCESS_KEY / AWS_SECRET_ACCESS_KEY\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS\uc5d0 \ubc30\ud3ec\ub97c \uc704\ud574 travis\ub97c \uc124\uc815\ud569\ub2c8\ub2e4. \ub2f9\uc5f0\ud788 yaml \ud30c\uc77c\ub85c.</p> <pre><code>code .travis.yml\n</code></pre> </li> <li> <p>\ub2e4\uc74c \ub0b4\uc6a9\uc744 \ucd94\uac00\ud558\uace0 \ud478\uc2dc\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>deploy:\nprovider: elasticbeanstalk\nregion: \"ap-northeast-2\"\napp: \"simple-app\"\nenv: \"Simpleapp-env\" #\ube48\uc2a4\ud1a1 \uc0dd\uc131\uc2dc env \uc9c0\uc815 \uac00\ub2a5\nbucket_name: \"elasticbeanstalk-ap-northeast-2-737382971423\" #\ube48\uc2a4\ud1a1 \uc0dd\uc131\uc2dc \uc790\ub3d9\uc73c\ub85c \uc0dd\uc131\ub41c s3 \uc774\ub984\nbucket_path: \"simple-app\" #app \uc774\ub984\uacfc \ub3d9\uc77c\ud558\uac8c \uc791\uc131\non:\nbranch: master #\uc5b4\ub5a4 \ube0c\ub79c\uce58\ub97c \ubc30\ud3ec\ud560 \uac83 \uc778\uac00\naccess_key_id: $AWS_ACCESS_KEY #\ud2b8\ub798\ube44\uc2a4\uc5d0 \ub4f1\ub85d\ub41c \ud658\uacbd\ubcc0\uc218\nsecret_access_key: $AWS_SECRET_ACCESS_KEY\n</code></pre> </li> <li> <p>\ube4c\ub4dc\uac00 \uc131\uacf5\uc801\uc73c\ub85c \uc774\ub904\uc9c0\uba74</p> <p></p> <p></p> </li> <li> <p>\uc790\ub3d9\uc73c\ub85c AWS Beanstalk\uc5d0 \ubc30\ud3ec\ub429\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Circle-CI%20basic/","title":"Circle-CI Basics","text":""},{"location":"DevOps/Circle-CI%20basic/#aws-s3","title":"AWS S3","text":"<ol> <li> <p>IAM\uc5d0\uc11c \uc0ac\uc6a9\uc790 \uc0dd\uc131</p> <p></p> </li> <li> <p>\ucf58\uc194 \uc811\uadfc \uad8c\ud55c\uc740 \ud544\uc694\uc5c6\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>S3\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uae30 \uc704\ud574 S3 FA \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc0ac\uc6a9\uc790\ub294 \uc774\ub984\uc774 \uc790\ub3d9\uc73c\ub85c \uc801\uc6a9\ub418\uae30 \ub54c\ubb38\uc5d0 \ud0dc\uadf8\ub294 \ub530\ub85c \ucd94\uac00\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ud6c4 \uc0dd\uc131\ub418\ub294 AccessKey\uc640 SecretKey\ub97c \ubcf5\uc0ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CircleCI Projects\uc5d0\uc11c Project Settings\uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Environment Variables\uc5d0\uc11c \ud658\uacbd\ubcc0\uc218\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uadf8\ub9bc\uacfc \uac19\uc774 \uc124\uc815\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>yml\ud30c\uc77c \uc704\uce58\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>.circleci/config.yml\n</code></pre> </li> <li> <p>config.yml\ub0b4\uc6a9\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4     <pre><code>version: 2.1\norbs:\naws-cli: circleci/aws-cli@1.3.1\naws-s3: circleci/aws-s3@2.0\njobs:\ndeploy-s3:\nexecutor: aws-cli/default\nsteps:\n- attach_workspace:\nat: .\n- persist_to_workspace:\nroot: .\npaths:\n- .\n- run: ls /home/circleci/project\n- aws-s3/sync:\narguments: --acl public-read\naws-region: AWS_REGION\naws-access-key-id: AWS_ACCESS_KEY_ID\naws-secret-access-key: AWS_SECRET_ACCESS_KEY\nfrom: .\nto: \"s3://nuspam-static/frontend\"\n- aws-s3/copy:\narguments: \"--dryrun\"\nfrom: .\nto: \"s3://nuspam-static/frontend\"\nworkflows:\ndeploy-frontend:\njobs:\n- deploy-s3:\nfilters:\nbranches:\nonly: main\n</code></pre></p> </li> </ol>"},{"location":"DevOps/Circle-CI%20basic/#aws-codedeploy-for-ec2","title":"AWS CodeDeploy for EC2","text":"<ol> <li> <p>AWS CLI\uc811\uc18d\uc6a9 User\uc5d0 CodeDeploy FA \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>IAM\uc5d0\uc11c CodeDeploy\uc6a9 \uc5ed\ud560\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS CodeDeploy\uc5d0\uc11c \uc5b4\ud50c\ub9ac\ucf00\uc774\uc158\uc744 \uc0dd\uc131\ud558\uace0 \ubc30\ud3ec\uadf8\ub8f9\uc744 \ub9cc\ub4dc\ub294\ub370, \uc55e\uc11c \uc0dd\uc131\ud55c \uc5ed\ud560\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc30\ud3ec \ud0c0\uac9f\uc5d0 \uc778\uc2a4\ud134\uc2a4 \uc774\ub984\uc744 \uc0ac\uc6a9\ud558\uba74 \ud3b8\ub9ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0\uc11c CodeDeploy \uc811\uadfc\uc744 \uc704\ud55c \uc5ed\ud560\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2RoleforAWSCodeDeploy\uad8c\ud55c\uc744 \ubd80\uc5ec\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 \ud574\ub2f9 \uc5ed\ud560\uc744 \uc5f0\uacb0\ud558\uace0</p> <p></p> </li> <li> <p>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 CodeDeploy \uc5d0\uc774\uc804\ud2b8\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>aws s3 cp s3://aws-codedeploy-ap-northeast-2/latest/install . --region ap-northeast-2\nsudo yum install -y ruby wget\nchmod +x ./install\nsudo ./install auto\nsudo service codedeploy-agent start\nsudo service codedeploy-agent status\n</code></pre> </li> <li> <p>CircleCI config.yml\uc744 \ub2e4\uc74c\uacfc \uac19\uc774 \uc801\ub2f9\ud558\uac8c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>version: \"2.1\"\norbs:\naws-code-deploy: circleci/aws-code-deploy@2.0.0\naws-s3: circleci/aws-s3@2.0\naws-cli: circleci/aws-cli@1.3.1\njobs:\ndeploy-step1:\nexecutor: aws-cli/default\nsteps:\n- checkout\n- attach_workspace:\nat: .\n- persist_to_workspace:\nroot: .\npaths:\n- .\n- aws-s3/sync:\naws-region: AWS_REGION\naws-access-key-id: AWS_ACCESS_KEY_ID\naws-secret-access-key: AWS_SECRET_ACCESS_KEY\nfrom: .\nto: \"s3://nuspam-static/backend/\"\nworkflows:\ndeploy_application:\njobs:\n- deploy-step1\n- aws-code-deploy/deploy:\nrequires:\n- deploy-step1\napplication-name: nuspam-api\nbundle-bucket: nuspam-static\nbundle-key: app\ndeployment-group: api-server\nservice-role-arn: arn:aws:iam::737382971423:role/Role_for_codedeploy\nfilters:\nbranches:\nonly: main\n</code></pre> </li> <li> <p>CircleCI\uc5d0\uc11c \uc791\uc5c5\uc774 \uc644\ub8cc\ub418\uba74</p> <p></p> </li> <li> <p>AWS CodeDeploy\uc5d0\uc11c \ubc30\ud3ec\ud604\ud669\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc778\uc2a4\ud134\uc2a4 \ucd08\uae30\uc5d0 python3 \uc815\uc9c0\ud558\ub294 \uc2a4\ud06c\ub9bd\ud2b8 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud560 \uacbd\uc6b0 \ub2e4\uc74c\uacfc \uac19\uc774 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc791\uc131\ud558\uba74 \ub429\ub2c8\ub2e4.</p> <pre><code>#!/bin/bash\nif pgrep -x python3 &gt;/dev/null\nthen\nsudo kill $(pgrep -f python3)\nelse\nexit 0\nfi\n</code></pre> </li> <li> <p>\ubc30\ud3ec \ud6c4 flask\uac00 \uc885\ub8cc\ub418\ubc84\ub9ac\ub294 \uacbd\uc6b0 \ub2e4\uc74c\uacfc \uac19\uc774 \uba85\ub839 \ub9c8\uc9c0\ub9c9\uc5d0 &amp; \uc744 \uc0bd\uc785\ud574 \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0 \ub3d9\uc791\uc744 \uc720\ub3c4\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/","title":"Multi container CICD","text":""},{"location":"DevOps/Multi%20container%20CICD/#_1","title":"\uad6c\uc131\ub3c4","text":"<ul> <li> <p>DEV Flow chart</p> <p></p> </li> <li> <p>Service ENV</p> <p>Docker-compose\ub97c \uc0ac\uc6a9\ud574 \ubaa8\ub4e0 \ucee8\ud14c\uc774\ub108 \ud658\uacbd\uc744 \uc81c\uc5b4\ud569\ub2c8\ub2e4</p> <p></p> </li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#_2","title":"\uc694\uc57d","text":"<ol> <li>\uba40\ud2f0\ucee8\ud14c\uc774\ub108\ub97c \uc774\uc6a9\ud574 \uac1c\ubc1c\ud658\uacbd\uacfc \uc6b4\uc601\ud658\uacbd\uc744 \uad6c\ucd95\ud569\ub2c8\ub2e4</li> <li>nodeJS\ubc31\uc5d4\ub4dc \u2194 reactJS\ud504\ub860\ud2b8\uc5d4\ub4dc \uac04\uc5d0 REST API \uad6c\uc870\ub85c \ub370\uc774\ud130\ub97c \uc804\ub2ec\ud569\ub2c8\ub2e4(axios)</li> <li>Nginx\uc758 \ub77c\uc6b0\ud305\uc744 \ud65c\uc6a9\ud558\uc5ec  URI\uac00 /api \ub85c \uc2dc\uc791\ud558\uba74 \ubc31\uc5d4\ub4dc(NodeJS)\ub85c, \ub098\uba38\uc9c0( / )\ub294 \ud504\ub860\ud2b8(ReactJS)\ub85c \ubcf4\ub0b4\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4</li> <li>Docker Compose\ub97c \uc0ac\uc6a9\ud574 \ucee8\ud14c\uc774\ub108\uac04\uc758 \ud1b5\uc2e0 \ub4f1 \uac1c\ubc1c\ud658\uacbd\uc744 \uad6c\ucd95\ud569\ub2c8\ub2e4</li> <li>\uae43\ud5d9\uc5d0 \ud478\uc2dc\ud558\uba74 \u2192 Travis CI \ud14c\uc2a4\ud2b8\u2192 Docker Hub\ub85c \uc774\ubbf8\uc9c0\ub97c \uc804\ub2ec\ud558\uace0 Beanstalk\uc774 ECS\ub97c \uc774\uc6a9\ud574 \uc774\ubbf8\uc9c0\ub97c pull\ud558\uace0 ECS\ub97c \uc774\uc6a9\ud574 \ucee8\ud14c\uc774\ub108\ub97c Deploy\ud558\ub3c4\ub85d \ud569\ub2c8\ub2e4</li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#backendnodejs","title":"Backend(nodeJS)","text":"<ol> <li> <p>\uba54\uc778 \uc791\uc5c5 \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir docker_multicon_app\ncd docker_multicon_app\n</code></pre> </li> <li> <p>nodeJS\ub85c \ubc31\uc564\ub4dc\ub97c \uad6c\uc131\ud569\ub2c8\ub2e4. \ubc31\uc564\ub4dc \uc791\uc5c5\uc6a9 \ud3f4\ub354\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir backend\ncd backend\n</code></pre> </li> <li> <p>\ub178\ub4dc \uc138\ud305\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4. \ubaa8\ub450 \uae30\ubcf8\uac12\uc73c\ub85c \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>npm init\n</code></pre> </li> <li> <p>\uc885\uc18d\uc131\uc744 \uc218\uc815\ud569\ub2c8\ub2e4</p> <p>body-parser\ub294 \ud074\ub77c\uc774\uc5b8\ud2b8\uc5d0\uc11c \uc624\ub294 \uc694\uccad\uc758 \ubcf8\ubb38\uc744 \ud574\uc11d\ud574\uc8fc\ub294 \ubbf8\ub4e4\uc6e8\uc5b4\uc785\ub2c8\ub2e4</p> <pre><code>code package.json\n</code></pre> <pre><code>\"scripts\": {\n\"test\": \"echo \\\"Error: no test specified\\\" &amp;&amp; exit 1\",\n\"start\": \"node server.js\",\n\"dev\": \"nodemon server.js\"\n},\n\"dependencies\": {\n\"express\":\"^4.17.1\",\n\"mysql\":\"^2.18.1\",\n\"nodemon\": \"^2.0.7\",\n\"body-parser\":\"^1.19.0\"\n}\n</code></pre> </li> <li> <p>mysql\uc5f0\uacb0\uc744 \uc704\ud55c db.js\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <p>\ub370\uc774\ud130\ubca0\uc774\uc2a4\ub97c \uc774\uc6a9\ud558\ub824\uba74\u00a0 connection\uc744 \uc5f0\uacb0\ud55c \ud6c4 \ub2e4 \uc0ac\uc6a9\ud558\uace0 \ub098\uba74 \uadf8 connection\uc744 \ubc18\ub0a9\ud574\uc57c\ud569\ub2c8\ub2e4. \ud558\uc9c0\ub9cc \ub108\ubb34 \ub9ce\uc740 \uc694\uccad\uc774 \uc624\uba74 \uc774 \uacfc\uc815\uc5d0\uc11c \ubd80\ud558\uac00 \uc0dd\uae38 \uc218 \uc788\uae30 \ub54c\ubb38\uc5d0 \uc5f0\uacb0\ub41c Connection\uc744 Pool\uc5d0 \ubcf4\uad00\ud55c \ud6c4 \ud544\uc694\ud560 \ub54c Pool\uc5d0 \uc788\ub294 Connection\uc744 \uac00\uc838\ub2e4\uac00 \uc4f8 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <pre><code>code db.js\n</code></pre> <pre><code>const mysql = require(\"mysql\");\nconst pool = mysql.createPool({\nconnectionLimit: 10,\nhost: \"mysql\",\nuser: \"root\",\npassword: \"password\",\ndatabase: \"myapp\"\n});\nexports.pool = pool; //\ub2e4\ub978 \uc571\uc5d0\uc11c \uc4f8 \uc218 \uc788\ub3c4\ub85d export\n</code></pre> </li> <li> <p>app\uc758 \uc2dc\uc791\uc810\uc778 server.js\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>code server.js\n</code></pre> <pre><code>const express = require(\"express\");\nconst bodyParser = require(\"body-parser\");\n//\uc55e\uc5d0\uc11c export\ub41c pool\uc758 \uc2dc\uc791\uc810\uc778 db.js\ub97c \ubd88\ub7ec\uc624\uae30\nconst db = require(\"./db\");\nconst EXPRESS_PORT = 5000;\nconst app = express();\n//JSON\ud615\ud0dc\ub85c \uc624\ub294 \uc694\uccad\uc744 \ud574\uc11d\ud560 \uc218 \uc788\ub3c4\ub85d parser \uc0ac\uc6a9\napp.use(bodyParser.json());\n//------------! \ud14c\uc774\ube14 \uc0dd\uc131 !---------------/\n//\ucc38\uace0\uc6a9\uc73c\ub85c \uae30\ub85d\ud574\ub450\uc5c8\uc73c\uba70, \uc2e4\uc81c \ud658\uacbd\uc5d0\uc11c\ub294 \ucee8\ud14c\uc774\ub108 \ub85c\ub4dc\uc2dc \ubcc4\ub3c4\ub85c \ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4\n/*\ndb.pool.query(`CREATE TABLE lists(\n    id INT AUTO_INCREMENT,\n    value TEXT,\n    PRIMARY KEY (id)\n)`, (err, results, fields) =&gt; {\n    console.log(`results : ${results}`)\n})\n*/   //--------------! API !--------------------/\n//DB \ud14c\uc774\ube14\uc5d0 \uc788\ub294 \ubaa8\ub4e0 \ub370\uc774\ud130\ub97c \ud504\ub860\ud2b8\ub85c \ubcf4\ub0b4\uae30\napp.get('/api/values'), function (req, res, next) { //\ud578\ub4e4\ub7ec \uc0dd\uc131\ndb.pool.query(\"SELECT * FROM lists;\", //DB\uc5d0\uc11c \ubaa8\ub4e0 \ub370\uc774\ud130 \uac00\uc838\uc624\uae30\n(err, results, fields) =&gt; {\nif (err)\nreturn res.status(500).send(err)\nelse\nreturn res.json(results)\n})\n})\n//\ud504\ub860\ud2b8\uc5d0\uc11c \uc785\ub825\ud55c \uac12\uc744 DB \ud14c\uc774\ube14\uc5d0 \uc785\ub825\napp.post('/api/values', function (res, req, next) {\ndb.pool.query(`INSERT INTO lists (values) VALUES(\"${req.body.value}\");`, //bodyParser \uc0ac\uc6a9\n(err, results, fields) =&gt; {\nif (err)\nreturn res.status(500).send(err)\nelse\nreturn res.json({success: true, value: req.body.value})\n})\n})\n//------------! START EXPRESS !-----------------/\napp.listen(EXPRESS_PORT, ()) =&gt; {\nconsole.log(\"app running on PORT 5000\")\n}\n</code></pre> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#frontendreactjs","title":"Frontend(reactJS)","text":"<ol> <li> <p>\uba54\uc778 \uc791\uc5c5 \ub514\ub809\ud130\ub9ac\uc5d0 \ub9ac\uc561\ud2b8\ub97c \uc124\uce58\ud569\ub2c8\ub2e4. </p> <pre><code>npx create-react-app frontend\n</code></pre> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc740 \uad6c\uc870\uac00 \ub418\uaca0\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub370\uc774\ud130 \uc785\ub825\uc744 \uc704\ud574 \ub9ac\uc561\ud2b8 /src/app.js\uc5d0 \uc778\ud48b\uacfc \ubc84\ud2bc\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>&lt;div className=\"container\"&gt;\n&lt;form className=\"example\"&gt;\n&lt;input\ntype=\"text\"\nplaceholder=\"type something here\"\n/&gt;\n&lt;button type=\"submit\"&gt;GO&lt;/button&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>\ub370\uc774\ud130 \uc804\ub2ec\uc5d0 useState, useEffect, axios\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4</p> <ul> <li>package.json - depencencise</li> </ul> <pre><code>\"axios\" : \"^0.21.1\" -&gt; \uc885\uc18d\uc131 \uc5c5\ub370\uc774\ud2b8 \ud6c4 npm install\n</code></pre> <ul> <li>import</li> </ul> <pre><code>import React, { useState, useEffect } from 'react';\n//useState, useEffect\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 react\ub77c\uc774\ube0c\ub7ec\ub9ac\uc5d0\uc11c \uac00\uc838\uc635\ub2c8\ub2e4\nimport axios from 'axios';\n</code></pre> </li> <li> <p>useState</p> <pre><code>const [lists, setLists] = useState([]) //\uae30\ubcf8state\ub294 \ube48 \ubc30\uc5f4\n// \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub41c \uac12\uc744 \uac00\uc838\uc640\uc11c \ud654\uba74\uc5d0 \ubcf4\uc5ec\uc8fc\uae30\uc804 \uc774 State\uc5d0 \ub123\uc5b4\ub461\ub2c8\ub2e4\nconst [value, setValue] = useState(\"\") //\uae30\ubcf8state\uc5d0 \ube48 \uc2a4\ud2b8\ub9c1\n//Input\ubc15\uc2a4\uc5d0 \uc785\ub825\ud55c \uac12\uc774 \uc774 state\uc5d0 \ub4e4\uc5b4\uac11\ub2c8\ub2e4\n</code></pre> </li> <li> <p>axios, useEffect</p> <pre><code>useEffect(() =&gt; { //\uc774\uacf3\uc5d0\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc788\ub294 \uac12\uc744 \uc694\uccad\naxios.get('/api/values') //\ub370\uc774\ud130\ub97c \uc694\uccad\ud558\uae30 \uc704\ud574 get Request \ubcf4\ub0b4\ub294 \uacf3, Node\uc11c\ubc84\uc5d0\uc11c \uc9c0\uc815\ud574\uc900 \uacbd\ub85c\ub300\ub85c\n.then(response =&gt; { //\ubc31\uc5d4\ub4dc(Node)\uac00 \ucc98\ub9ac \ud6c4 \uc1a1\uc2e0\ud55c \ub370\uc774\ud130\uac00 \uc774\uacf3(respose \ud30c\ub77c\ubbf8\ud130)\ub85c \uc218\uc2e0\nconsole.log(`response ${response.data}`) //\uc5b4\ub5a4 \uac12\uc774 \uc654\ub294\uc9c0 \ucf58\uc194\ub85c \ud655\uc778\nsetLists(response.data) //\uc218\uc2e0\ud55c \ub370\uc774\ud130\ub97c \uc774\uacf3(setLists(38\ud589))\uc5d0 \ub123\uc5b4\uc90c\n})\n}, [])\n//changeHandler\uc5ed\ud560 : 56\ud589 onChange\ucee8\ud2b8\ub864 = input\ubc15\uc2a4\uc5d0 \uc785\ub825\uc744 \ud560 \ub54c onChangeEvent\uac00 \ubc1c\uc0dd\ud560 \ub54c \ub9c8\ub2e4 value state\ub97c \ubcc0\ud654\uc2dc\ucf1c\uc90c\nconst changeHandler = (event) =&gt; {  //onChange\ud578\ub4e4\ub7ec \uc774\ubca4\ud2b8 \ubc1c\uc0dd\uc2dc \ub2e4\uc74c \ub2e8\uacc4 \uc218\ud589\nsetValue(event.currentTarget.value)\n}\n//submitHandler\uc5ed\ud560 : \uac12\uc744 input \ubc15\uc2a4\uc5d0 \uc785\ub825\ud558\uace0 \ud655\uc778 \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ub370\uc774\ud130\uac12\uc774 DB\uc5d0 \uc800\uc7a5\nconst submitHandler = (event) =&gt; { //\uc774\ubca4\ud2b8\ub97c \ubc1b\uc544\uc635\ub2c8\ub2e4\nevent.preventDefault(); //\uc624\ub3d9\uc791 \ubc29\uc9c0\ub97c \uc704\ud574 \uae30\ubcf8 \ub3d9\uc791\uc744 \uc81c\uac70\ud569\ub2c8\ub2e4\naxios.post('/api/value', //\ub370\uc774\ud130 \uc804\ub2ec\uc744 \uc704\ud574 \ubc31\uc5d4\ub4dc\uc5d0 POST request\ub97c \ubcf4\ub0c5\ub2c8\ub2e4\n{ value: value }) //\ud0a4\uac12 : value / \ub370\uc774\ud130\uac12 : value / \ucc38\uc870 : 40\ud589 \ub9ac\uc2a4\ud2b8\uc758 0\ubc88 = value\n.then(response =&gt; { //\ubc31\uc5d4\ub4dc\uc5d0\uc11c \ucc98\ub9ac \ud6c4 \ud68c\uc2e0\ubc1b\uc740 \ub370\uc774\ud130\ub97c response\uc5d0 \ubc1b\uc544\uc634\nif (response.data.success) { //response\uac00 \uc131\uacf5\ud588\ub2e4\uba74 &lt;- server.js 42\ud589 \ucc38\uace0\nconsole.log(`response.data : ${response.data}`) //\uc131\uacf5\ud588\uc744\uacbd\uc6b0 \uacb0\uacfc\uac12\uc744 \ud55c \ubc88 \uc0b4\ud3b4\ubd05\ub2c8\ub2e4\nsetLists([...lists, response.data]) //38\ud589 \ub9ac\uc2a4\ud2b8[0] (lists)\uc5d0 \uac12\uc744 \ub123\uc5b4\uc8fc\uae30. \uc6d0\ub798 \ub9ac\uc2a4\ud2b8\uc5d0 \uc788\ub358 \ub370\uc774\ud130\uc5d0 \uc774\uc5b4\uc11c \ub123\uc5b4\uc8fc\uae30 \uc704\ud574 ...lists(3\ubc88\uc9f8)\ub85c \uc791\uc131\nsetValue(\"\"); //\ub370\uc774\ud130 \uc785\ub825 \ud6c4 input \ubc15\uc2a4 \ub0b4\uc6a9\uc740 \uc0ad\uc81c\n} else { //response\uac00 \uc2e4\ud328\ud588\ub2e4\uba74\nalert(\"DB\uc5d0 \ub370\uc774\ud130 \ub123\uae30 \uc2e4\ud328\")\n}\n})\n}\n</code></pre> </li> <li> <p>\uc774\ubca4\ud2b8\ud578\ub4e4\ub7ec \ud638\ucd9c\uc744 \uc704\ud55c \ubd80\ubd84(onSubmit, onChange)\uacfc \ub80c\ub354\ub9c1 \ubcf4\uac15(\uc544\ub798 \ucf54\ub4dc\uc870\uac01\uc758 3~5\ud589)\uc744 \uc704\ud574 html \ucf54\ub4dc\ub97c \uc218\uc815\ud569\ub2c8\ub2e4. \uc774\ub294 \ud654\uba74\uc5d0 \ud45c\uc2dc\ub418\ub294 \ub9ac\uc2a4\ud2b8\uc758 \uac1c\uc218\uac00 \ub2e4\ub97c \ub584 \ub80c\ub354\ub9c1 \uc624\ub958\uac00 \ubc1c\uc0dd\ud558\ub294 \uac83\uc744 \uc218\uc815\ud569\ub2c8\ub2e4</p> <pre><code>&lt;div className=\"container\"&gt;\n{lists &amp;&amp; lists.map((list, index) =&gt; ( &lt;li key={index}&gt;{list.value}&lt;/li&gt;\n))}\n&lt;form className=\"example\" onSubmit={submitHandler}&gt;\n&lt;input\ntype=\"text\"\nplaceholder=\"type something here\"\nonChange={changeHandler}\nvalue={value}\n/&gt;\n&lt;button type=\"submit\"&gt;GO&lt;/button&gt;\n&lt;/form&gt;\n&lt;/div&gt;\n</code></pre> </li> <li> <p>\uace0\ub85c \ucd5c\uc885\uc801\uc778 \ucf54\ub4dc\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <ul> <li>App.js</li> </ul> <pre><code>import logo from './logo.svg';\nimport './App.css';\nimport React, { useState, useEffect } from 'react';\n//useState, useEffect\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 react\ub77c\uc774\ube0c\ub7ec\ub9ac\uc5d0\uc11c \uac00\uc838\uc635\ub2c8\ub2e4\nimport axios from 'axios'; function App() {\nuseEffect(() =&gt; { //\uc774\uacf3\uc5d0\uc11c \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc788\ub294 \uac12\uc744 \uc694\uccad\naxios.get('/api/values') //\ub370\uc774\ud130\ub97c \uc694\uccad\ud558\uae30 \uc704\ud574 get Request \ubcf4\ub0b4\ub294 \uacf3, Node\uc11c\ubc84\uc5d0\uc11c \uc9c0\uc815\ud574\uc900 \uacbd\ub85c\ub300\ub85c\n.then(response =&gt; { //\ubc31\uc5d4\ub4dc(Node)\uac00 \ucc98\ub9ac \ud6c4 \uc1a1\uc2e0\ud55c \ub370\uc774\ud130\uac00 \uc774\uacf3(respose \ud30c\ub77c\ubbf8\ud130)\ub85c \uc218\uc2e0\nconsole.log(`response ${response.data}`) //\uc5b4\ub5a4 \uac12\uc774 \uc654\ub294\uc9c0 \ucf58\uc194\ub85c \ud655\uc778\nsetLists(response.data) //\uc218\uc2e0\ud55c \ub370\uc774\ud130\ub97c \uc774\uacf3(setLists(38\ud589))\uc5d0 \ub123\uc5b4\uc90c\n})\n}, [])\n//changeHandler\uc5ed\ud560 : 56\ud589 onChange\ucee8\ud2b8\ub864 = input\ubc15\uc2a4\uc5d0 \uc785\ub825\uc744 \ud560 \ub54c onChangeEvent\uac00 \ubc1c\uc0dd\ud560 \ub54c \ub9c8\ub2e4 value state\ub97c \ubcc0\ud654\uc2dc\ucf1c\uc90c\nconst changeHandler = (event) =&gt; {  //onChange\ud578\ub4e4\ub7ec \uc774\ubca4\ud2b8 \ubc1c\uc0dd\uc2dc \ub2e4\uc74c \ub2e8\uacc4 \uc218\ud589\nsetValue(event.currentTarget.value)\n}\n//submitHandler\uc5ed\ud560 : \uac12\uc744 input \ubc15\uc2a4\uc5d0 \uc785\ub825\ud558\uace0 \ud655\uc778 \ubc84\ud2bc\uc744 \ub204\ub974\uba74 \ub370\uc774\ud130\uac12\uc774 DB\uc5d0 \uc800\uc7a5\nconst submitHandler = (event) =&gt; { //\uc774\ubca4\ud2b8\ub97c \ubc1b\uc544\uc635\ub2c8\ub2e4\nevent.preventDefault(); //\uc624\ub3d9\uc791 \ubc29\uc9c0\ub97c \uc704\ud574 \uae30\ubcf8 \ub3d9\uc791\uc744 \uc81c\uac70\ud569\ub2c8\ub2e4\naxios.post('/api/value', //\ub370\uc774\ud130 \uc804\ub2ec\uc744 \uc704\ud574 \ubc31\uc5d4\ub4dc\uc5d0 POST request\ub97c \ubcf4\ub0c5\ub2c8\ub2e4\n{ value: value }) //\ud0a4\uac12 : value / \ub370\uc774\ud130\uac12 : value / \ucc38\uc870 : 40\ud589 \ub9ac\uc2a4\ud2b8\uc758 0\ubc88 = value\n.then(response =&gt; { //\ubc31\uc5d4\ub4dc\uc5d0\uc11c \ucc98\ub9ac \ud6c4 \ud68c\uc2e0\ubc1b\uc740 \ub370\uc774\ud130\ub97c response\uc5d0 \ubc1b\uc544\uc634\nif (response.data.success) { //response\uac00 \uc131\uacf5\ud588\ub2e4\uba74 &lt;- server.js 42\ud589 \ucc38\uace0\nconsole.log(`response.data : ${response.data}`) //\uc131\uacf5\ud588\uc744\uacbd\uc6b0 \uacb0\uacfc\uac12\uc744 \ud55c \ubc88 \uc0b4\ud3b4\ubd05\ub2c8\ub2e4\nsetLists([...lists, response.data]) //38\ud589 \ub9ac\uc2a4\ud2b8[0] (lists)\uc5d0 \uac12\uc744 \ub123\uc5b4\uc8fc\uae30. \uc6d0\ub798 \ub9ac\uc2a4\ud2b8\uc5d0 \uc788\ub358 \ub370\uc774\ud130\uc5d0 \uc774\uc5b4\uc11c \ub123\uc5b4\uc8fc\uae30 \uc704\ud574 ...lists(3\ubc88\uc9f8)\ub85c \uc791\uc131\nsetValue(\"\"); //\ub370\uc774\ud130 \uc785\ub825 \ud6c4 input \ubc15\uc2a4 \ub0b4\uc6a9\uc740 \uc0ad\uc81c\n} else { //response\uac00 \uc2e4\ud328\ud588\ub2e4\uba74\nalert(\"DB\uc5d0 \ub370\uc774\ud130 \ub123\uae30 \uc2e4\ud328\")\n}\n})\n}\nconst [lists, setLists] = useState([]) //\uae30\ubcf8state\ub294 \ube48 \ubc30\uc5f4\n// \ub370\uc774\ud130\ubca0\uc774\uc2a4\uc5d0 \uc800\uc7a5\ub41c \uac12\uc744 \uac00\uc838\uc640\uc11c \ud654\uba74\uc5d0 \ubcf4\uc5ec\uc8fc\uae30\uc804 \uc774 State\uc5d0 \ub123\uc5b4\ub461\ub2c8\ub2e4\nconst [value, setValue] = useState(\"\") //\uae30\ubcf8state\uc5d0 \ube48 \uc2a4\ud2b8\ub9c1\n//Input\ubc15\uc2a4\uc5d0 \uc785\ub825\ud55c \uac12\uc774 \uc774 state\uc5d0 \ub4e4\uc5b4\uac11\ub2c8\ub2e4\nreturn (\n&lt;div className=\"App\"&gt;\n&lt;header className=\"App-header\"&gt;\n&lt;img src={logo} className=\"App-logo\" alt=\"logo\" /&gt;\n&lt;div className=\"container\"&gt;\n{lists &amp;&amp; lists.map((list, index) =&gt; ( //38\ud589\uc758 lists\n&lt;li key={index}&gt;{list.value}&lt;/li&gt; //map\uba54\uc18c\ub4dc \uc0ac\uc6a9\uc2dc key\uac12 \uba85\uc2dc \ud544\uc218\n))}\n&lt;form className=\"example\" onSubmit={submitHandler}&gt;\n&lt;input\ntype=\"text\"\nplaceholder=\"type something here\"\nonChange={changeHandler}\nvalue={value} //40\ud589\uacfc \ub9e4\ud551\n/&gt;\n&lt;button type=\"submit\"&gt;GO&lt;/button&gt;\n&lt;/form&gt;\n&lt;/div&gt;        \n&lt;/header&gt;\n&lt;/div&gt;\n);\n}\nexport default App;\n</code></pre> </li> <li> <p>\ub514\uc790\uc778\uc744 \uc704\ud574 app.css\ub3c4 \ucd94\uac00\ud569\ub2c8\ub2e4</p> <pre><code>code App.css\n</code></pre> <pre><code>.container {\nwidth: 375px;\n}\nform.example input {\npadding: 10px;\nfont-size: 17px;\nborder: 1px solid grey;\nfloat: left;\nwidth: 74%;\nbackground: #f1f1f1;\n}\nform.example button {\nfloat: left;\nwidth: 20%;\npadding: 10px;\nbackground: #2196F3;\ncolor: white;\nfont-size: 17px;\nborder: 1px solid grey;\nborder-left: none;\ncursor: pointer;\n}\nform.example button:hover {\nbackground: #0b7dda;\n}\nform.example::after {\ncontent: \"\";\nclear: both;\ndisplay: table;\n}\n</code></pre> </li> <li> <p>\ud504\ub860\ud2b8\uc5d0\uc11c \ubc31\uc5d4\ub4dc\ub85c \ub370\uc774\ud130\ub97c \ubc00\uc5b4\ub123\uc744 \uc900\ube44\uac00 \ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#dockerfile-for-react","title":"Dockerfile \uc791\uc131 - for React","text":"<ul> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 frontend \ub514\ub809\ud130\ub9ac\uc5d0 \uc791\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#dockerfiledev","title":"\uac1c\ubc1c \ud658\uacbd\uc6a9 Dockerfile.dev","text":"<pre><code>```s\ncode Dockerfile.dev\n```\n\n```dockerfile\nFROM node:alpine \n#\ub3c4\ucee4\ud5c8\ube0c\uc5d0\uc11c \ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0\ub97c \uac00\uc838\uc635\ub2c8\ub2e4\nWORKDIR /app\n#\ud574\ub2f9 \uc5b4\ud50c\uc758 \uc18c\uc2a4\ucf54\ub4dc\ub4e4\uc774 /app\uc5d0 \ub4e4\uc5b4\uac00\uac8c \ub429\ub2c8\ub2e4\nCOPY package.json ./\n#\uc18c\uc2a4\ucf54\ub4dc\uac00 \ubc14\ub014 \ub54c \ub9c8\ub2e4 \uc885\uc18d\uc131\uc744 \ub2e4\uc2dc \ubcf5\uc0ac\ud558\uc9c0 \uc54a\ub3c4\ub85d \uba3c\uc800 \uc791\uc5c5\ud569\ub2c8\ub2e4\nRUN npm install\n#\uc885\uc18d\uc131\uc5d0 \uba85\uc2dc\ub41c \ub77c\uc774\ube0c\ub7ec\ub9ac, \ud504\ub808\uc784\uc6cc\ud06c\ub97c \uc124\uce58\ud569\ub2c8\ub2e4\nCOPY ./ ./\n#\ubaa8\ub4e0 \uc18c\uc2a4\ucf54\ub4dc\ub97c WORKDIR\ub85c \ubcf5\uc0ac\ud569\ub2c8\ub2e4\nCMD [\"npm\", \"run\", \"start\"]\n#\ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud560 \ub54c \uc2e4\ud589\ud560 \uba85\ub839\uc5b4\ub97c \uc9c0\uc815\ud569\ub2c8\ub2e4\n```\n</code></pre>"},{"location":"DevOps/Multi%20container%20CICD/#dockerfile","title":"\uc6b4\uc601 \ud658\uacbd\uc6a9 Dockerfile","text":"<pre><code>```\ncode Dockerfile\n```\n\n```dockerfile\nFROM node:alpine as builder\nWORKDIR /app\nCOPY ./package.json ./\nRUN npm install\nCOPY ./ ./\nRUN npm run build\n#\uc5ec\uae30\uae4c\uc9c0 nginx\uc5d0\uc11c \uc0ac\uc6a9\ud560 \ud30c\uc77c\uc744 build\ud569\ub2c8\ub2e4\n\n#Nginx\ub97c \uac00\ub3d9\ud558\uace0 \uc717 \ub2e8\uacc4\uc5d0\uc11c \uc0dd\uc131\ud55c \ube4c\ub4dc\ud30c\uc77c\ub4e4\uc744 nginx\uc5d0 \ubcf5\uc0ac\ud569\ub2c8\ub2e4\nFROM nginx\nEXPOSE 3000\n#nginx \ucee8\ud14c\uc774\ub108\uac00 3000\ubc88 \ud3ec\ud2b8\ub97c listen \ud558\ub3c4\ub85d \ud569\ub2c8\ub2e4\nCOPY ./nginx/default.conf /etc/nginx/conf.d/default.conf\n#default.conf\uc124\uc815\ud30c\uc77c \ubbf8\ub9ac \ub9cc\ub4e4\uace0 nginx\ucee8\ud14c\uc774\ub108 \uc548\uc5d0 \uc801\uc6a9\ud558\ub3c4\ub85d \ubcf5\uc0ac\ud569\ub2c8\ub2e4\nCOPY --from=builder /app/build /usr/share/nginx/html\n#\ube4c\ub4dc\uac00 \uc644\ub8cc\ub41c \ud30c\uc77c\uc744 Nginx \ub8e8\ud2b8 \ud3f4\ub354\uc5d0 \ubcf5\uc0ac\ud569\ub2c8\ub2e4\n```\n</code></pre>"},{"location":"DevOps/Multi%20container%20CICD/#nginx","title":"\ub77c\uc6b0\ud305\uc6a9 Nginx \uc124\uc815(\uc815\uc801\ud30c\uc77c \uc81c\uacf5\uc744 \uc704\ud55c)","text":"<ul> <li> <p>frontend \ub514\ub809\ud1a0\ub9ac\uc5d0 nginx\ud3f4\ub354 \uc0dd\uc131</p> <pre><code>mkdir nginx\ncd nginx\ncode default.conf\n</code></pre> </li> <li> <p>default.conf</p> <pre><code>server {\nlisten 3000;\nlocation / {\nroot /usr/share/nginx/html;\nindex index.html index.htm;\ntry_files $uri $uri/ /index.html;\n}\n}\n</code></pre> <ul> <li>listen 3000 : nginx \uc11c\ubc84\uac00 \uc0ac\uc6a9\ud560 \ud3ec\ud2b8\ub97c \uc624\ud508\ud569\ub2c8\ub2e4</li> <li>location / : \ub9cc\uc57d \ub8e8\ud2b8\ub85c \uc694\uccad\uc774 \ub4e4\uc5b4\uc628\ub2e4\uba74</li> <li>root /usr/share/nginx/html : HTML\ud30c\uc77c(\ube4c\ub4dc\ud30c\uc77c)\uc774 \uc704\uce58\ud55c \ub8e8\ud2b8\ud3f4\ub354\ub97c \uc124\uc815\ud569\ub2c8\ub2e4</li> <li>index index.html index.htm : \uc0ac\uc774\ud2b8\uc758 Index\ud398\uc774\uc9c0\ub97c index.html\ub85c \uc124\uc815\ud569\ub2c8\ub2e4</li> <li> <p>try_files $uri $uri/ /index.html  : React Router\ub97c \uc0ac\uc6a9\ud574\uc11c \ud398\uc774\uc9c0\uac04 \uc774\ub3d9\ud560 \ub54c \ud544\uc694\ud55c \uc635\uc158\uc785\ub2c8\ub2e4</p> <p> \ud83d\udca1 React\ub294 SPA\uc774\uae30 \ub54c\ubb38\uc5d0 index.html\ub2e8\uc77c \ud30c\uc77c\ub9cc \uac00\uc9c0\uace0 \uc788\uc73c\uba70, URL GET(REST)\ub85c \uc811\uc18d\uc744 \ud558\ub824\uace0 \ud560 \ub54c\uace0 index.html\ub85c \ub77c\uc6b0\ud305 \uc2dc\ucf1c\uc57c\ud569\ub2c8\ub2e4. \ud558\uc9c0\ub9cc NginX\ub294 \uc774\uac83\uc744 \uc778\uc9c0\ud558\uc9c0 \uc54a\uace0 \uc788\uae30 \ub54c\ubb38\uc5d0 \uc5b4\ub5a4 \uc694\uccad\uc774 \ub4e4\uc5b4\uc640\ub3c4 \uac15\uc81c\ub85c index.html\uc5d0 \ub77c\uc6b0\ud305 \ud558\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4"},{"location":"DevOps/Multi%20container%20CICD/#dockerfile-for-nodejs","title":"Dockerfile \uc791\uc131 - for NodeJS","text":"<ul> <li>\ub2f9\uc5f0\ud788 backend \ub514\ub809\ud130\ub9ac\uc5d0\uc11c \uc791\uc5c5\ud569\ub2c8\ub2e4</li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#dockerfiledev_1","title":"\uac1c\ubc1c \ud658\uacbd\uc6a9 Dockerfile.dev","text":"<p>Notice</p> <p>\ud83d\udca1 \ub108\ubb34 \ub9ce\uc774 \ubc18\ubcf5\ud588\uae30 \ub54c\ubb38\uc5d0 \uc124\uba85\uc740 \uc0dd\ub7b5\ud569\ub2c8\ub2e4</p> <pre><code>cd backend\ncode Dockerfile.dev\n</code></pre> <pre><code>FROM node:alpine\nWORKDIR /app\nCOPY ./package.json ./\n\nRUN npm install\n\nCOPY ./ ./\n\nCMD [\"npm\", \"run\", \"dev\"]\n#npm run start\uac00 \uc544\ub2cc npm run dev\ub97c \uc0ac\uc6a9\ud574\uc11c nodemon\ubaa8\ub4c8\uc744 \uc774\uc6a9\ud574 \uc2dc\uc791\ud569\ub2c8\ub2e4\n</code></pre>"},{"location":"DevOps/Multi%20container%20CICD/#dockerfile_1","title":"\uc6b4\uc601 \ud658\uacbd\uc6a9 Dockerfile","text":"<pre><code>```s\ncode Dockerfile\n```\n\n```dockerfile\nFROM node:alpine\n\nWORKDIR /app\n\nCOPY ./package.json ./\n\nRUN npm install\n\nCOPY ./ ./\n\nCMD [\"npm\", \"run\", \"start\"]\n```\n</code></pre>"},{"location":"DevOps/Multi%20container%20CICD/#db","title":"DB \uc138\ud305","text":"<p>Warning</p> <p>\ud83d\udca1 DB\uc791\uc5c5\uc740 \uc911\uc694\ud55c \ub370\uc774\ud130\ub97c \ub2e4\ub8e8\uae30 \ub54c\ubb38\uc5d0 \uc791\uc740 \uc2e4\uc218\ub85c\ub3c4 \ud070 \uc7ac\uc559\uc744 \ucd08\ub798\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4. \ub530\ub77c\uc11c \uac1c\ubc1c\ud658\uacbd\uc740 \ub3c4\ucee4\ub97c \uc774\uc6a9\ud558\uace0 \uc6b4\uc601\ud658\uacbd\uc5d0\uc11c\ub294 AWS RDS\ub97c \uc0ac\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <ol> <li>\uac1c\ubc1c\ud658\uacbd\uc740 \ub3c4\ucee4\ub85c MySQL\uc11c\ubc84\ub97c \uad6c\ucd95\ud569\ub2c8\ub2e4</li> <li> <p>\ud55c\uae00\uc774 \uae68\uc9c0\ub294 \uac83\uc744 \ub9c9\uae30 \uc704\ud574 MySQL \uc778\ucf54\ub529\uc744 UTF-8\ub85c \uc124\uc815\ud569\ub2c8\ub2e4. MySQL\uc6a9 conf \ud30c\uc77c\uc744 \uc774\uc6a9\ud574 \uc124\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>mkdir mysql\ncd mysql\ncode my.cnf\n</code></pre> <pre><code>[mysqld]\ncharacter-set-server=utf8\n\n[mysql]\ndefault-character-set=utf8\n\n[client]\ndefault-character-set=utf8\n</code></pre> </li> <li> <p>mysql \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud558\uace0 \ub3c4\ucee4\ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>code Dockerfile\n</code></pre> <pre><code>FROM mysql:5.7\nCOPY ./my.cnf /etc/mysql/conf.d/my.cnf\n</code></pre> </li> <li> <p>MySQL DB\ub97c \ub85c\ub4dc\ud55c \ud6c4 \ucd08\uae30 db\uc640 \ud14c\uc774\ube14 \uc0ac\uc6a9\uc744 \uc704\ud55c \ucd08\uae30 \ud658\uacbd\uc744 \uc81c\uc791\ud569\ub2c8\ub2e4</p> </li> <li> <p>\ub514\ub809\ud130\ub9ac\ub97c \uc0c8\ub85c \ub9cc\ub4e4\uace0 sql\ubb38\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir sqls\ncd sqls\ncode init.sql\n</code></pre> <pre><code>DTOP DATABASE IF EXISTS myapp;\n-- \uc774\uc804\uc5d0 \uc0dd\uc131\ub41c myapp DB\uac00 \uc874\uc7ac\ud560 \uacbd\uc6b0 \uc0ad\uc81c\nCREATE DATABASE myapp;\nUSE myapp;\nCREATE TABLE lists(\nid INT AUTO_INCREMENT,\nvalue TEXT,\nPRIMARY KEY (id)\n);\n</code></pre> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#proxy-layer-nginx","title":"Proxy Layer\uc6a9 Nginx \uc124\uc815","text":"<ol> <li> <p>\ub8e8\ud2b8\ud3f4\ub354\uc5d0 Nginx\ub97c \uc704\ud55c \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir nginx\ncd nginx\n</code></pre> </li> <li> <p>\ub3c4\ucee4\ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4(\uac1c\ubc1c, \uc6b4\uc601 \ud658\uacbd \uc124\uc815\uc774 \uac19\uae30 \ub54c\ubb38\uc5d0 .dev\ub97c \ub530\ub85c \uc0dd\uc131\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4</p> <pre><code>code Dockerfile\n</code></pre> <pre><code>FROM nginx\n#Nginx\ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0 \uac00\uc838\uc624\uae30\nCOPY ./default.conf /etc/nginx/conf.d/default.conf\n#\uc791\uc131\ub41c conf \ud30c\uc77c\uc744 Nginx\ucee8\ud14c\uc774\ub108\uc5d0 \ubcf5\uc0ac\ud558\uc5ec \uc124\uc815 \uc801\uc6a9\ud558\uae30\n</code></pre> </li> <li> <p>Nginx \uc124\uc815\ud30c\uc77c \uc0dd\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>code default.conf\n</code></pre> <pre><code>upstream frontend {\nserver frontend:3000;\n}\nupstream backend {\nserver backend:5000;\n}\nserver {\nlisten 80;\nlocation / {\nproxy_pass http://frontend;\n}\nlocation /api {\nproxy_pass http://backend;\n}\nlocation /sockjs-node {\nproxy_pass http://frontend;\nproxy_http_version 1.1;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection \"Upgrade\";\n}\n}\n</code></pre> <ul> <li>\uc544\ub798 'frontend', 'backend'\ub294 docker-compose \ud30c\uc77c\uc5d0\uc11c \uba85\uc2dc\ud569\ub2c8\ub2e4</li> <li>upstream frontend : 3000\ubc88 \ud3ec\ud2b8\uc5d0\uc11c frontend\uac00 \ub3d9\uc791\uc911\uc778 \uac83\uc744 \uba85\uc2dc\ud569\ub2c8\ub2e4</li> <li>upstream backend : 5000\ubc88 \ud3ec\ud2b8\uc5d0\uc11c backend\uac00 \ub3d9\uc791\uc911\uc778 \uac83\uc744 \uba85\uc2dc\ud569\ub2c8\ub2e4</li> <li>listen 80 : Nginx \uc11c\ubc84 80\ubc88 \ud3ec\ud2b8\ub97c Listening(\uc624\ud508) \ud569\ub2c8\ub2e4</li> <li>location / : \uc544\ub798\uc5d0 \ub098\uc624\ub294 \uc870\uac74\uc5d0 \ud574\ub2f9\ud558\ub294 \ub77c\uc6b0\ud305 \uc124\uc815\uc774 \uc5c6\uc73c\uba74 frontend\ub85c \ub77c\uc6b0\ud305 \ud569\ub2c8\ub2e4</li> <li>location /api : /api\ub85c \ub4e4\uc5b4\uc624\ub294 \uc694\uccad\uc740 backend\ub85c \ubcf4\ub0b4\uc90d\ub2c8\ub2e4</li> <li> <p>location /sockjs-node : \ub9ac\uc561\ud2b8 \uac1c\ubc1c\ud658\uacbd\uc5d0\uc11c \ubc1c\uc0dd\ud558\ub294 \uc5d0\ub7ec(\u2193)\ub97c \ucc98\ub9ac\ud558\uae30 \uc704\ud574 \uc791\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> </ul> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#docker-compose","title":"Docker compose \uc791\uc131","text":"<ul> <li> <p>\ub514\ub809\ud130\ub9ac \uad6c\uc870\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub8e8\ud2b8 \ud3f4\ub354\uc5d0\uc11c \ucef4\ud3ec\uc988 \ud30c\uc77c\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>code docker-compose.yml\n</code></pre> docker-compose.yml<pre><code>version: \"3\"\nservices:\nfrontend:\n  build: #\uac1c\ubc1c\ud658\uacbd\uc758 Dockerfile\uc774 \uc5b4\ub514\uc788\ub294\uc9c0 \uc54c\ub824\uc90d\ub2c8\ub2e4\n    dockerfile: Dockerfile.dev\n    context: ./frontend\n  container_name: app_frontend\n  environment:\n    - CHOKIDAR_USEPOLLING=true\n  volumes: #\ucf54\ub4dc\uc218\uc815\ud6c4 \uc774\ubbf8\uc9c0\ub97c \ub2e4\uc2dc \ube4c\ub4dc\ud560 \ud544\uc694 \uc5c6\ub3c4\ub85d \ub9e4\ud551\ud569\ub2c8\ub2e4\n    - /app/node_modules #\ub9e4\ud551\uc5d0\uc11c \uc81c\uc678\ud569\ub2c8\ub2e4\n    - ./frontend:/app #\ub098\uba38\uc9c0\ub294 \uc804\ubd80 \uc774\uacf3\uc73c\ub85c \ub9e4\ud551\ud569\ub2c8\ub2e4\n  stdin_open: true #\ub9ac\uc561\ud2b8 \uc571\uc744 \uc885\ub8cc\ud560 \ub54c \ubc1c\uc0dd\ud558\ub294 \ubc84\uadf8\ub97c \ud574\uacb0\ud574\uc90d\ub2c8\ub2e4\nnginx:\n  restart: always #proxy\uc5ed\ud560\uc744 \ud558\uace0 \uc788\ub294 Nginx\uac00 \uc8fd\uc5b4\ubc84\ub9ac\uba74 \uc2dc\uc2a4\ud15c \uc804\uccb4\uac00 \ub2e4\uc6b4\ub418\uae30 \ub54c\ubb38\uc5d0 \uc598\ub294 \ud56d\uc0c1 \uc7ac\uc2dc\uc791\n  #\uc7ac\uc2dc\uc791 \uc815\ucc45\n  #no : \uc5b4\ub5a4 \uc0c1\ud669\uc5d0\ub3c4 \uc7ac\uc2dc\uc791 \ud558\uc9c0 \uc54a\uc74c\n  #always : \ud56d\uc0c1 \uc7ac\uc2dc\uc791\n  #on-failure : on-failure\uc5d0\ub7ec\ucf54\ub4dc\uc640 \ud568\uaed8 \ucee8\ud14c\uc774\ub108\uac00 \uba48\ucd94\uc5c8\uc744 \ub54c\ub9cc \uc7ac\uc2dc\uc791\n  #unless-stopped : \uac1c\ubc1c\uc790\uac00 \uc784\uc758\ub85c \uba48\ucd94\ub824 \ud558\ub294 \uacbd\uc6b0\ub97c \uc81c\uc678\ud558\uace0 \ud56d\uc0c1 \uc7ac\uc2dc\uc791\n  build:\n    dockerfile: Dockerfile\n    context: ./nginx\n  container_name: app_proxy_nginx\n  ports: -\"3000:80\"\nbackend:\n  build:\n    dockerfile: Dockerfile.dev\n    context: ./backend\n  container_name: app_backend\n  volumes:\n    - /app/node_modules\n    - ./backend:/app\nmysql:\n  build: ./mysql\n  restart: unless-stopped\n  container_name: app_mysql\nports: -\"3306:3306\"\nvolumes:\n  - ./mysql/mysql_data:/var/lib/mysql\n  - ./mysql/sqls/:/docker-entrypoint-initdb.d/\nenvironment: #\ud658\uacbd\ubcc0\uc218\n  MYSQL_ROOT_PASSWORD: password\n  MYSQL_DATABASE: myapp\n</code></pre> </li> <li> <p>\uc791\uc131\uc774 \uc644\ub8cc\ub418\uc5c8\uc73c\uba74 \ucef4\ud3ec\uc988\ub97c \uc2e4\ud589\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>docker-compose up\n</code></pre> </li> <li> <p>ERROR : -initialize specified but the data directory has files in it. Aborting. \ubc1c\uc0dd\uc2dc \ubcfc\ub968\uc73c\ub85c \uc5f0\uacb0\ub41c mysql \ub370\uc774\ud130 \ub514\ub809\ud130\ub9ac\ub97c \ub0a0\ub824\uc90d\ub2c8\ub2e4</p> </li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#ready-for-cicd","title":"ready for CICD","text":""},{"location":"DevOps/Multi%20container%20CICD/#remove-mysql-container","title":"remove MySQL Container","text":"<ol> <li>AWS\ud658\uacbd\uc5d0\uc11c\ub294 DB\ub85c RDS\ub97c \uc774\uc6a9\ud558\uae30 \ub54c\ubb38\uc5d0 MySQL \ucee8\ud14c\uc774\ub108\uac00 \ud544\uc694\ud558\uc9c0 \uc54a\uc73c\ub2c8 \uc0ad\uc81c\ud569\ub2c8\ub2e4</li> <li> <p>docker-compose.yml \uc5d0\uc11c MySQL\ucf54\ub4dc\ub97c \uc81c\uac70\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#travis-ci-yaml","title":"Travis CI YAML \uc791\uc131","text":"<ol> <li> <p>\ub8e8\ud2b8 \ud3f4\ub354\uc5d0 \ud2b8\ub808\ube44\uc2a4 \uc124\uc815 \ud30c\uc77c\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>code .travis.yml\n</code></pre> .travis.yml<pre><code>language: generic\nsudo: required\nservices: #Travis CI\uc5d0\uac8c \ub3c4\ucee4 \ud658\uacbd\uc73c\ub85c \ub9cc\ub4e4\uac83\uc774\ub77c\uace0 \uc120\uc5b8\ud574\uc8fc\uae30\n- docker\nbefore_install: #\uad6c\uc131\ub41c \ub3c4\ucee4 \ud658\uacbd\uc5d0\uc11c Dockerfile.dev\ub97c \uc774\uc6a9\ud574 \uc774\ubbf8\uc9c0 \uc0dd\uc131\n- docker build -t dotoryeee/build-test -f ./frontend/Dockerfile.dev ./frontend\nscript: #\uc0dd\uc131\ub41c \ud14c\uc2a4\ud2b8 \uc774\ubbf8\uc9c0\ub97c \uc774\uc6a9\ud574 \ud14c\uc2a4\ud2b8 \uc218\ud589\ud558\uae30\n- docker run -e CI=true dotoryeee/build-test npm run test\nafter_success: #\ud14c\uc2a4\ud2b8\uac00 \uc131\uacf5\ud558\uba74 \ubcf8\uaca9\uc801\uc73c\ub85c \uc6b4\uc601\ubc84\uc804\uc744 \ube4c\ub4dc\n- docker build -t dotoryeee/docker-frontend ./frontend\n- docker build -t dotoryeee/docker-backend ./backend\n- docker build -t dotoryeee/docker-nginx ./nginx\n#\ub3c4\ucee4 \ud5c8\ube0c\uc5d0 \ub85c\uadf8\uc778\n- echo \"$DOCKER_HUB_PASSWORD\" | docker login -u \"$DOCKER_HUB_ID\" --password-stdin\n#\ub3c4\ucee4 \ud5c8\ube0c\uc5d0 \uc774\ubbf8\uc9c0 \ud478\uc2dc\n- docker push dotoryeee/docker-frontend\n- docker push dotoryeee/docker-backend\n- docker push dotoryeee/docker-nginx\n</code></pre> </li> <li> <p>\uacc4\uc815 \uc815\ubcf4\ub294 Travis CI \ud658\uacbd\ubcc0\uc218\uc5d0 \uc785\ub825\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uae43\ud5d9\uc5d0 \ud478\uc2dc\ud558\uace0 \ud55c \ubc88 \uc9c0\ucf1c\ubd05\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud658\uacbd\ubcc0\uc218\ub3c4 \uc798 \uac00\uc838\uc624\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud5f9</p> <p></p> </li> <li> <p>\ub3c4\ucee4 \ud5c8\ube0c\uc5d0 \uc774\ubbf8\uc9c0\uac00 \uc798 \uc5c5\ub85c\ub4dc \ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#aws","title":"AWS","text":""},{"location":"DevOps/Multi%20container%20CICD/#dockerrunawsjson","title":"Dockerrun.aws.json ?","text":"<ul> <li>Dockerfile\uc774 \ub2e4\uc218 \uc874\uc7ac\ud558\ub294 \uacbd\uc6b0 Beanstalk\uc774 \uc5b4\ub5bb\uac8c \ucc98\ub9ac\ud574\uc57c \ud558\ub294\uc9c0 \ud504\ub85c\uc138\uc2a4\ub97c \ubaa8\ub974\uae30 \ub54c\ubb38\uc5d0 Dockerrun.aws.json\uc744 \uc774\uc6a9\ud574 '\uc791\uc5c5 \uc815\uc758(Task Definition)'\ub97c \uba85\uc2dc\ud574\uc904 \uc218 \uc788\uc73c\uba70 \uc791\uc5c5 \uc815\uc758\ub97c \ub4f1\ub85d\ud560 \ub584\ub294 '\ucee8\ud14c\uc774\ub108 \uc815\uc758(Container Definition)'\ub3c4 \uba85\uc2dc\ud574\uc57c \ud569\ub2c8\ub2e4</li> <li>\ub530\ub77c\uc11c \uba40\ud2f0\ucee8\ud14c\uc774\ub108 \ud658\uacbd\uc5d0\uc11c\ub9cc \ud544\uc694\ud569\ub2c8\ub2e4</li> <li>\uc791\uc5c5\uc815\uc758\uc5d0\uc11c \ud560 \uc218 \uc788\ub294 \uac83<ul> <li>\ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc0ac\uc6a9\ud560 \ub3c4\ucee4 \uc774\ubbf8\uc9c0</li> <li>\ucee8\ud14c\uc774\ub108\ub97c \ub744\uc6b8 vCPU, \uba54\ubaa8\ub9ac</li> <li>\ucee8\ud14c\uc774\ub108\uac00 \uc0ac\uc6a9\ud560 \ub3c4\ucee4 \ub124\ud2b8\uc6cc\ud06c</li> <li>\uc791\uc5c5\uc774 \ud638\uc2a4\ud305\ub418\ub294 \uc778\ud504\ub77c</li> <li>\uc791\uc5c5\uc5d0 \uc0ac\uc6a9\ud560 \ub85c\uae45 \uad6c\uc131</li> <li>AWS IAM</li> </ul> </li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#ecs","title":"ECS \uc791\uc5c5 \uc815\uc758 \ud30c\uc77c \uc791\uc131","text":"<ol> <li> <p>\ub8e8\ud2b8 \ud3f4\ub354\uc5d0 JSON \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>code Dockerrun.aws.json\n</code></pre> Dockerrun.aws.json<pre><code>{\n\"AWSEBDockerrunVersion\": 2,\n\"containerDefinitions\": [\n{\n\"name\": \"frontend\",\n\"image\": \"dotoryeee/docker-frontend\",\n\"hostname\": \"frontend\",\n\"essential\": false,\n\"memory\": 128\n},\n{\n\"name\": \"backend\",\n\"image\": \"dotoryeee/docker-backend\",\n\"hostname\": \"backend\",\n\"essential\": false,\n\"memory\": 128\n},\n{\n\"name\": \"nginx\",\n\"image\": \"dotoryeee/docker-nginx\",\n\"hostname\": \"nginx\",\n\"essential\": true,\n\"portMappings\": [\n{\n\"hostPort\": 80,\n\"containerPort\": 80\n}\n],\n\"links\": [\"frontend\", \"backend\"],\n\"memory\":128\n}\n]\n}\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \uc815\uc758 \uac04\ub2e8 \uc124\uba85</p> <ul> <li>name : \ucee8\ud14c\uc774\ub108 \uc774\ub984</li> <li>hostname : \uc774\uac83\uc744 \uc774\uc6a9\ud574\uc11c \ub3c4\ucee4 \ucef4\ud3ec\uc988\ub97c \uc774\uc6a9\ud574 \uc0dd\uc131\ub41c \ub2e4\ub978 \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc811\uadfc \uac00\ub2a5</li> <li>essential : \ucee8\ud14c\uc774\ub108\uac00 \uc2e4\ud328\ud560 \uacbd\uc6b0 \uc791\uc5c5\uc744 \uc911\uc9c0\ud574\uc57c\ud558\uba74 true. \ud544\uc218\uc801\uc774\uc9c0 \uc54a\uc740 \ucee8\ud14c\uc774\ub108\ub294 \uc778\uc2a4\ud134\uc2a4\uc758 \ub098\uba38\uc9c0 \ucee8\ud14c\uc774\ub108\uc5d0 \uc601\ud5a5\uc744 \ubbf8\uce58\uc9c0 \uc54a\uace0 \uc885\ub8cc\ub418\uac70\ub098 \ucda9\ub3cc\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4 \uc9c0\uae08 \uc791\uc5c5\uc5d0\uc120 Nginx\uac00 \uc8fd\uc73c\uba74 \uc544\ubb34\uac83\ub3c4 \ub3d9\uc791\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0 Nginx\ub9cc true \uc785\ub2c8\ub2e4</li> <li> <p>links : \uc5f0\uacb0\ud560 \ucee8\ud14c\uc774\ub108\uc758 \ubaa9\ub85d. \uc5f0\uacb0\ub41c \ucee8\ud14c\uc774\ub108\ub294 \uc11c\ub85c\ub97c \uac80\uc0c9\ud558\uace0 \ud1b5\uc2e0\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p>\ud604\uc7ac links\ucc98\ub7fc \uc124\uc815\ud558\uba74 \uc544\ub798 \uadf8\ub9bc \ucc98\ub7fc \uc5f0\uacb0\ub429\ub2c8\ub2e4</p> <p></p> </li> </ul> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#aws-beanstalk","title":"AWS Beanstalk \uc0dd\uc131","text":"<ul> <li> <p>\uba40\ud2f0\ucee8\ud14c\uc774\ub108 \ud50c\ub7ab\ud3fc\uc73c\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> </ul>"},{"location":"DevOps/Multi%20container%20CICD/#aws-rds","title":"AWS RDS \uc0dd\uc131","text":"<ol> <li> <p>RDS\uc811\uc18d\uc744 \uc704\ud574 Docker-compose \ud30c\uc77c\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc774 \ud658\uacbd\ubcc0\uc218\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <pre><code>environment: MYSQL_HOST: mysql\nMYSQL_USER: root\nMYSQL_ROOT_PASSWORD: password\nMYSQL_DATABASE: myapp\nMYSQL_PORT: 3306\n</code></pre> </li> <li> <p>RDS\uc811\uc18d\uc744 \uc704\ud574 /backend/db.js \ud30c\uc77c\uc5d0\uc11c \ud658\uacbd\ubcc0\uc218\ub97c \ubd88\ub7ec\uc635\ub2c8\ub2e4</p> <pre><code>const pool = mysql.createPool({\nconnectionLimit: 10,\nhost: process.env.MYSQL_HOST,\nuser: process.env.MYSQL_USER,\npassword: process.env.MYSQL_ROOT_PASSWORD,\ndatabase: process.env.MYSQL_DATABASE,\nport: process.env.MYSQL_PORT\n});\n</code></pre> </li> <li> <p>AWS RDS\uc5d0 \uc811\uc18d\ud574\uc11c \uc778\uc2a4\ud134\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud658\uacbd\ubcc0\uc218\uc5d0 \ub9de\ucdb0\uc11c \uc138\ud305\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud3b8\ud558\uac8c \ucd94\uac00 \uc124\uc815\uc5d0\uc11c \ucd08\uae30 DB\ub3c4 \ubbf8\ub9ac \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#aws_1","title":"AWS \ubcf4\uc548\uadf8\ub8f9","text":"<ol> <li> <p>\uc778\ubc14\uc6b4\ub4dc \uc635\uc158 \uc5c6\uc774 SG\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc778\ubc14\uc6b4\ub4dc\uc5d0 SG\uc2a4\uc2a4\ub85c\ub97c \uc18c\uc2a4\ub85c \ub4f1\ub85d\ud558\uace0 3306 \ud3ec\ud2b8\ub97c \ud5c8\uc6a9\ud569\ub2c8\ub2e4</p> <p>\uc774\ub294 VPC \ub0b4\ubd80\uc5d0\uc11c\ub9cc \ud1b5\uc2e0\uc744 \ud5c8\uc6a9\ud558\uac8c \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>RDS\uc5d0 \ubc29\uae08 \uc0dd\uc131\ud55c \ubcf4\uc548\uadf8\ub8f9\uc744 \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc218\uc815\uc0ac\ud56d\uc744 \uc989\uc2dc \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ubc88\uc5d4 Beanstalk\uc5d0 \ubcf4\uc548\uadf8\ub8f9\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4 Beanstalk\uc758 \ub3d9\uc791\ud658\uacbd(env) \u2192 Configuration \u2192 Instance\uc758 Edit \uba54\ub274\uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc29\uae08 \ub9cc\ub4e0 SG\ub97c \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#beanstalk-rds","title":"Beanstalk \u2194 RDS \uc5f0\uacb0\uc744 \uc704\ud55c \ud658\uacbd\ubcc0\uc218 \uc124\uc815","text":"<ol> <li>\ube48\uc2a4\ud1a1 \uc548\uc5d0\uc788\ub294 \ucee8\ud14c\uc774\ub108\ub4e4\uc740 MySQL\uacfc \uc18c\ud1b5\ud560 \ub584 \ud658\uacbd\ubcc0\uc218\ub97c \uc778\uc2dd\ud560 \uc218 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \ub530\ub85c \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4</li> <li> <p>RDS\uc758 \uc5d4\ub4dc\ud3ec\uc778\ud2b8(\uc811\uc18d)\uc8fc\uc18c\ub97c \ubcf5\uc0ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ube48\uc2a4\ud1a1 \ud658\uacbd \uad6c\uc131\uc5d0\uc11c Software\ub97c \ud3b8\uc9d1\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \ud658\uacbd\ubcc0\uc218\ub97c \uc124\uc815\ud558\uace0 \uc800\uc7a5\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#_3","title":"\ubc30\ud3ec \uc124\uc815","text":"<ol> <li> <p>.travis.yml\uc5d0 \ub2e4\uc74c \ucf54\ub4dc\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> .travis.yml<pre><code>deploy:\nprovider: elasticbeanstalk\nregion: \"ap-northeast-2\"\napp: \"dotoryeee_FIRST_ECS_APP\"\nenv: \"Dotoryeeefirstecsapp-env\"\nbucket_name: elasticbeanstalk-ap-northeast-2-737382971423\nbucket_path: \"dotoryeee_FIRST_ECS_APP\"\non:\nbranch: master\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_ACCESS_KEY\n</code></pre> </li> <li> <p>travis \ud658\uacbd\ubcc0\uc218\uc5d0 AWS API KEY\uc815\ubcf4\ub97c \ucd94\uac00\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/Multi%20container%20CICD/#_4","title":"\ucd5c\uc885 \ud478\uc2dc","text":"<ol> <li>git push</li> <li> <p>\ube4c\ub4dc \uc131\uacf5</p> <p></p> </li> <li> <p>\uc790\ub3d9\uc73c\ub85c \ube48\uc2a4\ud1a1\uc5d0 \ubc30\ud3ec\ub429\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"DevOps/git/","title":"Git \uc815\ub9ac","text":""},{"location":"DevOps/git/#commands","title":"Commands","text":"<ol> <li>git checkout &amp; git switch, git restore</li> <li>git revert &amp; git reset</li> <li>git merge &amp; git rebase</li> </ol>"},{"location":"DevOps/git/#tools","title":"Tools","text":""},{"location":"DevOps/git/#gitk","title":"gitk","text":"<ul> <li> <p>\uc6a9\ub3c4 GUI\ub85c git \uad00\ub9ac\ud558\uae30</p> </li> <li> <p>Install <pre><code>sudo apt-get -y install gitk\n</code></pre></p> </li> <li> <p>Run <pre><code>gitk\n</code></pre> </p> </li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/","title":"Docker Proxy Layer for MySQL","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxy-layer","title":"Proxy Layer\uc758 \ud544\uc694\uc131","text":"<ul> <li>\uc678\ubd80(\uc5b4\ud50c\ub9ac\ucf00\uc774\uc158)\uc5d0\uc11c \uc811\uc18d \uc2dc 3306\ud3ec\ud2b8\uc758 MASTER DB\uac00 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud588\uc744 \ub54c, FailOver\uac00 \uad6c\ud604\ub418\uc5b4 SLAVE DB(3307)\uac00 MASTER\ub85c \uc2b9\uaca9\ub418\ub354\ub77c\ub3c4 3307\ud3ec\ud2b8\ub85c \uc790\ub3d9\uc73c\ub85c \ubcc0\uacbd\ub418\uc9c0 \uc54a\uae30 \ub584\ubb38\uc5d0 \uc0ac\uc774\uc5d0\uc11c \uc911\uc7ac\ud574\uc904 Layer\uac00 \ud544\uc694\ud569\ub2c8\ub2e4.</li> <li> <p>ex&gt;Nginx with Proxy</p> <p></p> </li> <li> <p>ex)Nginx without Proxy</p> <p></p> </li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>ProxySQL\uc744 \uc774\uc6a9\ud574 Proxy Layer\ub97c \uad6c\ud604\ud569\ub2c8\ub2e4</li> <li>READ, WRITE\uc791\uc5c5\uc744 \uc218\ud589\ud558\ub294 \ud638\uc2a4\ud2b8\uadf8\ub8f9\uacfc Read\uc791\uc5c5\ub9cc \uc218\ud589\ud558\ub294 \ud638\uc2a4\ud2b8 \uadf8\ub8f9\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxysql","title":"ProxySQL \ucee8\ud14c\uc774\ub108 \ub85c\ub4dc","text":"<ol> <li> <p>ProxySQL \ucee8\ud14c\uc774\ub108\uc5d0 \ub9e4\ud551\ud560 \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir -p /db/proxysql/data /db/proxysql/conf\n</code></pre> </li> <li> <p>\uc0dd\uc131\ud55c \ub514\ub809\ud130\ub9ac\uc5d0 \uc811\uadfc \uac00\ub2a5\ud558\ub3c4\ub85d \uad8c\ud55c\uc744 \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>chmod 777 /db/proxysql /db/proxysql/data /db/proxysql/conf\n</code></pre> </li> <li> <p>conf \ub514\ub809\ud130\ub9ac\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc740 \ub0b4\uc6a9\uc73c\ub85c \uc124\uc815\ud30c\uc77c(proxysql.cnf)\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi /db/proxysql/conf/proxysql.cnf\n</code></pre> <pre><code>datadir=\"/var/lib/proxysql\"\nadmin_variables=\n{\nadmin_credentials=\"admin:admin;radmin:radmin\"\nmysql_ifaces=\"0.0.0.0:6032\"\n}\nmysql_variables=\n{\nthreads=4\nmax_connections=2048\ndefault_query_delay=0\ndefault_query_timeout=36000000\nhave_compress=true\npoll_timeout=2000\ninterfaces=\"0.0.0.0:6033\"\ndefault_schema=\"information_schema\"\nstacksize=1048576\nserver_version=\"5.5.30\"\nconnect_timeout_server=3000\nmonitor_username=\"monitor\"\nmonitor_password=\"monitor\"\nmonitor_history=600000\nmonitor_connect_interval=60000\nmonitor_ping_interval=10000\nmonitor_read_only_interval=1500\nmonitor_read_only_timeout=500\nping_interval_server_msec=120000\nping_timeout_server=500\ncommands_stats=true\nsessions_sort=true\nconnect_retries_on_failure=10\n}\n</code></pre> </li> <li> <p>\uc124\uc815\ud30c\uc77c\uc758 \uad8c\ud55c\uc744 \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>chmod 644 /db/proxysql/conf/proxysql.cnf\n</code></pre> </li> <li> <p>mybridge \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c proxySQL \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> </li> </ol> <p>16032:6032 \ud3ec\ud2b8\uc640 16033:6033 \ud3ec\ud2b8\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4</p> <pre><code>```s\ndocker run -i -t --name proxysql -h proxysql --net mybridge --net-alias=proxysql -p 16032:6032 -p 16033:6033 -v /db/proxysql/data:/var/lib/proxysql -v /db/proxysql/conf/proxysql.cnf:/etc/proxysql.cnf -d proxysql/proxysql\n```\n</code></pre> <ol> <li> <p>\ucee8\ud14c\uc774\ub108\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\ub294\uc9c0 \ud655\uc778\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>docker ps --format \"table {{.ID}}\\t{{.Names}}\\t{{.Status}}\"\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uac00 \uc798 \uc2e4\ud589\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>MySQL\uc744 \uc774\uc6a9\ud574 proxySQL\uc5d0 \uc811\uadfc\uc744 \uc2dc\ub3c4\ud569\ub2c8\ub2e4</p> <pre><code>mysql -h 127.0.0.1 -P 16032 -uradmin -pradmin --prompt \"ProxySQL Admin&gt;\"\n</code></pre> </li> <li> <p>MySQL \ud074\ub77c\uc774\uc5b8\ud2b8\uac00 \uc5c6\ub2e4\uba74 \uc124\uce58 \ud6c4 \uc7ac\uc2dc\ub3c4 \ud569\ub2c8\ub2e4</p> <pre><code>dnf install -y mysql\n</code></pre> </li> <li> <p>ProxySQL Admin\uc5d0 \uc798 \uc811\uc18d\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxysql_1","title":"ProxySQL\uc758 \uc5ed\ud560 \uc218\ud589\uc744 \uc704\ud55c \uc138\ud305","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#db","title":"DB\ucee8\ud14c\uc774\ub108 \uc138\ud305","text":"<ol> <li> <p>db001 \ucee8\ud14c\uc774\ub108\uc758 MySQL \uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>testdb \ub370\uc774\ud130\ubca0\uc774\uc2a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE DATABASE testdb DEFAULT CHARACTER SET utf8;\n</code></pre> </li> <li> <p>\uc5b4\ud50c\ub9ac\ucf00\uc774\uc158\uc6a9 user\ub97c \uc0dd\uc131\ud558\uace0 db\uc811\uadfc \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER appuser@'%' IDENTIFIED BY 'apppass';\nGRANT SELECT, INSERT, UPDATE, DELETE ON testdb.* TO appuser@'%';\n</code></pre> </li> <li> <p>ProxySQL\ubaa8\ub2c8\ud130\uc6a9 user\ub97c \uc0dd\uc131\ud558\uace0 \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER monitor@'%' IDENTIFIED BY 'monitor';\nGRANT REPLICATION CLIENT ON *.* TO monitor@'%';\n</code></pre> </li> <li> <p>\uad8c\ud55c\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <pre><code>flush privileges;\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxysql_2","title":"ProxySQL \uc124\uc815(\uc11c\ubc84\uc815\ubcf4)","text":"<ol> <li> <p>sql\uc744 \uc774\uc6a9\ud574 ProxySQL \ucee8\ud14c\uc774\ub108 \uc811\uc18d</p> <pre><code>mysql -h 127.0.0.1 -P 16032 -uradmin -pradmin --prompt \"ProxySQL Admin&gt;\"\n</code></pre> </li> <li> <p>hostgroup 10(\uc4f0\uae30 \ucffc\ub9ac \uadf8\ub8f9) \uc5d0 db001\uc744 \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <pre><code>INSERT INTO mysql_servers(hostgroup_id, hostname, port) VALUES (10, 'db001', 3306);\n</code></pre> </li> <li> <p>hostgroup 20(\uc77d\uae30 \ucffc\ub9ac \uadf8\ub8f9)\uc5d0 \ubaa8\ub4e0 db\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <pre><code>INSERT INTO mysql_servers(hostgroup_id, hostname, port) VALUES (20, 'db001', 3306);\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) VALUES (20, 'db002', 3306);\nINSERT INTO mysql_servers(hostgroup_id, hostname, port) VALUES (20, 'db003', 3306);\n</code></pre> </li> <li> <p>SQL\uad6c\ubb38\uc73c\ub85c \uc124\uc815 \uc0c1\ud0dc\ub97c \ud655\uc778\ud574\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>SELECT * FROM mysql-servers;\n</code></pre> <p></p> </li> <li> <p>\uadf8\ub8f9\uc758 \uc815\ubcf4\ub97c \uc800\uc7a5\ud574\uc90d\ub2c8\ub2e4</p> <p>\uac12\uc740 WRITE GROUP, READ GROUP, WRITE\uc640 READ\uadf8\ub8f9\uc744 \uad6c\ubcc4\ud558\ub294 \uae30\uc900,'' \uc785\ub2c8\ub2e4</p> <pre><code>INSERT INTO mysql_replication_hostgroups VALUES (10, 20, 'read_only', '');\n//(WRITE GROUP, READ GROUP, WRITE\uc640 READ\uadf8\ub8f9\uc744 \uad6c\ubcc4\ud558\ub294 \uae30\uc900,'')\n</code></pre> </li> <li> <p>\ub9c8\ucc2c\uac00\uc9c0\ub85c SQL\ub85c \uc124\uc815\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>SELECT * FROM mysql_replication_hostgroups;\n</code></pre> <p></p> </li> <li> <p>\uc124\uc815\uc744 \uc801\uc6a9\ud558\uace0 \uc800\uc7a5\ud569\ub2c8\ub2e4</p> <pre><code>LOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\n//\uc124\uc815\ub41c \uc815\ubcf4\ub97c \ubc18\uc601\n//\uc124\uc815\uc744 \uc601\uad6c\uc801\uc73c\ub85c \uc800\uc7a5(\ub514\uc2a4\ud06c\uc5d0 \uae30\ub85d)\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxysql-user","title":"ProxySQL \uc124\uc815(USER \uc815\ubcf4)","text":"<ol> <li>\uc5b4\ud50c\ub9ac\ucf00\uc774\uc158\uc740 DB\uc11c\ubc84\uac00 \uc544\ub2cc ProxySQL\uc5d0 \uc811\uc18d\ud558\uae30 \ub54c\ubb38\uc5d0 ProxySQL\uc5d0\uc11c \uc138\ud305\ud569\ub2c8\ub2e4</li> <li> <p>\uc5b4\ud50c\ub9ac\ucf00\uc774\uc158\uc6a9 USER \uc815\ubcf4\ub97c ProxySQL\uc5d0 \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <pre><code>INSERT INTO mysql_users(username, password, default_hostgroup, transaction_persistent)\nVALUES ('appuser', 'apppass', 10, 0);\n</code></pre> </li> <li> <p>\ub9c8\ucc2c\uac00\uc9c0\ub85c \uc124\uc815\uc744 \uc801\uc6a9\ud558\uace0 \uc800\uc7a5\ud569\ub2c8\ub2e4</p> <pre><code>LOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#proxysql_3","title":"ProxySQL \uc124\uc815(\ucffc\ub9ac \ub8f0)","text":"<p>Warning</p> <p>\ud83d\udca1 \uc791\uc5c5 \uc21c\uc11c\ub97c \ubc18\ub4dc\uc2dc \uc9c0\ud0ac \uac83</p> <ol> <li> <p>SELECT FOR UPDATE(\uc4f0\uae30) \uad6c\ubb38 \uc694\uccad\uc774 \ub4e4\uc5b4\uc624\uba74 10\ubc88 \uadf8\ub8f9\uc73c\ub85c \ubcf4\ub0c5\ub2c8\ub2e4 //\uc4f0\uae30 \ucffc\ub9ac \ub8f0</p> <pre><code>INSERT INTO mysql_query_rules(rule_id, active, match_pattern, destination_hostgroup)\nVALUES (1, 1, '^SELECT.*FOR UPDATE$', 10);\n</code></pre> </li> <li> <p>SELECT \ucffc\ub9ac\ub294 20\ubc88 \ud638\uc2a4\ud2b8 \uadf8\ub8f9\uc73c\ub85c \ubcf4\ub0c5\ub2c8\ub2e4 //\uc77d\uae30 \ucffc\ub9ac \ub8f0</p> <pre><code>INSERT INTO mysql_query_rules(rule_id, active, match_pattern, destination_hostgroup)\nVALUES (2, 1, '^SELECT', 20);\n</code></pre> </li> <li> <p>\uc800\uc7a5\ud569\ub2c8\ub2e4</p> <pre><code>LOAD MYSQL SERVERS TO RUNTIME;\nSAVE MYSQL SERVERS TO DISK;\n</code></pre> </li> <li> <p>ProxySQL\ucee8\ud14c\uc774\ub108\uc5d0\uc11c \ube60\uc838\ub098\uc635\ub2c8\ub2e4</p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#_2","title":"\ub3d9\uc791 \ud14c\uc2a4\ud2b8","text":"<ol> <li>\ud14c\uc2a4\ud2b8\uc6a9 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</li> <li> <p>proxySQL \uc11c\ubc84\uc758 IP\ub97c \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>docker inspect --format \"{{.NetworkSettings.Networks.mybridge.IPAddress}}\" proxysql\n</code></pre> </li> <li> <p>16033\ud3ec\ud2b8\ub85c \uc811\uc18d\ud574 select \uad6c\ubb38\uc744 \uc2e4\ud589\ud558\ub294</p> <pre><code>vi app_test_conn.sh\n</code></pre> </li> <li> <p>app_test_conn.sh</p> <pre><code>#!/bin/bash\nwhile true;\ndo\nmysql -uappuser -papppass -h127.0.0.1 -P16033 -N -e \"select @@hostname,now()\" 2&gt;&amp;1| grep -v \"Warning\"\nsleep 1\ndone\n</code></pre> </li> <li> <p>select \uad6c\ubb38 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>sh app_test_conn.sh\n</code></pre> </li> <li> <p>\uc77d\uae30 \ucffc\ub9ac\ub294 \uc774\ucabd \uc800\ucabd DB\ub97c \ubaa8\ub450 \uc464\uc2dc\uace0 \ub2e4\ub2d9\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c\uc73c\ub85c db001\ucee8\ud14c\uc774\ub108 SQL \uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>Insert \uad6c\ubb38 \ud14c\uc2a4\ud2b8\ub97c \uc704\ud574 \uae30\ub85d\uc6a9 \ud14c\uc774\ube14\uc744 \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4</p> <pre><code>USE testdb;\nCREATE TABLE insert_test(hostname varchar(15), insert_time datetime);\n</code></pre> </li> <li> <p>db001 \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \ube60\uc838\ub098\uc635\ub2c8\ub2e4</p> </li> <li> <p>16033\ud3ec\ud2b8\ub85c \uc811\uc18d\ud574  insert \uad6c\ubb38\uc744 \uc2e4\ud589\ud558\ub294</p> <pre><code>vi app_test_insert.sh\n</code></pre> </li> <li> <p>app_test_insert.sh</p> <pre><code>#!/bin/bash\nwhile true;\ndo\nmysql -uappuser -papppass -h127.0.0.1 -P16033 -N -e \"insert into testdb.insert_test select @@hostname,now()\" 2&gt;&amp;1| grep -v \"Warning\"\nsleep 1\ndone\n</code></pre> </li> <li> <p>insert \uad6c\ubb38 \uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>sh app_test_insert.sh\n</code></pre> </li> <li> <p>\uc774 \uc2a4\ud06c\ub9bd\ud2b8\ub294 \ub3d9\uc791\ud558\uace0 \uc788\uc9c0\ub9cc \ud654\uba74\uc5d0 \uc2e4\uc2dc\uac04\uc73c\ub85c \ud45c\uc2dc\ub418\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>db001\uc5d0 \uc811\uc18d\ud558\uba74 \ub370\uc774\ud130\uac00 \uc798 \uc4f0\uc5ec\uc9c4 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4(1\ucd08\uac04\uaca9)</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20Proxy%20Layer%20for%20MySQL/#fail-over-test","title":"FAIL-OVER TEST","text":"<ol> <li>\uc7a5\uc560 \uc0c1\ud669\uc5d0\uc11c \uc758\ub3c4\ud55c\ub300\ub85c \ub3d9\uc791\ud558\ub294\uc9c0 \ud14c\uc2a4\ud2b8 \ud569\ub2c8\ub2e4</li> <li> <p>db001\uc5d0 \uc811\uc18d\ud574 \ud14c\uc774\ube14 \ub0b4\uc6a9\uc744 \ub0a0\ub824\uc90d\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> <pre><code>TRUNCATE TABLE testdb.insert_test;\n</code></pre> </li> <li> <p>\ub2e4\uc74c \uc0ac\uc9c4 \ucc98\ub7fc \ub450 \uac1c\uc758 \ud130\ubbf8\ub110\uc744 \uc900\ube44\ud558\uace0 insert \uc2a4\ud06c\ub9bd\ud2b8 \uc2e4\ud589 \ub3c4\uc911 MasterDB\uc5d0 \uc7a5\uc560\ub97c \uc77c\uc73c\ud0b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>db001\uc774 \uc815\uc9c0\ud558\uc790\ub9c8\uc790 \uc2a4\ud06c\ub9bd\ud2b8\uc5d0 \uc5d0\ub7ec \ud55c \uac1c \ud45c\uc2dc\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c\ub3c4 \ud074\ub7ec\uc2a4\ud130\uc5d0\uc11c \ubd84\ub9ac\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Master\ub85c \uc804\ud658\ub41c db002\uc758 SQL \uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db002 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>db001\uc774 \uc911\uc9c0\ud558\uace0 14\ucd08 \uc774\ud6c4\uc5d0 db002\uc5d0 \uc4f0\uae30 \ud2b8\ub79c\uc7ad\uc158\uc774 \ubc15\ud788\ub294 \ubaa8\uc2b5\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4!</p> <p></p> </li> <li> <p>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\ud130\uac00 \ub2e4\uc2dc \ub3d9\uc791\ud560 \uc218 \uc788\ub3c4\ub85d recovery\ub97c ack \ucc98\ub9ac\ud574\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc6d0\uc0c1 \ubcf5\uad6c\ub97c \uc704\ud574 db001\uc744 \ub2e4\uc2dc SLAVE\ub85c \uac00\ub3d9\ud569\ub2c8\ub2e4</p> <pre><code>docker start db001\ndocker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> <pre><code>set global read_only=1;\nCHANGE MASTER TO MASTER_HOST='db002', MASTER_USER='repl', MASTER_PASSWORD='repl', MASTER_AUTO_POSITION=1;\nSTART SLAVE;\n</code></pre> </li> <li> <p>db001\uc774 SLAVE\ub85c\uc368 \ub2e4\uc2dc \ud074\ub7ec\uc2a4\ud130\ub85c \ubcf5\uadc0\ud588\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/","title":"Docker basics","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#_1","title":"\ubaa9\ud45c","text":"<ol> <li>\ub3c4\ucee4\ub97c \ubcf5\uc2b5 \uacb8 \uac04\ub2e8\ud558\uac8c \ud55c \ubc88 \ud6d1\uc5b4\ubd05\ub2c8\ub2e4</li> <li>\uac04\ub2e8\ud55c node \ubc31\uc5d4\ub4dc\ub97c \uc791\uc131\ud558\uace0 \ub3c4\ucee4 \uc774\ubbf8\uc9c0\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</li> <li>Working Directory\ub97c \uc124\uc815\ud569\ub2c8\ub2e4</li> <li>node \uc885\uc18d\uc131\uc744 \uc218\uc815\ud574 \uc774\ubbf8\uc9c0 \ube4c\ub4dc \uc18d\ub3c4\ub97c \ub192\uc5ec\ubd05\ub2c8\ub2e4</li> <li>\uac1c\ubc1c\uc77c\uc744 \ud560 \ub584 docker volume\uc744 \uc5b4\ub5bb\uac8c \ud65c\uc6a9\ud560 \uc218 \uc788\ub294\uc9c0 \ud55c \ubc88 \uc0b4\ud3b4\ubd05\ub2c8\ub2e4</li> <li>compose\ub97c \uc774\uc6a9\ud574 \uac04\ub2e8\ud55c \ud398\uc774\uc9c0\ub97c \ub9cc\ub4e4\uc5b4\ubd05\ub2c8\ub2e4</li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#_2","title":"\ud30c\uc77c \uc900\ube44","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#node-app","title":"Node app","text":"<ol> <li> <p>node\ub97c \ucd08\uae30\ud654 \ud569\ub2c8\ub2e4</p> <pre><code>npm init\n</code></pre> <p></p> </li> <li> <p>express \uc0ac\uc6a9\uc744 \uc704\ud574 package.json\uc5d0 dependency\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <pre><code>\"dependencies\": {\n\"express\": \"4.17.1\"\n},\n</code></pre> </li> <li> <p>\uac04\ub2e8\ud55c Node\uc571\uc744 \uc900\ube44\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>code server.js\n</code></pre> <pre><code>const express = require('express');\nconst PORT = 8080;\nconst app = express();\napp.get('/', (req, res) =&gt; {\nres.send(\"!docker with node test!\")\n});\napp.listen(PORT);\nconsole.log('Server START')\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#dockerfile","title":"Dockerfile","text":"<ol> <li> <p>\ub3c4\ucee4\ud30c\uc77c \uc791\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>code Dockerfile\n</code></pre> </li> <li> <p>\uae30\ubcf8\uc801\uc778 dockerfile\ud2c0\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <ul> <li> <p>node 10\ubc84\uc804 \uc0ac\uc6a9</p> <p>alpine \uc774\ubbf8\uc9c0\ub294 \uacbd\ub7c9\ud654\ub41c \uc774\ubbf8\uc9c0(5MB)\uc774\uae30 \ub54c\ubb38\uc5d0 npm\uc2e4\ud589\uc744 \uc704\ud55c \ud658\uacbd\uc774 \uac16\ucd94\uc5b4\uc838\uc788\uc9c0 \uc54a\uc73c\ubbc0\ub85c node \ubca0\uc774\uc2a4 \uc774\ubbf8\uc9c0\ub97c \uc0ac\uc6a9\ud569\ub2c8\ub2e4</p> </li> <li> <p>\uc774\ubbf8\uc9c0 \ub85c\ub4dc \uc804 npm install \uba85\ub839 \uc2e4\ud589</p> <p>package.json\uc5d0 \uc801\ud600\uc788\ub294 \uc885\uc18d\uc131\ub4e4\uc744 \uc790\ub3d9\uc73c\ub85c \uc124\uce58\ud574 \ud5a5\ud6c4 server.js\uac00 \uc6d0\ud65c\ud558\uac8c \ub3d9\uc791\ud560 \uc218 \uc788\ub294 \ud658\uacbd\uc744 \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4</p> </li> <li> <p>\uc774\ubbf8\uc9c0 \ub85c\ub4dc \ud6c4 node server.js \uba85\ub839 \uc2e4\ud589</p> </li> </ul> <pre><code>FROM node:10\nRUN npm install\n\nCMD [\"node\", \"server.js\"]\n</code></pre> </li> <li> <p>\ud558\uc9c0\ub9cc \uc774\ub807\uac8c \ud558\uba74 package.json, server.js \ud30c\uc77c\uc774 \ucee8\ud14c\uc774\ub108\uc5d0 \ud3ec\ud568\ub420 \uc218 \uc5c6\uae30 \ub584\ubb38\uc5d0 copy \uba85\ub839\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4. \uc544\ub798 \ub450 \uac1c\ub294 \uac19\uc740 \uba85\ub839\uc785\ub2c8\ub2e4</p> <pre><code>FROM node:10\nCOPY ./ ./\n\nRUN npm install\nCMD [\"node\", \"server.js\"]\n</code></pre> <pre><code>FROM node:10\nCOPY package.json ./\nCOPY server.js ./\n\nRUN npm install\nCMD [\"node\", \"server.js\"]\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#build-image","title":"Build Image","text":"<ol> <li> <p>(dotoryeee\uc758 first_image)\uc774\ub984\uc73c\ub85c \uc774\ubbf8\uc9c0 \ube4c\ub4dc\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker build -t dotoryeee/first_image ./\n</code></pre> <p></p> </li> <li> <p>\uc774\ubbf8\uc9c0\uac00 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <pre><code>docker images\n</code></pre> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#load-container","title":"Load Container","text":"<ol> <li> <p>\uc0dd\uc131\ub41c \uc774\ubbf8\uc9c0\ub85c \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud574\ubd05\ub2c8\ub2e4</p> <p>\ud638\uc2a4\ud2b8\ud3ec\ud2b8 5000\uacfc \ucee8\ud14c\uc774\ub108\ud3ec\ud2b8 8080\uc744 \ub9e4\ud551\ud569\ub2c8\ub2e4</p> <pre><code>docker run -p 5000:8080 dotoryeee/first_image\n</code></pre> </li> <li> <p>{DOCKER HOST IP}:8080\uc5d0 \uc811\uc18d\ud558\uba74 \uc11c\ubc84\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#working-directory","title":"Working Directory \uc124\uc815","text":"<ol> <li> <p>\ud604\uc7ac \uc774\ubbf8\uc9c0\uc758 \ub8e8\ud2b8\ud3f4\ub354\ub294 \ub108\ubb34 \uc5b4\uc9c0\ub7fd\uace0 lock.json, dockerfile \ub4f1 \ub4e4\uc5b4\uc624\uba74 \uc548\ub418\uac70\ub098 \ub4e4\uc5b4\uc62c \ud544\uc694\uac00 \uc5c6\ub294 \ud30c\uc77c\uae4c\uc9c0 \ud3ec\ud568\ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4.  \ub610\ud55c \uc6d0\ub798 \uc774\ubbf8\uc9c0\uc5d0 \uc788\ub358 \ud30c\uc77c\uba85\uacfc \uc911\ubcf5\ub420 \uacbd\uc6b0 \uae30\uc874 \ud30c\uc77c\uc744 \uc0ad\uc81c\ud574\ubc84\ub9ac\ub294 \uacbd\uc6b0\uac00 \ubc1c\uc0dd\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub54c\ubb38\uc5d0 \uc791\uc5c5 \ub514\ub809\ud1a0\ub9ac\ub97c \ubcc4\ub3c4\ub85c \ubd84\ub9ac\ud558\uace0 \uc774\ubbf8\uc9c0\ub97c \uc0c8\ub85c \ube4c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>FROM node:10\nWORKDIR /usr/src/app\nCOPY ./ ./\n\nRUN npm install\nCMD [\"node\", \"server.js\"]\n</code></pre> <pre><code>docker build -t dotoryeee/first_image ./\n</code></pre> </li> <li> <p>\uc774\uc81c \uc791\uc5c5\ub514\ub809\ud1a0\ub9ac\uac00 \ubcc0\uacbd\ub418\uc5b4 \uae54\ub054\ud574\uc84c\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#nodejs","title":"NodeJS \uc7ac\ube4c\ub4dc \uc2dc \ud6a8\uc728 \ub192\uc774\uae30","text":"<ol> <li>\ud604\uc7ac \uc774\ubbf8\uc9c0 \ube4c\ub4dc \uc21c\uc11c\ub294 dockerfile\uc744 \ubcf4\uba74 \uc54c \uc218 \uc788\ub4ef\uc774 \ucf54\ub4dc\ub97c \uac00\uc838\uc628 \uc774\ud6c4(COPY) npm\uc744 \uc774\uc6a9\ud574 package.json\uc744 \ub2e4\uc6b4\ub85c\ub4dc&amp;\uc124\uce58 \ud569\ub2c8\ub2e4.</li> <li>\ub2e8\uc21c\ud788 \ucf54\ub4dc\ub9cc \uc5c5\ub370\uc774\ud2b8 \ud560 \ub584, \uc885\uc18d\uc131\uc740 \ubc14\ub00c\uc9c0 \uc54a\uc558\uc74c\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0 npm\uc744 \uc774\uc6a9\ud574 \ucc98\uc74c\ubd80\ud130 \ube4c\ub4dc\ud558\uace0 \uc788\ub294 \uc0c1\ud669\uc785\ub2c8\ub2e4</li> <li>\ub54c\ubb38\uc5d0 package.json\ub9cc \ub530\ub85c \uba3c\uc800 copy \ud574\uc11c cache\ud654 \uc791\uc5c5 \ud6c4 npm install\uc744 \uc218\ud589\ud569\ub2c8\ub2e4</li> <li> <p>\uc774\ub97c \uad6c\ud604\ud558\uae30 \uc704\ud574 dockerfile\uc744 \uc544\ub798\uc640 \uac19\uc774 \uc218\uc815\ud558\uba74 \ub429\ub2c8\ub2e4</p> <pre><code>FROM node:10\nWORKDIR /usr/src/app\nCOPY package.json ./\n\nRUN npm install\nCOPY ./ ./\nCMD [\"node\", \"server.js\"]\n</code></pre> </li> <li> <p>dockerfile \uc791\uc5c5 \ud6c4 \ucd5c\ucd08\ube4c\ub4dc\uc2dc 6.7\ucd08\uac00 \uc18c\uc694\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ud6c4 server.js\uc5d0\uc11c \ud55c \uae00\uc790\ub9cc \uc218\uc815\ud558\uace0 \uc7ac\ube4c\ub4dc\uc2dc package.json\uc774 \uc774\ubbf8 \uc874\uc7ac\ud558\uae30 \ub54c\ubb38\uc5d0 server.js \ucf54\ub4dc\uac00 \ubcc0\uacbd\ub418\uc5c8\uc74c\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0 1.8\ucd08\ubc16\uc5d0 \uc18c\ubaa8\ub418\uc9c0 \uc54a\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#docker-volume","title":"Docker Volume","text":"<p>Tip</p> <p>\ud83d\udca1 \uad8c\ud55c \uc5d0\ub7ec \ubc1c\uc0dd\uc2dc sudo chown -R yourusername:yourusername /path/to/node_modules</p> <ol> <li> <p>\ubcfc\ub968 \ub9e4\ud551\uc2dc \ucee8\ud14c\uc774\ub108 \ub85c\ub4dc \uba85\ub839\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>docker run -p 5000:8080 \\\n-v /usr/src/app/node_module \\\n-v $(pwd):/use/src/app \\\n-d dotoryeee/first_image\n</code></pre> </li> <li> <p>\ubcfc\ub968 \ub9e4\ud551(\ucc38\uc870) \ubd80\ubd84\uc5d0\uc11c \ub450 \uc904\uc740 \uac01\uac01 \ud2b9\uc131\uc774 \ub2e4\ub985\ub2c8\ub2e4</p> </li> <li>3\ubc88 \ud589\uc740 \ud658\uacbd\ubcc0\uc218\uc5d0\uc11c pwd(\ud604\uc7ac \uc791\uc5c5\uc911\uc778 \ub514\ub809\ud130\ub9ac) \uc704\uce58\ub97c \uac00\uc838\uc640 \ucee8\ud14c\uc774\ub108\uc758 /src/app \ud3f4\ub354\uc5d0 \ub9e4\ud551\ud558\uc9c0\ub9cc</li> <li> <p>2\ubc88 \ud589\uc758 node_module\ud3f4\ub354\ub294 \ud638\uc2a4\ud2b8\uc5d0 \uc874\uc7ac\ud558\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 \uc608\uc678\ub85c \ucc98\ub9ac\ud558\uc9c0 \ub9d0\ub77c\ub294 \uba85\ub839\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ub807\uac8c \ubcfc\ub968\uc744 \ud604\uc7ac \ub514\ub809\ud1a0\ub9ac\uc5d0 \ub9e4\ud551\ud574\uc8fc\uba74 \ucf54\ub4dc \ubcc0\uacbd \uc2dc \uc774\ubbf8\uc9c0\ub97c \ube4c\ub4dc\ud560 \ud544\uc694\uac00 \uc5c6\uc5b4\uc9d1\ub2c8\ub2e4</p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#docker-compose","title":"Docker Compose","text":"<ol> <li> <p>\uc791\uc5c5\uc6a9 \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud558\uace0 \ub178\ub4dc\ub97c \ucd08\uae30\ud654\ud569\ub2c8\ub2e4</p> <pre><code>mkdir compose\ncd compose\nnpm init\n</code></pre> <p></p> </li> <li> <p>\uc885\uc18d\uc131\uc5d0 express\uc640 redis\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <pre><code>code package.json\n</code></pre> <pre><code>\"dependencies\": {\n\"express\": \"4.17.1\"\n\"redis\" : \"3.0.2\"\n},\n</code></pre> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \uc11c\ubc84\ub97c \uc791\uc131\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>code server.js\n</code></pre> <pre><code>const express = require(\"express\");\nconst redis = require(\"redis\");\nconst EXPRESS_PORT = 7070;\nconst REDIS_PORT = 6379;\n//redis\nconst client = redis.createClient({\n//host\uac12\uc5d0 \ub3c4\ucee4\uac00 \uc544\ub2cc \uc77c\ubc18 \ud658\uacbd\uc5d0\uc11c\ub294 https://redis-server.com \uc744 \uc785\ub825\n//compose\ub97c \uc0ac\uc6a9\ud560 \uacbd\uc6b0 docker-compose.yml\uc5d0 \uba85\uc2dc\ud55c \ucee8\ud14c\uc774\ub108 \uc774\ub984\uc744 \uc785\ub825\nhost: \"redis-server\";  port: REDIS_PORT;\n})\nclient.set(\"number\", 0);\n//express\napp.get('/', (req, res) =&gt; {\nclient.get(\"number\", (err, Number) =&gt; { //\uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud558\uc9c0 \uc54a\ub294\ub2e4\uba74\n//\uc22b\uc790\ub97c 1\uc529 \uc99d\uac00\nclient.set(\"number\", parseInt(Number) + 1);\nres.send(`\ud604\uc7ac \uc0c8\ub85c\uace0\uce68 \uce74\uc6b4\ud2b8 : ${Number}`);\n})\n})\nconst app = express();\napp.listen(EXPRESS_PORT);\nconsole.log('server is running');\n</code></pre> </li> <li> <p>\ud604\uc7ac\ub294 compose\ub97c \uc704\ud55c \ub514\ub809\ud130\ub9ac\ub97c \ub530\ub85c \ub9cc\ub4e4\uc5b4 \ub454 \uc0c1\ud0dc\uc774\ub2c8 \uc804\uccb4 \ud30c\uc77c\uc744 \ud328\ud0a4\uc9d5 \ud569\ub2c8\ub2e4</p> <pre><code>FROM node:10\nWORKDIR /usr/src/app\nCOPY ./ ./\n\nRUN npm install\n\nCMD [\"node\", \"server.js\"]\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20basics/#docker-compose-yaml","title":"Docker compose YAML","text":"<ol> <li>\ucef4\ud3ec\uc988\uc2dc \uc5ec\ub7ec \uc124\uc815\uc744 \ud574\uc904 \uc218 \uc788\ub294 YAML \ud30c\uc77c\uc785\ub2c8\ub2e4</li> <li> <p>\ud604\uc7ac \ucee8\ud14c\uc774\ub108\ub294 \ub2e4\uc74c\uacfc \uac19\uc774 \ubcc4\ub3c4\uc758 \ub808\ub514\uc2a4 \uc11c\ubc84\uac00 \ud544\uc694\ud569\ub2c8\ub2e4</p> <p>\ucee8\ud14c\uc774\ub108\uac04 \ud1b5\uc2e0\uc744 \uc124\uc815\ud574\uc11c \ud1b5\uc2e0\uc744 \uac00\ub2a5\ud558\ub3c4\ub85d \ub9cc\ub4e4\uc5b4 \uc904 \ud544\uc694\uac00 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>yaml \ud30c\uc77c \uc791\uc5c5\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>vi docker-compose.yml\n</code></pre> </li> <li> <p>\ub0b4\uc6a9\uc740 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>version: \"3\"       #docker compose\uc758 \ubc84\uc804\nservices:          #\uc2e4\ud589\ud558\ub824\ub294 \ucee8\ud14c\uc774\ub108 \uc815\uc758\nredis-server:    #\ucee8\ud14c\uc774\ub108 \uc774\ub984\nimage: \"redis\" #\ucee8\ud14c\uc774\ub108\uac00 \uc0ac\uc6a9\ud558\ub294 \uc774\ubbf8\uc9c0\nnode-app:        #\ucee8\ud14c\uc774\ub108 \uc774\ub984\nbuild: .       #\ud604\uc7ac \uc704\uce58\uc5d0 \uc788\ub294 dockerfile \uc0ac\uc6a9\nports:         #\ud3ec\ud2b8\ub9e4\ud551\n- \"5000:7070\"\n</code></pre> </li> <li> <p>\ucef4\ud3ec\uc988\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>docker-compose up\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \ub450 \ub300\uac00 \ubaa8\ub450 \ub85c\ub4dc\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc11c\ubc84\uac00 \uc798 \ub3d9\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc624\ud0c0\ub85c \uc778\ud574 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud588\ub2e4\ub358\uac00 \ub4f1\uc758 \uc774\uc720\ub85c \uc778\ud574 \uc774\ubbf8\uc9c0\ub97c \uac15\uc7ac\ub85c \uc7ac\ube4c\ub4dc \ud6c4 \ucef4\ud3ec\uc988\ub97c \uc2e4\ud589\ud558\ub824\uba74 \ub2e4\uc74c\uacfc \uac19\uc774 \uc785\ub825\ud569\ub2c8\ub2e4</p> <pre><code>docker-compose up --build\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \uc885\ub8cc\ub294 Ctrl + C\ub97c \uc785\ub825\ud558\uba74 \ub429\ub2c8\ub2e4</p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/","title":"Docker compose and web GUI","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_1","title":"\uc791\uc5c5\uc694\uc57d","text":"<ul> <li>Docker\ub97c \uc124\uce58\ud558\ub294 \uacfc\uc815\uc5d0 \ud544\uc694\ud55c \ud30c\ub77c\ubbf8\ud130 \ubcc0\uc218\uc5d0 \ub300\ud574 \uc54c\uc544\ubd05\ub2c8\ub2e4</li> <li>\ube60\ub978 \uc774\ud574\uc640 \ud3b8\ub9ac\ud55c \uc0ac\uc6a9\uc744 \uc704\ud574 Portainer\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</li> <li>Docker-Hub\uc5d0\uc11c \ucee8\ud14c\uc774\ub108\ub97c \ucc3e\uace0 DVWA \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud574\ubd05\ub2c8\ub2e4</li> <li>YAML + Docker Compose\ub97c \uc774\uc6a9\ud574 \ucf54\ub4dc\ub85c \uad00\ub9ac\ud558\ub294 \ubc95\uc744 \uc54c\uc544\ubd05\ub2c8\ub2e4</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_2","title":"\uc124\uce58 \uc804 \uae30\ubcf8 \uc791\uc5c5","text":"<ol> <li> <p>\uc6d0\ud65c\ud55c \uc791\uc5c5\uc744 \uc704\ud574 Ubuntu \uc2dc\uc2a4\ud15c\uc744 \uc5c5\ub370\uc774\ud2b8\ud569\ub2c8\ub2e4</p> <pre><code>sudo apt update &amp;&amp; sudo apt upgrade\n</code></pre> </li> <li> <p>\ud2b8\ub7ec\ube14\uc288\ud305 \ud639\uc740 \uc791\uc5c5\uc2dc \ud544\uc694\ud55c net-tools\uc640 ssh, vim\uc744 \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>sudo apt install net-tools ssh vim\n</code></pre> </li> <li> <p>https\ub97c \uc774\uc6a9\ud558\uc5ec \ud504\ub85c\uadf8\ub7a8\uc5d0 \uc811\uadfc / ca\uc11c\uba85 / http\ub97c \uc774\uc6a9\ud55c \ud1b5\uc2e0 / GPG\ud0a4 \uad00\ub9ac\uc790 / PPA\uc561\uc138\uc2a4\ub97c \uc704\ud55c \ud504\ub85c\uadf8\ub7a8\uc744 \uac01\uac01 \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>sudo apt install apt-transport-https ca-certificates curl gnupg-agent software-properties-common\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#docker","title":"Docker \uc124\uce58 \ubc0f \ud655\uc778","text":"<ol> <li> <p>\ub3c4\ucee4\uc758 GPG PublicKey\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud55c \ud6c4 apt-key\uc5d0 \ucd94\uac00\ud569\ub2c8\ub2e4</p> <pre><code>curl \u2013fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -\n</code></pre> </li> <li> <p>OK\ub97c \ud655\uc778\ud558\uc5ec \uc815\uc0c1\uc801\uc73c\ub85c \uc644\ub8cc\ub41c \uac83\uc744 \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>ppa\uc800\uc7a5\uc18c\ub97c \ucd94\uac00\ud558\uace0 \uc5c5\ub370\uc774\ud2b8 \ud569\ub2c8\ub2e4</p> <pre><code>sudo add-apt-repository \"deb [arch=amd64] https://download.docker.com/linux/ubuntu bionic stable\"\nsudo apt update\n</code></pre> </li> <li> <p>\ub3c4\ucee4\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</p> <p>docker-ce : \ub3c4\ucee4 \ub370\ubaac\uc73c\ub85c \ubaa8\ub4e0 \uc791\uc5c5\uc744 \uc218\ud589\ud558\ub294 \ubd80\ubd84\uc785\ub2c8\ub2e4</p> <p>docker-cli : \ub370\ubaac\uc740 \uc81c\uc5b4\ud558\ub294 CLI \ub3c4\uad6c\uc785\ub2c8\ub2e4</p> <p>containerd.io : \ucee8\ud14c\uc774\ub108 \ub370\ubaac\uc785\ub2c8\ub2e4</p> <pre><code>sudo apt install docker-ce docker-cli containerd.io\n</code></pre> </li> <li> <p>\ub3c4\ucee4\uc758 \uba85\ub839\uc744 \uc2e4\ud589\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>docker \u2013v\n</code></pre> </li> <li> <p>\uc815\uc0c1\uc801\uc73c\ub85c \uc124\uce58\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub9ac\ub205\uc2a4 \ubd80\ud305\ub420 \ub54c \uc790\ub3d9\uc73c\ub85c \ub3c4\ucee4\uac00 \uc2e4\ud589\ub420 \uc218 \uc788\ub3c4\ub85d \uc11c\ube44\uc2a4\uc5d0 \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <pre><code>sudo systemctl enable docker &amp;&amp; service docker start\n</code></pre> </li> <li> <p>\ub9ac\ub205\uc2a4\uc5d0\uc11c \ub3c4\ucee4 \uc11c\ube44\uc2a4 \uc0c1\ud0dc\ub97c \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>service docker status\n</code></pre> </li> <li> <p>\uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791\ud558\uace0 \uc788\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#docker_1","title":"DOCKER \uba85\ub839\uc5b4","text":"<p>Details</p> <p>\ud83d\udca1 \uc635\uc158\uc774 \ub108\ubb34 \ub9ce\uc740 \uacbd\uc6b0 \uc0dd\ub7b5 \u2192 \uac01 \uba85\ub839\uc5b4\uc758 \ud30c\ub77c\ubbf8\ud130 \u2014help \ucc38\uc870</p>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_3","title":"\uae30\ubcf8 \uba85\ub839\uc5b4","text":"<ul> <li>docker version : \ub3c4\ucee4 \ubc84\uc804 \ud655\uc778</li> <li>docker system info : \ub3c4\ucee4 \uad6c\ub3d9 \ud658\uacbd</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_4","title":"\uc774\ubbf8\uc9c0 \uad00\ub828 \uba85\ub839\uc5b4","text":"<ul> <li> <p>docker system df (-v) : \ub3c4\ucee4 \uc774\ubbf8\uc9c0 \uc0ac\uc6a9\ub7c9 \ud655\uc778</p> <p></p> </li> <li> <p>docker images : \ub3c4\ucee4 \uc774\ubbf8\uc9c0 \ud655\uc778</p> <p></p> </li> <li> <p>docker pull {-a -q} {image}: \ub3c4\ucee4 \uc774\ubbf8\uc9c0 \ub2e4\uc6b4\ub85c\ub4dc</p> </li> <li>docker rmi {-f} {image} : \ub3c4\ucee4 \uc774\ubbf8\uc9c0 \uc0ad\uc81c</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_5","title":"\ucee8\ud14c\uc774\ub108 \uad00\ub828 \uba85\ub839\uc5b4","text":"<ul> <li>docker run {-a -c -d -e -h -i etc...}  : \ucee8\ud14c\uc774\ub108 \uc2e4\ud589</li> <li>docker ps {-a -f -n -l -q -s} : \ub3c4\ucee4 \ucee8\ud14c\uc774\ub108 \ud655\uc778</li> <li>docker start : \ucee8\ud14c\uc774\ub108 \uc2dc\uc791</li> <li>docker restart : \ucee8\ud14c\uc774\ub108 \uc7ac\uc2dc\uc791</li> <li>docker stop : \ucee8\ud14c\uc774\ub108 \uc911\uc9c0</li> <li>docker attach : \ucee8\ud14c\uc774\ub108 \ubd84\ub9ac</li> <li>docker rm {-f} : \ucee8\ud14c\uc774\ub108 \uc0ad\uc81c</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#portainer","title":"Portainer \uc124\uce58","text":"<ol> <li>docker\ub97c \uc27d\uac8c \uad00\ub9ac\ud560 \uc218 \uc788\ub294 GUI \ub3c4\uad6c\uc778 portainer\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</li> <li> <p>portainer\ub97c \uc124\uce58\ud560 \ub514\ub809\ud1a0\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>sudo mkdir -p /data/portainer\n</code></pre> </li> <li> <p>portainer\ub97c \uc2e4\ud589\ud560 \uc218 \uc788\ub3c4\ub85d docker\uc5d0 \ucee8\ud14c\uc774\ub108 \ud615\ud0dc\ub85c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p>\u2014name : {\ucee8\ud14c\uc774\ub108 \uc774\ub984}</p> <p>-p : {\ud638\uc2a4\ud2b8\ud3ec\ud2b8}:{\ub0b4\ubd80\ud3ec\ud2b8}</p> <p>-d : {\ubc31\uadf8\ub77c\uc6b4\ub4dc \ub370\ubaac}</p> <p>\u2014restart : always \u2190 \uc7ac\ubd80\ud305 \uc2dc \uc790\ub3d9 \uc2dc\uc791</p> <p>-v {\ud638\uc2a4\ud2b8-\ucee8\ud14c\uc774\ub108 \uac04 \ubcfc\ub968 \ub9e4\uce6d}</p> <p>portainer/portainer \u2190 \uc774\ubbf8\uc9c0 \uc0ac\uc6a9</p> <pre><code>sudo docker run --name portainer -p 9000:9000 -d --restart always -v /data/portainer:/data -v /var/run/docker.sock:/var/run/docker.sock portainer/portainer\n</code></pre> </li> <li> <p>\uba85\ub839\uc5d0 \ub300\ud55c \uc9c4\ud589\uc0ac\ud56d\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc6f9\ube0c\ub77c\uc6b0\uc800\ub97c \uc5f4\uace0 localhost:9000 \uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> </li> <li> <p>portainer\uc5d0 \uc815\uc0c1\uc801\uc73c\ub85c \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> <p>admin / 12345678</p> </li> <li> <p>\ub85c\uceec\uc5d0\uc11c \uc791\uc5c5\ud560 \uc218 \uc788\ub3c4\ub85d \uc124\uc815\ud569\ub2c8\ub2e4</p> <p></p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#_6","title":"\ucee8\ud14c\uc774\ub108 \uc9c1\uc811 \ub85c\ub4dc \ud574\ubcf4\uae30","text":"<ol> <li>https://hub.docker.com/ \uc5d0\uc11c \ucee8\ud14c\uc774\ub108\ub97c \uac80\uc0c9\ud569\ub2c8\ub2e4</li> <li> <p>\uc774\ubc88\uc5d0\ub294 dvwa\ub97c \uc0ac\uc6a9\ud574\ubcf4\uaca0\uc2b5\ub2c8\ub2e4. vulnerables/web \ub97c \uac80\uc0c9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uac80\uc0c9\ub41c \ud398\uc774\uc9c0\ub97c \uc77d\uc73c\uba74 \uc911\uac04\uc5d0 \uc124\uce58 \uba85\ub839\uc744 \ucc3e\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub3c4\ucee4\ub294 \ud56d\uc0c1 root \uad8c\ud55c\uc774 \ud544\uc694\ud558\ub2c8 sudo\ub97c \ubd99\uc5ec\uc11c \uba85\ub839\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>sudo docker run --rm -it -p 80:80 vulnerables/web-dvwa\n</code></pre> </li> <li> <p>\ub85c\uceec \uc2dc\uc2a4\ud15c\uc5d0\uc11c \ucee8\ud14c\uc774\ub108\ub97c \ucc3e\uc544\ubcf4\uace0 \uc5c6\uc73c\uba74 \uc54c\uc544\uc11c \ub2e4\uc6b4\ub85c\ub4dc \u2192 \ucee8\ud14c\uc774\ub108\ub85c\ub4dc \uae4c\uc9c0 \ud55c \ubc88\uc5d0 \uc2e4\ud589\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\ub978 \ud3ec\ud2b8\uc640 \uacb9\uce58\ub294 \uacbd\uc6b0 (\ud638\uc2a4\ud2b8)\ud3ec\ud2b8\ub97c \ubcc0\uacbd\ud558\uace0 \ub2e4\uc2dc \uba85\ub839\uc744 \uc2e4\ud589\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> <p>\ud3ec\ud2b8 \uc911\ubcf5 \uc5d0\ub7ec</p> <p></p> <p>\ud638\uc2a4\ud2b8\ud3ec\ud2b8 \ubcc0\uacbd \ud6c4 \uc7ac \uc2dc\ub3c4</p> </li> <li> <p>\uba85\ub839\uc5b4 \ud55c \uc904\ub85c DVWA\uac00 \uc2e4\ud589\ub418\ub294 \ub9c8\ubc95\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> <p>localhost:90</p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20compose%20web%20GUI/#yaml-compose-code","title":"YAML + Compose\ub97c \ud65c\uc6a9\ud574 Code\ub85c \uad00\ub9ac\ud558\uae30","text":"<ol> <li> <p>root \uad8c\ud55c\uc73c\ub85c docker-compose\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>sudo apt install docker-compose\n</code></pre> </li> <li> <p>YAML\ud30c\uc77c \uc791\uc131\uc744 \uc704\ud574 \ud648 \ub514\ub809\ud1a0\ub9ac\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4</p> <pre><code>cd /home/{USER}\n</code></pre> </li> <li> <p>\ucef4\ud3ec\uc988\ub97c \uc704\ud55c YAML\ud30c\uc77c\uc744 \uc0dd\uc131(\uc218\uc815)\ud569\ub2c8\ub2e4</p> <pre><code>sudo vi docker-compose.yml\n</code></pre> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \uc791\uc131\ud569\ub2c8\ub2e4. wordpress\uc640 mysql5.7 \uc774\ubbf8\uc9c0\ub97c \ub2e4\uc6b4\ubc1b\uace0 \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud560 \ub54c \uc124\uc815\uac12\ub3c4 \uac19\uc774 \ub123\uc5b4\uc90d\ub2c8\ub2e4</p> <pre><code>version: '3.1'\nservices:\nwordpress:\nimage: wordpress\nrestart: always\nports:\n- 8080:80\nenvironment:\nWORDPRESS_DB_HOST: db\nWORDPRESS_DB_USER: admin\nWORDPRESS_DB_PASSWORD: password\nWORDPRESS_DB_NAME: wordpress\nvolumes:\n- wordpress:/var/www/html\ndb:\nimage: mysql:5.7\nrestart: always\nenvironment:\nMYSQL_DATABASE: wordpress\nMYSQL_USER: admin\nMYSQL_PASSWORD: password\nMYSQL_RANDOM_ROOT_PASSWORD: '1'\nvolumes:\n- db:/var/lib/mysql\nvolumes:\nwordpress:\ndb:\n</code></pre> </li> <li> <p>docker-compose\ub97c \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>sudo docker-compose up -d\n</code></pre> </li> <li> <p>\uc6f9 \ube0c\ub77c\uc6b0\uc800\ub97c \uc5f4\uace0 \ub2e4\uc74c \uc8fc\uc18c\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4</p> <pre><code>localhost:8080\n</code></pre> </li> <li> <p>Wordpress\uc640 MySQL\uc774 \uc798 \ub3d9\uc791\ud558\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>portainer\uc5d0 \uc811\uc18d\ud558\uc5ec \uc2e4\ud589 \uc911\uc778 \ucee8\ud14c\uc774\ub108\ub97c \ud655\uc778\ud558\uba74 wordpress\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ub3d9\uc791 \uc911\uc778 \uac83\uc744 \ud655\uc778\ud574\ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uc561\uc158\uc744 \ud074\ub9ad\ud558\uba74 \ud130\ubbf8\ub110\uc5d0 \uc9c1\uc811 \uc811\uc18d\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc30\uc26c\uc178\uc744 \uc120\ud0dd\ud558\uace0 \uc5f0\uacb0\uc744 \ud074\ub9ad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>wordpress \ucee8\ud14c\uc774\ub108 \ud130\ubbf8\ub110\uc5d0 \uc811\uc18d\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/","title":"Docker volume with MySQL","text":""},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>CentOS8\uc5d0 \ub3c4\ucee4\ub97c \uc124\uce58\ud558\uace0 MySQL \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</li> <li>\ucee8\ud14c\uc774\ub108\ub97c \uc885\ub8cc\ud558\uace0 \uc678\ubd80\uc5d0\uc11c \uc811\uc18d\ud558\ub3c4\ub85d \ub2e4\uc2dc \ub85c\ub4dc\ud569\ub2c8\ub2e4</li> <li>\ucee8\ud14c\uc774\ub108\ub97c \uc0ad\uc81c\ud574\ub3c4 \uc774\uc804 \ub370\uc774\ud130\ub97c \uadf8\ub300\ub85c \uc720\uc9c0\ud558\ub294 stateful\ud55c \uc0c1\ud0dc\ub97c \uad6c\ud604\ud569\ub2c8\ub2e4</li> <li>Stateful \uc0c1\ud0dc\ub294 Volume\uc124\uc815\uc744 \ud1b5\ud574 \uad6c\ud604\ud569\ub2c8\ub2e4</li> </ul>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#docker","title":"Docker \uc124\uce58","text":"<ol> <li> <p>yum util \ud328\ud0a4\uc9c0 \uc124\uce58</p> <pre><code>yum install -y yum-utils\n</code></pre> </li> <li> <p>docker\ub97c \uc704\ud55c repo\ub97c \uc124\uc815</p> <pre><code>yum-config-manager --add-repo=https://download.docker.com/linux/centos/docker-ce.repo\n</code></pre> </li> <li> <p>docker-ce \uc124\uce58</p> <pre><code>yum install -y docker-ce </code></pre> </li> <li> <p>(\uc774\ubbf8 \uc124\uce58\ub41c \ud328\ud0a4\uc9c0 \ub584\ubb38\uc5d0)\uc124\uce58 \uc5d0\ub7ec \ubc1c\uc0dd\uc2dc allowerasing \uc635\uc158</p> <pre><code>yum install -y --allowerasing docker-ce\n</code></pre> <pre><code>dnf install --nobest --allowerasing -y docker-ce\n</code></pre> </li> <li> <p>docker\ub97c \uc2e4\ud589</p> <pre><code>systemctl start docker\n</code></pre> </li> <li> <p>docker \ubc84\uc804 \ud655\uc778</p> <pre><code>docker --version\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#mysql","title":"MySQL \ucee8\ud14c\uc774\ub108 \uc124\uce58","text":"<ol> <li> <p>MYSQL \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4. 5.7.30 \ubc84\uc804 mySQL \ucee8\ud14c\uc774\ub108\ub97c \ub2e4\uc6b4\ub85c\ub4dc\ud558\uace0 db001\uc774\ub77c\ub294 \ucee8\ud14c\uc774\ub108 \uc774\ub984\uc73c\ub85c \ub85c\ub4dc\ud558\ub294 \uba85\ub839\uc785\ub2c8\ub2e4</p> <p>-i, -t : \ucee8\ud14c\uc774\ub108\uc758 shell\uc5d0 \uc811\uc18d\ud558\uae30 \uc704\ud55c \uc635\uc158 \u2014name : \ucee8\ud14c\uc774\ub108 \uc774\ub984 -e : \ud658\uacbd\ubcc0\uc218 \uc138\ud305 -d : \ubc31\uadf8\ub77c\uc6b4\ub4dc\uc5d0\uc11c \ucee8\ud14c\uc774\ub108 \uc2e4\ud589</p> <pre><code>docker run -i -t --name db001 -e MYSQL_ROOT_PASSWORD=\"root\" -d percona:5.7.30\n</code></pre> <p>\uc544\ub798 \uc2a4\ud06c\ub9b0\uc0f7 \ucc98\ub7fc \uc6b0\uc120 \ub85c\uceec\uc5d0\uc11c \ucee8\ud14c\uc774\ub108\ub97c \ucc3e\uc544\ubcf4\uace0 \uc5c6\uc73c\uba74 \ub3c4\ucee4\ud5c8\ube0c\uc5d0\uc11c \uc54c\uc544\uc11c \ucc3e\uace0 \ub2e4\uc6b4\ub85c\ub4dc\ud558\uc5ec \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc73c\ub85c \ud604\uc7ac \uc2e4\ud589\uc911\uc778 \ucee8\ud14c\uc774\ub108\uc5d0 MySQL\uc774 \uc874\uc7ac\ud558\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>docker ps\n</code></pre> <p></p> </li> <li> <p>db001\ucee8\ud14c\uc774\ub108\uc5d0 /bin/bash \uc178\uc744 \ud1b5\ud574 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it db001 /bin/bash\n</code></pre> <p></p> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uc5d0 \uc811\uc18d\ub418\uc5c8\uc73c\uba74 MySQL\uc5d0 \uc811\uc18d\ud558\uace0 \ub370\uc774\ud130\ubca0\uc774\uc2a4 \ubaa9\ub85d\uc744 \ud638\ucd9c\ud569\ub2c8\ub2e4</p> <pre><code>mysql -uroot -p\n</code></pre> <pre><code>show databases;\n</code></pre> <p></p> </li> <li> <p>\ub2e4\uc74c \uc2e4\uc2b5\uc744 \uc704\ud574 \ucee8\ud14c\uc774\ub108\ub97c \uc911\uc9c0 \ud6c4 \uc0ad\uc81c\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db001\ndocker rm db001\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#mysql_1","title":"\uc678\ubd80\uc5d0\uc11c MySQL \ucee8\ud14c\uc774\ub108 \uc811\uc18d","text":"<ol> <li> <p>\ud638\uc2a4\ud2b8\uc5d0 MySQL \ud074\ub77c\uc774\uc5b8\ud2b8\ub97c \uc124\uce58\ud569\ub2c8\ub2e4</p> <pre><code>dnf -y install mysql\n</code></pre> </li> <li> <p>\uc678\ubd80\uc5d0\uc11c \ucee8\ud14c\uc774\ub108\ub97c \uc811\uc18d\ud558\ub824\uba74 \uc811\uc18d\ud3ec\ud2b8\uc640 \ucee8\ud14c\uc774\ub108\ud3ec\ud2b8, \ub3c4\ucee4 \ud638\uc2a4\ud2b8 IP\uac00 \ud544\uc694\ud569\ub2c8\ub2e4</p> </li> <li> <p>\ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud560 \ub54c \ud3ec\ud2b8\ub97c \ub9e4\uce6d\ud574\uc90d\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db001 -p 3306:3306 -e MYSQL_ROOT_PASSWORD=\"root\" -d percona:5.7.30\n</code></pre> </li> <li> <p>docker ps\ub97c \uc774\uc6a9\ud574 \ub3d9\uc791\uc911\uc778 \ucee8\ud14c\uc774\ub108 \ubaa9\ub85d\uc744 \ud655\uc778\ud558\uba74 \uc774\ubc88\uc5d4 \ud3ec\ud2b8\uac00 \uc5f0\uacb0\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub3c4\ucee4 \ud638\uc2a4\ud2b8 IP\ub97c \ud30c\ub77c\ubbf8\ud130\uc5d0 \uc804\ub2ec\ud558\uc5ec MySQL\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>mysql -uroot -p -h {HOST IP}\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \uc678\ubd80\uc5d0\uc11c DB \uc811\uc18d\uc744 \uc131\uacf5\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uc2e4\uc2b5\uc744 \uc704\ud574 \ucee8\ud14c\uc774\ub108\ub97c \uc911\uc9c0 \ud6c4 \uc0ad\uc81c\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db001\ndocker rm db001\n</code></pre> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#stateful-volume","title":"Stateful \uad6c\ud604\uc744 \uc704\ud55c Volume \uc124\uc815","text":"<ol> <li> <p>\ub3c4\ucee4 \ud638\uc2a4\ud2b8\uc5d0 \ub370\uc774\ud130 \uc800\uc7a5\uc744 \uc704\ud55c \ub514\ub809\ud130\ub9ac \uc0dd\uc131</p> <pre><code>mkdir -p /db/db001/data\n</code></pre> </li> <li> <p>\uc791\uc5c5\uc774 \uac00\ub2a5\ud558\ub3c4\ub85d \ub514\ub809\ud130\ub9ac\uc5d0 \uad8c\ud55c \ubd80\uc5ec</p> <pre><code>chmod 777 /db /db/db001 /db/db001/data\n</code></pre> </li> <li> <p>\ubcfc\ub968 \uc635\uc158\uc744 \ucd94\uac00\ud558\uc5ec \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <p>\uc774\ub294 \ub370\uc774\ud130 \uc800\uc7a5\uc744 \uc704\ud574 \uc0dd\uc131\ud588\ub358 \ub514\ub809\ud130\ub9ac\uc640 \ucee8\ud14c\uc774\ub108\uc758 \ub514\ub809\ud130\ub9ac\uac00 \uacf5\uc720\ub418\ub3c4\ub85d \uc124\uc815(\ub9e4\ud551)\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db001 -p 3306:3306 -v /db/db001/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=\"root\" -d percona:5.7.30\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108 \ub85c\ub4dc \ud6c4 \ub370\uc774\ud130 \uc800\uc7a5\uc6a9 \ub514\ub809\ud130\ub9ac\ub85c \uc774\ub3d9\ud558\uba74 \ud30c\uc77c\uc774 \uc0dd\uc131\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>cd /db/db001/data\n</code></pre> <p></p> <p>MAGIC</p> </li> <li> <p>stateful \uad6c\ud604 \ud14c\uc2a4\ud2b8\ub97c \uc704\ud55c \ub370\uc774\ud130\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>create database test default character set=utf8;\nuse test;\ncreate table tt(num int);\ninsert into tt values(1), (2), (3);\nselect * from tt;\n</code></pre> <p></p> </li> <li> <p>Stateful \ud14c\uc2a4\ud2b8\ub97c \uc704\ud574 \ucee8\ud14c\uc774\ub108\ub97c \uc0ad\uc81c\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db001\ndocker rm db001\n</code></pre> </li> <li> <p>\ucee8\ud14c\uc774\ub108\ub97c \ub2e4\uc2dc \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db001 -p 3306:3306 -v /db/db001/data:/var/lib/mysql -e MYSQL_ROOT_PASSWORD=\"root\" -d percona:5.7.30\n</code></pre> </li> <li> <p>\uad6c\ub3d9\ub41c \ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc544\uae4c \uc791\uc131\ud588\ub358 \ud14c\uc774\ube14\uc774 \uc0b4\uc544\uc788\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>Stateful \uad6c\ud604\uc5d0 \uc131\uacf5\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub370\uc774\ud130\ubfd0\ub9cc \uc544\ub2c8\ub77c \ub85c\uadf8, \uc124\uc815\ud30c\uc77c \ub4f1\uc5d0 \uc751\uc6a9\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>\ub2e4\uc2dc \ucee8\ud14c\uc774\ub108\ub97c \uc81c\uac70\ud569\ub2c8\ub2e4</p> <pre><code>docker stop db001\ndocker rm db001\n</code></pre> </li> <li> <p>\ub85c\uadf8\uc640 \uc124\uc815\uc744 \uc704\ud55c \ub514\ub809\ud1a0\ub9ac\ub97c \uc0dd\uc131\ud558\uace0 \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>mkdir -p /db/db001/log /db/db001/conf\nchmod 777 /db/db001/log /db/db001/conf\n</code></pre> </li> <li> <p>/db/db001/conf \ub514\ub809\ud130\ub9ac\uc5d0 644 \ud37c\ubbf8\uc158\uc744 \uac00\uc9c0\ub294 cnf \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <ul> <li> <p>my.cnf</p> <p>server-id\uc640 report_host \uac12\uc740 \uc720\ub2c8\ud06c\ud55c \ud2b9\uc131(\uace0\uc720\uac12)\uc744 \uac00\uc838\uc57c\ud569\ub2c8\ub2e4</p> </li> </ul> <pre><code>[mysqld]\nlog_bin                     = mysql-bin\nbinlog_format               = ROW\ngtid_mode                   = ON\nenforce-gtid-consistency    = true\nserver-id                   = 100\nlog_slave_updates\ndatadir                     = /var/lib/mysql\nsocket                      = /var/lib/mysql/mysql.sock\n\n# Disabling symbolic-links is recommended to prevent assorted security risks\nsymbolic-links              = 0\n\nlog-error                   = /var/log/mysql/mysqld.log\npid-file                    = /var/run/mysqld/mysqld.pid\n\nreport_host                 = db001\n\n[mysqld_safe]\npid-file                    = /var/run/mysqld/mysqld.pid\nsocket                      = /var/lib/mysql/mysql.sock\nnice                        = 0\n</code></pre> <p>my.cnf</p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc73c\ub85c \ub370\uc774\ud130, \ub85c\uadf8, \uc124\uc815\ud30c\uc77c\uc774 \ubaa8\ub450 \ub9e4\ud551\ub41c \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db001 -p 3306:3306 -v /db/db001/data:/var/lib/mysql -v /db/db001/log:/var/log/mysql -v /db/db001/conf:/etc/percona-server.conf.d -e MYSQL_ROOT_PASSWORD=\"root\" -d percona:5.7.30\n</code></pre> </li> <li> <p>\ub85c\uadf8\ud3f4\ub354\uc5d0 \ub4e4\uc5b4\uac00\ubcf4\uba74 \ub85c\uadf8\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ubcf4\uc774\ub294 \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>cd /db/db001/log\n</code></pre> <p></p> </li> </ol>"},{"location":"Docker%20%26%20Kubernetes/Docker%20volume%20with%20MySQL/#_2","title":"\ub9c1\ud06c","text":"<ul> <li> <p>percona \uc774\ubbf8\uc9c0 \uc815\ubcf4\ub294 \ub2e4\uc74c \uc8fc\uc18c\uc5d0\uc11c \uadf8 \ub0b4\uc6a9\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p>https://github.com/percona/percona-docker/blob/master/percona-server-5.7/Dockerfile</p> </li> </ul>"},{"location":"Memozzang/AWS%20Boto3%20SDK%20%EB%AA%A8%EB%91%A0/","title":"AWS Boto3 SDK \ubaa8\ub460","text":"<ol> <li>\uc778\uc2a4\ud134\uc2a4 \ud0c0\uc785 \ubcc0\uacbd     changeInstanceType.py<pre><code>##############################################\nTARGET_INSTANCE_IDs = [\"i-0351fd54bd47a17db\"]\nTARGET_INSTANCE_TYPE = \"t2.nano\"\n##############################################\nimport boto3\nec2 = boto3.client(\"ec2\")\ndef stopInstance(instanceID):\ntry:\nec2.stop_instances(InstanceIds=[instanceID])\nprint(f\"trying to STOP INSTANCE {instanceID}...\", end=\"\")\nwaiter = ec2.get_waiter(\"instance_stopped\")\nwaiter.wait(InstanceIds=[instanceID])\nprint(f\"SUCCESS\")\nreturn True  # \uc778\uc2a4\ud134\uc2a4 \uc815\uc9c0 \uc131\uacf5\nexcept:\nprint(f\"FAILED : STOP INSTANCE {instanceID}\")\nreturn False\ndef modifyInstance(instanceID):\ntry:\nec2.modify_instance_attribute(\nInstanceId=instanceID, Attribute=\"instanceType\", Value=TARGET_INSTANCE_TYPE\n)\nprint(f\"SUCCESS : {instanceID} INSTANCE CHANGED TO {TARGET_INSTANCE_TYPE}\")\nexcept:\nprint(f\"FAILED : CHANGE {instanceID} INSTANCE TYPE\")\ndef startInstance(instanceID):\ntry:\nec2.start_instances(InstanceIds=[instanceID])\nprint(f\"SUCCESS : RESTART {instanceID}\")\nexcept:\nprint(f\"FAILED : START INSTANCE {instanceID}\")\ndef main():\nfor instanceID in TARGET_INSTANCE_IDs:\nisStop = stopInstance(instanceID)  # isStop\ub294 \uc778\uc2a4\ud134\uc2a4 \uc815\uc9c0 \uc131\uacf5 \uc720\ubb34 \ud45c\uc2dc\uc6a9\nif isStop:\nmodifyInstance(instanceID)\nstartInstance(instanceID)\nmain()\n</code></pre></li> </ol>"},{"location":"Memozzang/AWS%20CLI%20%EB%AA%A8%EB%91%A0/","title":"AWS CLI \ubaa8\ub460","text":""},{"location":"Memozzang/AWS%20CLI%20%EB%AA%A8%EB%91%A0/#ec2","title":"EC2","text":""},{"location":"Memozzang/AWS%20CLI%20%EB%AA%A8%EB%91%A0/#instances","title":"Instances","text":"<ol> <li> <p><code>Running</code> \uc0c1\ud0dc\uc778 \uc778\uc2a4\ud134\uc2a4\ub4e4\uc758 \uc778\uc2a4\ud134\uc2a4 ID\ub9cc \ucc3e\uae30     <pre><code>aws ec2 describe-instances \\\n--filters Name=instance-state-name,Values=running \\\n--query \"Reservations[*].Instances[*].InstanceId\" --output text\n</code></pre></p> </li> <li> <p>\uc778\uc2a4\ud134\uc2a4 Name\uc5d0 'db'\uac00 \ub4e4\uc5b4\uac00\ub294 \uc778\uc2a4\ud134\uc2a4\uc758 Volume Size \ucc3e\uae30     <pre><code>aws ec2 describe-instances \\\n--filters Name=tag:Name,Values=\"*db*\" \\\n--query \"Reservations[*].Instances[*].BlockDeviceMappings[*].Ebs.VolumeId\" --output json \\\n| jq '.[][][]' \\\n| xargs -I{} aws ec2 --region ap-southeast-1 describe-volumes --filters Name=volume-id,Values={} --query \"Volumes[*].Size\" \\\n| jq '.[]'\n</code></pre></p> </li> </ol>"},{"location":"Memozzang/AWS%20CLI%20%EB%AA%A8%EB%91%A0/#image-and-snapshots","title":"Image and snapshots","text":"<ol> <li> <p>2022-01-01 ~ 2022-12-31 \uae30\uac04\uc5d0 \uc0dd\uc131\ub41c EBS Volume snapshot \ucc3e\uae30     <pre><code>aws ec2 describe-snapshots \\\n--filters Name=owner-id,Values=123456789012 \\\n--query \"Snapshots[?(StartTime&gt;='2022-01-01') &amp;&amp; (StartTime&lt;='2022-12-31')].[SnapshotId]\" --output text\n</code></pre></p> </li> <li> <p>\ud0c0 \uacc4\uc815\uc5d0 \uacf5\uc720\ub41c EBS Snapshot\uc911 \ubcfc\ub968 \uc0dd\uc131 \uad8c\ud55c\ub3c4 \uacf5\uc720\ub41c Snapshot \ucc3e\uae30     <pre><code>aws ec2 describe-snapshots --owner-ids 12345678 --region ap-northeast-2 \\\n| awk -F '\"' '/SnapshotId/ {print $4}' \\\n| xargs -I{} aws ec2 describe-snapshot-attribute --attribute createVolumePermission --snapshot-id {} --region ap-northeast-2 \\\n| grep -vF '\"CreateVolumePermissions\": []'\n</code></pre></p> </li> <li> <p>\ud0c0 \uacc4\uc815\uc5d0 \uacf5\uc720\ub41c AMI Image\uc911 \ud0c0 \uacc4\uc815\uc5d0\uc11c \uc778\uc2a4\ud134\uc2a4 \uc2e4\ud589 \uad8c\ud55c\uc744 \uac00\uc9c0\uace0 \uc788\ub294 Image\ub9cc \ucc3e\uae30     <pre><code>aws ec2 describe-images --owners 12345678 --region ap-southeast-1 \\\n| awk -F '\"'  '/ImageId/ {print $4}' \\\n| xargs -I{} aws ec2 describe-image-attribute --attribute launchPermission --image-id {} --region ap-southeast-1 \\\n| grep -vF '\"LaunchPermissions\": []'\n</code></pre></p> </li> <li> <p>\ud604\uc7ac attached\ub41c(in-use\uc0c1\ud0dc\uc778) EBS Volume\ub4e4\uc758 Size \ubcf4\uae30     <pre><code>aws ec2 --region ap-southeast-1 describe-volumes \\\n--filters Name=attachment.status,Values=attached \\\n--query \"Volumes[*].Size\" \\\n| grep -E \"[0-9]\" |  sed -e 's/^[ \\t]*//'\n</code></pre></p> </li> <li> <p>AMI Image\uc774\ub984 \uc911 'DLM'\uc774 \uc874\uc7ac\ud558\ub294 Image ID\uc640 SnapshotID \ucc3e\uae30     <pre><code>aws ec2 describe-images --region ap-northeast-2 --owners 12345678 \\\n--query \"Images[?contains(Name, 'DLM')].{Id:ImageId,EBS:BlockDeviceMappings}\" \\\n| grep -E 'Id|SnapshotId'\n</code></pre></p> </li> </ol>"},{"location":"Memozzang/AWS%20CLI%20%EB%AA%A8%EB%91%A0/#s3","title":"S3","text":"<ol> <li>`~/test/ \ub514\ub809\ud130\ub9ac\uc758 \ubaa8\ub4e0 txt\ud30c\uc77c\uc744 s3://my-bucket/test/ \uc5d0 \uc5c5\ub85c\ub4dc \ud558\uae30     <pre><code>aws s3 cp ~/test/ s3://my-bucket/test/ --recursive --exclude \"*\" --include \"*.txt\"\n</code></pre></li> </ol>"},{"location":"Memozzang/AWS%20Codedeploy%20install/","title":"AWS Codedeploy install","text":"<pre><code>sudo apt update &amp;&amp; sudo apt install -y ruby-full wget\ncd ~/work\nwget https://aws-codedeploy-cn-north-1.s3.cn-north-1.amazonaws.com.cn/latest/install\nchmod +x ./install sudo ./install auto\nrm -rf ~/work/install\nsudo systemctl stop codedeploy-agent\nsudo sh -c \"cat&lt;&lt;EOF &gt; /etc/codedeploy-agent/conf/codedeployagent.yml\n---\n:log_aws_wire: false\n:log_dir: '/var/log/aws/codedeploy-agent/'\n:pid_dir: '/opt/codedeploy-agent/state/.pid/'\n:program_name: codedeploy-agent\n:root_dir: '/opt/codedeploy-agent/deployment-root'\n:verbose: false\n:wait_between_runs: 1\n:proxy_uri:\n:max_revisions: 2\n:enable_auth_policy: true\nEOF\"\nsudo systemctl restart codedeploy-agent.service\nwget https://aws-codedeploy-ap-northeast-2.s3.ap-northeast-2.amazonaws.com/latest/install\n</code></pre>"},{"location":"Memozzang/JupyterLab/","title":"JupyterLab","text":"Dockerfile<pre><code>FROM jupyter/datascience-notebook:latest\n# Declare root as user\nUSER root\n# Update Ubuntu\nRUN sed -i 's/archive.ubuntu.com/mirror.kakao.com/g' /etc/apt/sources.list &amp;&amp; sed -i 's/security.ubuntu.com/mirror.kakao.com/g' /etc/apt/sources.list\n# Install Nanum for Korean Font\nRUN apt-get update &amp;&amp; apt-get -y upgrade &amp;&amp; apt-get install -y fonts-nanum* &amp;&amp; fc-cache -fv &amp;&amp; rm -fr ~/.cache/matplotlib\n</code></pre> docker-compose.yml<pre><code>version: '3'\nservices:\njupyter-notebook:\nbuild:\ncontext: .\ndockerfile: ./Dockerfile\nuser: root\nenvironment:\n- GRANT_SUDO=yes\n- JUPYTER_ENABLE_LAB=yes\n- JUPYTER_TOKEN=papapassword\nvolumes:\n- /home/ubuntu/ds/data:/home/jovyan/data\nports:\n- \"8888:8888\"\ncontainer_name: \"jupyter-notebook\"\nrestart: always\n</code></pre>"},{"location":"Memozzang/Lunix%20command%20%EB%AA%A8%EC%9D%8C/","title":"Lunix command \ubaa8\uc74c","text":""},{"location":"Memozzang/Lunix%20command%20%EB%AA%A8%EC%9D%8C/#tar","title":"tar","text":"<ol> <li>23-01-01 ~ 23-01-13 \uc0ac\uc774\uc5d0 \uc0dd\uc131\ub41c \ud30c\uc77c tar \uc555\ucd95\ud558\uae30     <pre><code>sudo find ./ -name \"*dump*\" -type f -newerat 2023-01-01 ! -newerat 2023-02-01 -exec tar rf 202301.tar {} \\;```\n</code></pre></li> </ol>"},{"location":"Memozzang/Naver%20cloud%20API%ED%98%B8%EC%B6%9C%20%EB%AA%A8%EB%91%A0/","title":"Naver cloud API\ud638\ucd9c \ubaa8\ub460","text":"<ol> <li> <p>\uc778\uc2a4\ud134\uc2a4 \ub9ac\uc2a4\ud2b8 \ud655\uc778     API_instanceList.py<pre><code>import requests\nimport hashlib\nimport hmac\nimport base64\nimport requests\nimport time\nimport xmltodict\n######################################################\nACCESS_KEY = \"********************\"\nSECRET_KEY = \"********************\"\n######################################################\nmethod = \"GET\"\nurl = \"https://ncloud.apigw.ntruss.com\"\nuri = \"/vserver/v2/getServerInstanceList\"\ntime_stamp = str(int(time.time() * 1000))\ndef makeSignature():\nsecret_key = bytes(SECRET_KEY, \"UTF-8\")\nmessage = method + \" \" + uri + \"\\n\" + time_stamp + \"\\n\" + ACCESS_KEY\nmessage = bytes(message, \"UTF-8\")\nsignKey = base64.b64encode(\nhmac.new(secret_key, message, digestmod=hashlib.sha256).digest()\n)\nreturn signKey\ndef main():\nsignKey = makeSignature()\nheaders = {\n\"x-ncp-iam-access-key\": ACCESS_KEY,\n\"x-ncp-apigw-timestamp\": time_stamp,\n\"x-ncp-apigw-signature-v2\": signKey,\n}\nr = requests.get(url + uri, headers=headers)\nreturnCode = r.status_code\nif returnCode == 200:\ndata = r.text\ndata = xmltodict.parse(data)\ndata = data[\"getServerInstanceListResponse\"][\"serverInstanceList\"][\n\"serverInstance\"\n]\nprint(\"----------------------\uc11c\ubc84 \ubaa9\ub85d--------------------------\")\nprint(\"  \uc11c\ubc84\uc774\ub984\\t\\t \uc778\uc2a4\ud134\uc2a4ID\\t   \uc0c1\ud0dc\\t\\t\ud37c\ube14\ub9adIP\")\nfor i in data:\nprint(\nf'{i[\"serverName\"].ljust(20)}\\t  {i[\"serverInstanceNo\"]}\\t  {i[\"serverInstanceStatusName\"]}\\t  {i[\"publicIp\"]}'\n)\nprint(\"--------------------------------------------------------\")\nelse:\nprint(f\"Error Code: {returnCode} / {r.text}\")\nmain()\n</code></pre></p> </li> <li> <p>\uc778\uc2a4\ud134\uc2a4 \ucf1c\uae30     API_startInstance.py<pre><code>import requests\nimport hashlib\nimport hmac\nimport base64\nimport requests\nimport time\nimport json\n######################################################\nACCESS_KEY = \"********************\"\nSECRET_KEY = \"********************\"\nTARGET_INSTANCE_IDs = [\"6768447\"]\n######################################################\nmethod = \"GET\"\nurl = \"https://ncloud.apigw.ntruss.com\"\nuri = \"/vserver/v2/startServerInstances?responseFormatType=json\"\nfor num, ID in enumerate(TARGET_INSTANCE_IDs):\nuri = f\"{uri}&amp;serverInstanceNoList.{num+1}={ID}\"\ntime_stamp = str(int(time.time() * 1000))\ndef makeSignature():\nsecret_key = bytes(SECRET_KEY, \"UTF-8\")\nmessage = method + \" \" + uri + \"\\n\" + time_stamp + \"\\n\" + ACCESS_KEY\nmessage = bytes(message, \"UTF-8\")\nsignKey = base64.b64encode(\nhmac.new(secret_key, message, digestmod=hashlib.sha256).digest()\n)\nreturn signKey\ndef main():\n# print(f\"REQUEST {url + uri}\")\nsignKey = makeSignature()\nheaders = {\n\"x-ncp-iam-access-key\": ACCESS_KEY,\n\"x-ncp-apigw-timestamp\": time_stamp,\n\"x-ncp-apigw-signature-v2\": signKey,\n}\nr = requests.get(url + uri, headers=headers)\nreturnCode = r.status_code\nif returnCode == 200:\ndata = json.loads(r.text)\ndata = data[\"startServerInstancesResponse\"][\"returnMessage\"]\nprint(f\"START REQUEST : {data}\")\nelse:\nprint(f\"Error Code: {returnCode} / {r.text}\")\nmain()\n</code></pre></p> </li> <li>Target Group\uc5d0 \ub4f1\ub85d\ud558\uae30     API_appendInstanceToTG.py<pre><code>import requests\nimport hashlib\nimport hmac\nimport base64\nimport requests\nimport time\nimport json\n######################################################\nACCESS_KEY = \"********************\"\nSECRET_KEY = \"********************\"\nTARGET_GROUP_NO = \"64385\"\nTARGET_INSTANCE_IDs = [\"6799106\"]\n######################################################\nmethod = \"GET\"\nurl = \"https://ncloud.apigw.ntruss.com\"\nuri = \"/vloadbalancer/v2/addTarget?responseFormatType=json\"\nuri = f\"{uri}&amp;targetGroupNo={TARGET_GROUP_NO}\"\nfor num, ID in enumerate(TARGET_INSTANCE_IDs):\nuri = f\"{uri}&amp;targetNoList.{num+1}={ID}\"\ntime_stamp = str(int(time.time() * 1000))\ndef makeSignature():\nsecret_key = bytes(SECRET_KEY, \"UTF-8\")\nmessage = method + \" \" + uri + \"\\n\" + time_stamp + \"\\n\" + ACCESS_KEY\nmessage = bytes(message, \"UTF-8\")\nsignKey = base64.b64encode(\nhmac.new(secret_key, message, digestmod=hashlib.sha256).digest()\n)\nreturn signKey\ndef main():\n# print(f\"REQUEST {url + uri}\")\nsignKey = makeSignature()\nheaders = {\n\"x-ncp-iam-access-key\": ACCESS_KEY,\n\"x-ncp-apigw-timestamp\": time_stamp,\n\"x-ncp-apigw-signature-v2\": signKey,\n}\nprint(url + uri)\nr = requests.get(url + uri, headers=headers)\nreturnCode = r.status_code\nif returnCode == 200:\ndata = json.loads(r.text)\nprint(data[\"addTargetResponse\"][\"returnMessage\"])\nelse:\nprint(f\"HTTP Error Code: {returnCode} / {r.text}\")\nmain()\n</code></pre></li> <li>Target Group \ud604\uc7ac \ub300\uc0c1 \uc870\ud68c     <pre><code>import requests\nimport hashlib\nimport hmac\nimport base64\nimport requests\nimport time\nimport json\n######################################################\nACCESS_KEY = \"********************\"\nSECRET_KEY = \"********************\"\nTARGET_GROUP_NO = \"64385\"\n######################################################\nmethod = \"GET\"\nurl = \"https://ncloud.apigw.ntruss.com\"\nuri = \"/vloadbalancer/v2/getTargetGroupDetail?responseFormatType=json\"\nuri = f\"{uri}&amp;targetGroupNo={TARGET_GROUP_NO}\"\ntime_stamp = str(int(time.time() * 1000))\ndef makeSignature():\nsecret_key = bytes(SECRET_KEY, \"UTF-8\")\nmessage = method + \" \" + uri + \"\\n\" + time_stamp + \"\\n\" + ACCESS_KEY\nmessage = bytes(message, \"UTF-8\")\nsignKey = base64.b64encode(\nhmac.new(secret_key, message, digestmod=hashlib.sha256).digest()\n)\nreturn signKey\ndef main():\n# print(f\"REQUEST {url + uri}\")\nsignKey = makeSignature()\nheaders = {\n\"x-ncp-iam-access-key\": ACCESS_KEY,\n\"x-ncp-apigw-timestamp\": time_stamp,\n\"x-ncp-apigw-signature-v2\": signKey,\n}\nprint(url + uri)\nr = requests.get(url + uri, headers=headers)\nreturnCode = r.status_code\nif returnCode == 200:\ndata = json.loads(r.text)\nprint(\ndata[\"getTargetGroupDetailResponse\"][\"targetGroupList\"][0][\"targetNoList\"]\n)\nelse:\nprint(f\"HTTP Error Code: {returnCode} / {r.text}\")\nmain()\n</code></pre></li> </ol>"},{"location":"Memozzang/Nextcloud/","title":"Nextcloud","text":"docker-compose.yml<pre><code>version: '2'\nvolumes:\nnextcloud-app-volume:\nnextcloud-db-volume:\nnetworks:\nnextcloud-network:\ndriver: bridge\nservices:\nnextcloud-mariadb:\nimage: mariadb\ncommand: --transaction-isolation=READ-COMMITTED --binlog-format=ROW\nrestart: always\nports:\n- 3306:3306\nvolumes:\n- nextcloud-db-volume:/var/lib/mysql\nenvironment:\n- MYSQL_ROOT_PASSWORD=rororoot\n- MYSQL_PASSWORD=dbpassword1234\n- MYSQL_DATABASE=dbdbdb\n- MYSQL_USER=usususer\nnetworks:\n- nextcloud-network\nnextcloud-app:\nimage: nextcloud\nports:\n- 8080:80\nlinks:\n- nextcloud-mariadb\nvolumes:\n- nextcloud-app-volume:/var/www/html\nrestart: always\nnetworks:\n- nextcloud-network\n</code></pre>"},{"location":"Projects/Project-1/","title":"Project - 1","text":"<p>Tip</p> <p>\ud83d\udca1 \uc720\ud615 : \uac1c\uc778 \ud1a0\uc774 \ud504\ub85c\uc81d\ud2b8</p>"},{"location":"Projects/Project-1/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>\uc5ec\ud0dc \ud559\uc2b5\ud574\uc654\ub358 \uac01\uc885 \uae30\uc220\ub4e4\uc744 \uc2e4\uc81c\ub85c \ud65c\uc6a9\ud574\ubcf8 \uacbd\ud5d8\uc744 \uac00\uc838\ubcf4\uace0 \ubb38\uc81c\ud574\uacb0 \ub2a5\ub825\uc744 \ud0a4\uc6b0\uae30 \uc704\ud574 \uc2e4\uc81c \uc6b4\uc601\uc774 \uac00\ub2a5\ud55c \uc778\ud504\ub77c\ub97c \uad6c\ucd95\ud574\ubcf4\uace0 \uc2f6\uc5c8\uc2b5\ub2c8\ub2e4</li> </ul>"},{"location":"Projects/Project-1/#_2","title":"\uc11c\ube44\uc2a4 \uc694\uc57d","text":"<ul> <li>\uc778\ub825\ud480\uc5d0 \uc9c0\uc6d0\uc790\ub97c \ub4f1\ub85d\ud560 \uc218 \uc788\ub294 \uac04\ub2e8\ud55c \uc11c\ube44\uc2a4\ub97c \ub3c4\ucee4\ub97c \ud65c\uc6a9\ud55c \uba40\ud2f0\ucee8\ud14c\uc774\ub108 \uc778\ud504\ub77c\ub97c \uc801\uc6a9\ud558\uc5ec \uad6c\uc131\ud558\uc600\uc2b5\ub2c8\ub2e4</li> </ul>"},{"location":"Projects/Project-1/#_3","title":"\uad6c\uc131\ub3c4","text":"<ul> <li> <p>Service Flow</p> <p></p> </li> <li> <p>DEV Flow</p> <p></p> </li> <li> <p>AWS \uc778\ud504\ub77c \uad6c\uc131\ub3c4</p> <p></p> </li> </ul>"},{"location":"Projects/Project-1/#_4","title":"\uac01 \uae30\uc220\ub4e4\uc758 \uc120\ud0dd \uc774\uc720","text":"<ul> <li>\ubcf8 \ud504\ub85c\uc81d\ud2b8\ub294 \uc11c\ube44\uc2a4\uac00 \uc6d0\ud65c\ud558\uac8c \ub3d9\uc791\ud560 \uc218 \uc788\ub294 \uc778\ud504\ub77c\ub97c \uad6c\uc131\ud558\ub294\ub370 \uc911\uc810\uc744 \ub450\uace0\uc788\uc2b5\ub2c8\ub2e4. \ud504\ub85c\uadf8\ub798\ubc0d\uc744 \ucd5c\uc18c\ud654 \ud558\uae30 \uc704\ud574 \uc798 \ub2e4\ub8f0 \uc218 \uc788\ub294 \uc5b8\uc5b4\uc778 Python\uc744 \uc0ac\uc6a9\ud558\uace0,  \ube60\ub974\uac8c \uc6f9 \uc11c\ube44\uc2a4\ub97c \uad6c\ub3d9\ud560 \uc218 \uc788\ub294 Flask \ud504\ub808\uc784\uc6cc\ud06c\ub97c \uc774\uc6a9\ud588\uc2b5\ub2c8\ub2e4.</li> <li>CICD \uc194\ub8e8\uc158\uc73c\ub85c Cloudbase + public repository \ubb34\ub8cc + multi container \uc0ac\uc6a9\uac00\ub2a5 \uc870\uac74\uc744 \ub9de\ucdb0\uc904 \uc218 \uc788\ub294 Travis CI\ub97c \ucc44\ud0dd\ud558\uc600\uc2b5\ub2c8\ub2e4 https://djangostars.com/blog/continuous-integration-circleci-vs-travisci-vs-jenkins/</li> <li>Apache\uc640 Nginx\uc911 \ube44\ub3d9\uae30\ub97c \uc774\uc6a9\ud574 \ub9ce\uc740 \ub3d9\uc2dc\uc811\uc18d \ud2b8\ub798\ud53d\uc774 \uc218\uc6a9\uac00\ub2a5\ud55c Nginx\ub97c \uc120\ud0dd\ud558\uc600\uc2b5\ub2c8\ub2e4 https://kinsta.com/blog/nginx-vs-apache/</li> <li> <p>Flask\uc758 \uae30\ubcf8 \ub0b4\uc7a5\uc11c\ubc84\ub294 \ub300\uc6a9\ub7c9\ucc98\ub9ac\uc5d0 \ubd80\uc801\ud569\ud558\uae30 \ub54c\ubb38\uc5d0 WSGI\ub97c \uc801\uc6a9\ud588\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>WSGI\uad6c\ud604\uc5d0 gunicorn\uc744 \uc0ac\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4</p> </li> <li>DB\uc0dd\uc131 \ud6c4 \uc2a4\ud0a4\ub9c8\ub97c \ubcc0\uacbd\ud560 \uc77c\uc774 \uc5c6\uae30 \ub584\ubb38\uc5d0 SQL\uc744 \uc0ac\uc6a9\ud558\ub294\ub370, \ucd94\ud6c4 RDS\ub85c \ub9c8\uc774\uadf8\ub808\uc774\uc158\ub3c4 \uac00\ub2a5\ud55c MySQL\uc744 \uc0ac\uc6a9\ud558\uc600\uc2b5\ub2c8\ub2e4</li> <li>\uba40\ud2f0\ucee8\ud14c\uc774\ub108\uc6a9 Beanstalk\ubcf4\ub2e8 \ucd94\ud6c4 \ucee4\uc2a4\ud140\uc774 \uc790\uc720\ub85c\uc6b4 EC2 \uc11c\ube44\uc2a4\ub97c \uc120\ud0dd\ud558\uc600\uc2b5\ub2c8\ub2e4</li> <li>fault tolerance\uc54c\uace0\ub9ac\uc998\uc744 \uc704\ud574 EC2 \uc778\uc2a4\ud134\uc2a4 \uc218\ub294 \ud640\uc218\ub85c \uad6c\uc131\ud558\uc600\uc2b5\ub2c8\ub2e4 https://docs.docker.com/engine/swarm/admin_guide/</li> </ul>"},{"location":"Projects/Project-1/#_5","title":"\uc5d0\ub7ec \uc218\uc815 \uae30\ub85d","text":"<ul> <li>Docker\uc5d0\uc11c Flask \uc11c\ubc84\ub97c \ub744\uc6b8 \ub54c Host\uc8fc\uc18c\ub294 0.0.0.0</li> <li>wsgi\uc6a9 \ud30c\uc774\uc36c \ud30c\uc77c\uc744 \ubcc4\ub3c4\ub85c \ubd84\ub9ac\ud558\uace0 \ud3ec\ud2b8 \ud560\ub2f9\ud558\uae30</li> <li>\ucd5c\uc2e0 uWSGI\ub294 musl\uc744 \uc0ac\uc6a9\ud558\uae30 \ub54c\ubb38\uc5d0 https://stackoverflow.com/questions/36217250/cannot-install-uwsgi-on-alpine https://github.com/gliderlabs/docker-alpine/issues/158 RUN apk add python3-dev build-base linux-headers pcre-dev \uba85\ub839\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4</li> <li>\uc774\uc720\uc5c6\uc774 \ubb54\uac00 \uc798 \uc548\ub418\uba74 \uc77c\ub2e8 YAML \ub744\uc5b4\uc4f0\uae30\ubd80\ud130 \ud655\uc778</li> <li>Nginx \ub77c\uc6b0\ud305 \uc124\uc815\uc2dc URI \ub9c8\uc9c0\ub9c9\uc5d0 / \ucd94\uac00 https://askubuntu.com/questions/1173951/all-routes-except-return-404-from-nginx-running-flask-wsgi</li> <li>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 \uae4c\uba39\uc9c0 \ub9d0\uace0 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130 \uba85\uc2dc\ud560 \uac83 user_data \uc0ac\uc6a9\uc2dc terraform init \ub2e4\uc2dc \ud574\uc57c \ud568</li> <li>EC2 \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc790\ub3d9\uc73c\ub85c CodeDeploy Agent \uc124\uce58\ud558\ub824\uba74 CodeDeploy \uc811\uadfc\uac00\ub2a5 \uc5ed\ud560\uc744 \uba3c\uc800 \ubd80\uc5ec\ud560 \uac83</li> <li> <p>\uc624\ub958 \ud574\uacb0\uc744 \uc704\ud574 \uc774\uac83 \uc800\uac83 \ud574\ubcf4\ub290\ub77c \uba87 \uc2dc\uac04 \uae4c\uc9c0 \uac78\ub9ac\ub294 \uac83\uc740 \ub2f9\uc5f0\ud55c \uac83..</p> <p></p> </li> <li> <p>\uc720\uc800\ub370\uc774\ud130\uc5d0 \ud504\ub85c\uadf8\ub7a8 \uc124\uce58 \uba85\ub839\uc744 \ub123\uc73c\uba74 \ub2f9\uc5f0\ud788 \uc124\uce58 \ub420 \ub54c \uae4c\uc9c0 \uae30\ub2e4\ub824\uc57c \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>HTTP\ub791 HTTPS\ub791 \ud5f7\uac08\ub9ac\uc9c0 \ub9d0\uac83\u315c\u315c\u315c\u315c(\uc81c\uc77c \uc5b4\uc774 \uc5c6\ub358 \ubd80\ubd84)</p> </li> <li>HTML\uc740 \uc798 \ub098\uc624\uc9c0\ub9cc CSS, JS \ub85c\ub4dc\uac00 \uc548\ub418\uba74 Nginx \uc124\uc815 \ubb38\uc81c</li> <li>\uc815\uc801\ucee8\ud150\uce20 s3 \ud638\uc2a4\ud305\uc744 \uc704\ud55c \uc774\ub3d9\uc73c\ub85c cp //.css *//*.js ./deploy \uc774\ub7f0\uac83\ub3c4 \uac00\ub2a5</li> <li>S3\uc5d0 static resource \ubd84\ub9ac\ud560 \ub54c public access \uad8c\ud55c \uc810\uac80\ud558\uae30</li> <li>S3 \ubc84\ud0b7\uc815\ucc45 \ub9cc\ub4e4 \ub54c \ub9ac\uc18c\uc2a4\uc5d0 /* \ubd99\uc774\uae30https://stackoverflow.com/questions/44228422/s3-bucket-action-doesnt-apply-to-any-resources</li> <li>\ud14c\ub77c\ud3fc\uc5d0\uc11c \ubcf4\uc548\uadf8\ub8f9 \uc2a4\uc2a4\ub85c\ub97c \uc18c\uc2a4\ub85c \uc0ac\uc6a9\ud558\ub824\uba74 ID\ub97c \ub123\uc9c0 \ub9d0\uace0 self = true \uc774\uc6a9\ud558\uae30 https://stackoverflow.com/questions/49995417/self-reference-not-allowed-in-security-group-definition</li> <li>\uc624\ucf00\uc2a4\ud2b8\ub808\uc774\uc158 \uad6c\ucd95\ud560 \ub584 \ud37c\ube14\ub9ad IP \ub9d0\uace0 \ud504\ub77c\uc774\ube57 IP\ub85c \uad6c\ucd95</li> <li>EC2 \ud504\ub77c\uc774\ube57 IP \uac00\uc838\uc624\uae30\u2b50<ul> <li>/sbin/ifconfig eth0 | grep 'inet' | cut -d: -f2 | awk '{print $2}'</li> <li>hostname -i</li> </ul> </li> <li>\uc9c4\uc790\ud15c\ud50c\ub9bf \uc0ac\uc6a9\uc2dc \ub300\uc18c\ubb38\uc790 \uad6c\ubd84 \ud544\uc218(\ud2b9\ud788 \uba54\uc18c\ub4dc \ubd80\ubd84)</li> <li> <p>Nginx\uc5d0\uc11c \ubc14\ub85c POST \uba54\uc18c\ub4dc\ub97c \uc0ac\uc6a9\ud560\uacbd\uc6b0 \ub9ac\ub2e4\uc774\ub809\uc158 \ubc1c\uc0dd</p> <p>\u2192 https://stackoverflow.com/questions/27795068/nginx-rewrite-post-data</p> </li> <li> <p>Apply\uc11c\ubc84\uc5d0 POST, Result\uc11c\ubc84\uc5d0 GET \ubc29\uc2dd\uc744 \uc801\uc6a9\ud588\uc2b5\ub2c8\ub2e4</p> </li> <li>\uae43 \ube0c\ub79c\uce58\ub85c \uad00\ub9ac\ud560 \ub584 \ud14c\ub77c\ud3fc \uc5c9\ub9dd\uc774 \ub418\uc9c0 \uc54a\ub3c4\ub85d \uc8fc\uc758\ud558\uae30</li> <li>\ub3c4\ucee4\uc2a4\uc6dc\uc740 \ub3c4\ucee4\ucef4\ud3ec\uc988\ud30c\uc77c\uc744 \uc2a4\ud0dd\uc73c\ub85c \uc774\uc6a9\ud574 \uad6c\ub3d9 \uac00\ub2a5https://docs.docker.com/engine/swarm/stack-deploy/</li> <li> <p>\ub3c4\ucee4\uc2a4\ud0dd \uad6c\ub3d9\uc2dc \ucee8\ud14c\uc774\ub108 \uc2e4\ud589\uc790\uccb4\uac00 \ubb38\uc81c\uc77c \uacbd\uc6b0 \ucef4\ud3ec\uc988\ub97c \ud55c \ubc88 \ub3cc\ub824\ubcf4\uba74 \uc2e4\ub9c8\ub9ac\ub97c \ucc3e\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>RDS\uac00 \ud504\ub77c\uc774\ube57 \uc11c\ube0c\ub137\uc5d0 \uc874\uc7ac\ud558\uba74 Travis\uc5d0\uc11c \ucf54\ub4dc\ud14c\uc2a4\ud2b8\ub97c \uc9c4\ud589\ud560 \ub54c RDS\uc5d0 \uc811\uc18d\uc2e4\ud328\ud558\uc5ec \ud14c\uc2a4\ud2b8 \uc2e4\ud328\ub85c \uc774\uc5b4\uc9c0\ub294 \uac83\uc5d0 \uc8fc\uc758</p> </li> <li> <p>MySQL \uc811\uc18d \ucee4\ub9e8\ub4dc</p> <pre><code>mysql -h myapp.cnr20hoyd3cu.ap-northeast-2.rds.amazonaws.com -P 3306 -u root -p\n</code></pre> </li> <li> <p>\ub3c4\ucee4 \uc2a4\uc6dc\ubaa8\ub4dc \uc5d0\ub7ec \ud655\uc778</p> <p>\u2192  docker service logs {SERVICE} \uba85\ub839\uc73c\ub85c \ub85c\uadf8 \ud655\uc778 \uac00\ub2a5</p> <p></p> </li> </ul>"},{"location":"Projects/Project-1/#todo","title":"TODO","text":"<ul> <li>IaC<ul> <li> Terraform</li> <li> Terraform \uace0\ub3c4\ud654</li> </ul> </li> <li>CICD<ul> <li> Container(Dockerfile)<ul> <li> Flask + gunicorn</li> <li> MySQL</li> <li> Nginx</li> </ul> </li> <li> Docker Compose</li> <li> Travis CI</li> <li> CodeDeploy</li> <li> \ubc30\ud3ec \uc644\ub8cc \ud6c4 \uad6c\ub3d9 \uc138\ud305</li> <li> EC2</li> <li> CI\ub97c \uc704\ud55c \ud14c\uc2a4\ud2b8\ucf54\ub4dc \uc791\uc131</li> </ul> </li> <li>Server<ul> <li> HTML CSS \ud2c0 \ub9cc\ub4e4\uae30</li> <li> RDS, MySQL \uc5f0\uacb0</li> <li> \uae30\ub2a5 \uc81c\uc791</li> </ul> </li> <li>Orchestration<ul> <li> Swarm Mode</li> </ul> </li> </ul>"},{"location":"Projects/Project-1/#part-1-cicd","title":"Part 1 - CICD","text":""},{"location":"Projects/Project-1/#codedeploy","title":"CodeDeploy(\ucf58\uc194)","text":"<ol> <li> <p>\uc0c8\ub85c\uc6b4 CodeDeploy \uc791\uc5c5 \uc0dd\uc131</p> <p></p> </li> <li> <p>\ubc30\ud3ec\uadf8\ub8f9 \uc0dd\uc131</p> <p></p> </li> <li> <p>\ud0dc\uadf8\ub97c \uc774\uc6a9\ud574 EC2\ub97c \uc9c0\uc815\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS SM\uc744 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uace0 \uc9c1\uc811 CodeDeploy\ub97c \uc124\uce58\ud558\uc600\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CodeDeploy\uc5d0 \ubc30\ud3ec \uad00\ub828 \uc124\uc815\uc744 \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#ec2","title":"EC2 \ubc30\ud3ec \uc124\uc815","text":"<ol> <li> <p>CodeDeploy Agent \uc124\uce58</p> <pre><code>aws s3 cp s3://aws-codedeploy-ap-northeast-2/latest/install . --region ap-northeast-2\nsudo yum install -y ruby wget\nchmod +x ./install\nsudo ./install auto\nsudo service codedeploy-agent start\nsudo service codedeploy-agent status\n</code></pre> </li> <li> <p>Docker \uc124\uce58</p> <pre><code>sudo yum -y install docker\nsudo systemctl start docker\nsudo systemctl enable docker sudo usermod -aG docker ec2-user\n</code></pre> <p>\uad8c\ud55c \ubb38\uc81c\ub85c docker ps -a \uba85\ub839\uc774 \ubd88\uac00\ub2a5 \ud560 \uacbd\uc6b0</p> <pre><code>sudo chmod 666 /var/run/docker.sock\n</code></pre> </li> <li> <p>\ub530\ub77c\uc11c \ud14c\ub77c\ud3fc\uc5d0 \uc791\uc131\ud560 EC2 \uc778\uc2a4\ud134\uc2a4\uc758 \uc0ac\uc6a9\uc790 \ub370\uc774\ud130\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>&lt;&lt;-EOF\n#!/bin/bash\naws s3 cp s3://aws-codedeploy-ap-northeast-2/latest/install . --region ap-northeast-2\nsudo yum install -y ruby wget git\nchmod +x ./install\nsudo ./install auto\nsudo service codedeploy-agent start\nsudo yum -y install docker\nsudo systemctl start docker\nsudo systemctl enable docker\nsudo usermod -aG docker ec2-user\nsudo chmod 666 /var/run/docker.sock\nsudo curl -L \"https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\nEOF\n</code></pre> </li> <li> <p>CICD\ub97c \uc704\ud55c .travis.yml \uc791\uc131</p> .travis.yml<pre><code>language: generic\nservices:\n- docker\nbefore_install:\n- docker build -t dotoryeee/test-submit-server -f ./flask-submit-server/Dockerfile ./flask-submit-server\nscript:\n- docker run -e CI=true dotoryeee/test-submit-server python3 test.py\nafter_success:\n- docker build -t dotoryeee/flask-submit-server ./flask-submit-server\n- docker build -t dotoryeee/flask-result-server ./flask-result-server\n- docker build -t dotoryeee/nginx ./nginx\n- echo \"$DOCKER_HUB_PASSWORD\" | docker login -u \"$DOCKER_HUB_ID\" --password-stdin\n- docker push dotoryeee/flask-submit-server\n- docker push dotoryeee/flask-result-server\n- docker push dotoryeee/nginx\nbefore_deploy:\n- zip -r myapp.zip ./* #CI \uc644\ub8cc \ud6c4 \ubaa8\ub4e0 \ud30c\uc77c\uc744 myapp.zip\ub85c \uc555\ucd95\n- mkdir -p deploy  # deploy \ub514\ub809\ud130\ub9ac \uc0dd\uc131\n- mv myapp.zip ./deploy #myapp.zip\ub97c deploy \ub514\ub809\ud130\ub9ac\ub85c \uc774\ub3d9\ndeploy:\n- provider: s3\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_ACCESS_KEY\nbucket: dotoryeee-s3\nregion: ap-northeast-2\nskip_cleanup: true #\uc555\ucd95\ud30c\uc77c \uc0ad\uc81c \ubc29\uc9c0\nlocal_dir: deploy #deploy \ub514\ub809\ud130\ub9ac\uc758 \ud30c\uc77c\uc744 S3\uc5d0 \uc804\uc1a1\nwait-until-deployed: true\non:\nbranch: main\n- provider: codedeploy\naccess_key_id: $AWS_ACCESS_KEY\nsecret_access_key: $AWS_SECRET_ACCESS_KEY\nbucket: dotoryeee-s3\nkey: myapp.zip\nbundle_type: zip\napplication: talentpool\ndeployment_group: CICD-test\nregion: ap-northeast-2\nwait-until-deployed: true #AWS\uc5d0 \ud30c\uc77c \uc804\ub2ec \uc774\ud6c4\uc5d0\ub3c4 \uc5d0\ub7ec \ud655\uc778 \uac00\ub2a5\non:\nbranch: main\n</code></pre> </li> <li> <p>CodeDeploy \uc774\ud6c4 \uc791\uc5c5 \uba85\uc2dc\ub97c \uc704\ud55c appspec.yml \uc791\uc131</p> appspec.yml<pre><code>version: 0.0\nos: linux\nfiles:\n- source: /\ndestination: /home/ec2-user/app\noverwrite: yes\nhooks:\nAfterInstall:\n- location: execute-deploy.sh\ntimeout: 300\n</code></pre> </li> <li> <p>\uc11c\ubc84\uc5d0\uc11c \uad6c\ub3d9 \uc704\ud55c docker-compose-ec2.yml \uc791\uc131</p> docker-compose-ec2.yml<pre><code>version: \"3\"\nservices:\nflask-submit-server:\nimage: dotoryeee/flask-submit-server\nrestart: always\ncontainer_name: flask-submit-server\nports:\n- \"8000:8000\"\ncommand: gunicorn -w 1 -b 0.0.0.0:8000 wsgi:server\nflask-result-server:\nimage: dotoryeee/flask-result-server\nrestart: always\ncontainer_name: flask-result-server\nports:\n- \"7000:7000\"\nvolumes:\n- ./flask-result-server:/usr/src/app\ncommand: gunicorn -w 1 -b 0.0.0.0:7000 wsgi:server\nnginx:\nimage: dotoryeee/nginx\ncontainer_name: nginx\nrestart: always\nports:\n- \"80:80\"\n#flask \ucee8\ud14c\uc774\ub108 \ub85c\ub4dc\uac00 \ub05d\ub098\uba74 Nginx\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4\ndepends_on:\n- flask-submit-server\n- flask-result-server\n</code></pre> </li> <li> <p>\uc5f0\ub3d9\ud558\uc5ec \uc11c\ubc84 \uc2dc\uc791 \uba85\ub839\uc774 \uba85\uc2dc\ub41c execute-deploy \uc2a4\ud06c\ub9bd\ud2b8 \uc791\uc131</p> execute-deploy.sh<pre><code>#!/bin/bash\nsudo curl -L \"https://github.com/docker/compose/releases/download/1.28.5/docker-compose-$(uname -s)-$(uname -m)\" -o /usr/local/bin/docker-compose\nsudo chmod +x /usr/local/bin/docker-compose\ndocker-compose -f /home/e2-user/app/docker-compose-ec2.yml rm -fs\ndocker system prune -a -f\ndocker-compose -f /home/e2-user/app/docker-compose-ec2.yml up\n</code></pre> </li> </ol>"},{"location":"Projects/Project-1/#_6","title":"\ub3d9\uc791 \ud655\uc778","text":"<ol> <li> <p>Terraform Apply\ub97c \uc774\uc6a9\ud574 \uc778\ud504\ub77c\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <ul> <li>Terraform Apply</li> </ul> <pre><code>An execution plan has been generated and is shown below.\nResource actions are indicated with the following symbols:\n+ create\nTerraform will perform the following actions:\n# aws_instance.public_01 will be created\n+ resource \"aws_instance\" \"public_01\" {\n+ ami                          = \"ami-006e2f9fa7597680a\"\n+ arn                          = (known after apply)\n+ associate_public_ip_address  = (known after apply)\n+ availability_zone            = (known after apply)\n+ cpu_core_count               = (known after apply)\n+ cpu_threads_per_core         = (known after apply)\n+ get_password_data            = false\n+ host_id                      = (known after apply)\n+ iam_instance_profile         = \"EC2_role_for_codedeploy\"\n+ id                           = (known after apply)\n+ instance_state               = (known after apply)\n+ instance_type                = \"t2.micro\"\n+ ipv6_address_count           = (known after apply)\n+ ipv6_addresses               = (known after apply)\n+ key_name                     = \"dotoryeee\"\n+ outpost_arn                  = (known after apply)\n+ password_data                = (known after apply)\n+ placement_group              = (known after apply)\n+ primary_network_interface_id = (known after apply)\n+ private_dns                  = (known after apply)\n+ private_ip                   = (known after apply)\n+ public_dns                   = (known after apply)\n+ public_ip                    = (known after apply)\n+ secondary_private_ips        = (known after apply)\n+ security_groups              = (known after apply)\n+ source_dest_check            = true\n+ subnet_id                    = (known after apply)\n+ tags                         = {\n+ \"Name\" = \"talentpool-webserver\"\n}\n+ tenancy                      = (known after apply)\n+ user_data                    = \"37dd0b56bc65486734172a29cc30def4180da21a\"\n+ vpc_security_group_ids       = (known after apply)\n+ ebs_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ snapshot_id           = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n+ enclave_options {\n+ enabled = (known after apply)\n}\n+ ephemeral_block_device {\n+ device_name  = (known after apply)\n+ no_device    = (known after apply)\n+ virtual_name = (known after apply)\n}\n+ metadata_options {\n+ http_endpoint               = (known after apply)\n+ http_put_response_hop_limit = (known after apply)\n+ http_tokens                 = (known after apply)\n}\n+ network_interface {\n+ delete_on_termination = (known after apply)\n+ device_index          = (known after apply)\n+ network_interface_id  = (known after apply)\n}\n+ root_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n}\n# aws_instance.public_02 will be created\n+ resource \"aws_instance\" \"public_02\" {\n+ ami                          = \"ami-006e2f9fa7597680a\"\n+ arn                          = (known after apply)\n+ associate_public_ip_address  = (known after apply)\n+ availability_zone            = (known after apply)\n+ cpu_core_count               = (known after apply)\n+ cpu_threads_per_core         = (known after apply)\n+ get_password_data            = false\n+ host_id                      = (known after apply)\n+ iam_instance_profile         = \"EC2_role_for_codedeploy\"\n+ id                           = (known after apply)\n+ instance_state               = (known after apply)\n+ instance_type                = \"t2.micro\"\n+ ipv6_address_count           = (known after apply)\n+ ipv6_addresses               = (known after apply)\n+ key_name                     = \"dotoryeee\"\n+ outpost_arn                  = (known after apply)\n+ password_data                = (known after apply)\n+ placement_group              = (known after apply)\n+ primary_network_interface_id = (known after apply)\n+ private_dns                  = (known after apply)\n+ private_ip                   = (known after apply)\n+ public_dns                   = (known after apply)\n+ public_ip                    = (known after apply)\n+ secondary_private_ips        = (known after apply)\n+ security_groups              = (known after apply)\n+ source_dest_check            = true\n+ subnet_id                    = (known after apply)\n+ tags                         = {\n+ \"Name\" = \"talentpool-webserver\"\n}\n+ tenancy                      = (known after apply)\n+ user_data                    = \"37dd0b56bc65486734172a29cc30def4180da21a\"\n+ vpc_security_group_ids       = (known after apply)\n+ ebs_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ snapshot_id           = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n+ enclave_options {\n+ enabled = (known after apply)\n}\n+ ephemeral_block_device {\n+ device_name  = (known after apply)\n+ no_device    = (known after apply)\n+ virtual_name = (known after apply)\n}\n+ metadata_options {\n+ http_endpoint               = (known after apply)\n+ http_put_response_hop_limit = (known after apply)\n+ http_tokens                 = (known after apply)\n}\n+ network_interface {\n+ delete_on_termination = (known after apply)\n+ device_index          = (known after apply)\n+ network_interface_id  = (known after apply)\n}\n+ root_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n}\n# aws_internet_gateway.main will be created\n+ resource \"aws_internet_gateway\" \"main\" {\n+ arn      = (known after apply)\n+ id       = (known after apply)\n+ owner_id = (known after apply)\n+ tags     = {\n+ \"Name\" = \"igw-talent-pool\"\n}\n+ vpc_id   = (known after apply)\n}\n# aws_key_pair.dotoryeee will be created\n+ resource \"aws_key_pair\" \"dotoryeee\" {\n+ arn         = (known after apply)\n+ fingerprint = (known after apply)\n+ id          = (known after apply)\n+ key_name    = \"dotoryeee\"\n+ key_pair_id = (known after apply)\n+ public_key  = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDD5D5mHSD/vdgcGmh6Kd57DqLxebcvbrUsHj8DYDW0+9MSvvK874Bm4hpqHliYze/ht7VnzL5+A5qZkCevKGBDeJNmR/QDHccCsCfRuyEmzMlvj3SxzYSH2N4lBG6eZZbQ+0yRl7ny3aeyol5boDkztLZ/PZwVR5IH6BgsNiGClSDtuf2CYoKN7hQufjeuCDcLlQa+ItFa4abMe/mWtMeEh7+ZpC+0KAFFvqY80OCtuUdqq7tcP8uHzQy9mPKvKBieJYitUoStjFEMAro1v34u6193Qgk6DAhyMom4GmLc2+tTyKMsvBlRKUOb87F+2zsATX3Ahz9cMpEkfPTkY15V dotoryeee@i5-6500\"\n}\n# aws_route.default will be created\n+ resource \"aws_route\" \"default\" {\n+ destination_cidr_block     = \"0.0.0.0/0\"\n+ destination_prefix_list_id = (known after apply)\n+ egress_only_gateway_id     = (known after apply)\n+ gateway_id                 = (known after apply)\n+ id                         = (known after apply)\n+ instance_id                = (known after apply)\n+ instance_owner_id          = (known after apply)\n+ local_gateway_id           = (known after apply)\n+ nat_gateway_id             = (known after apply)\n+ network_interface_id       = (known after apply)\n+ origin                     = (known after apply)\n+ route_table_id             = (known after apply)\n+ state                      = (known after apply)\n}\n# aws_route_table.private will be created\n+ resource \"aws_route_table\" \"private\" {\n+ id               = (known after apply)\n+ owner_id         = (known after apply)\n+ propagating_vgws = (known after apply)\n+ route            = (known after apply)\n+ tags             = {\n+ \"Name\" = \"RT-private-talent-pool\"\n}\n+ vpc_id           = (known after apply)\n}\n# aws_route_table.public will be created\n+ resource \"aws_route_table\" \"public\" {\n+ id               = (known after apply)\n+ owner_id         = (known after apply)\n+ propagating_vgws = (known after apply)\n+ route            = (known after apply)\n+ tags             = {\n+ \"Name\" = \"RT-public-talent-pool\"\n}\n+ vpc_id           = (known after apply)\n}\n# aws_route_table_association.private-asso-2a will be created\n+ resource \"aws_route_table_association\" \"private-asso-2a\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_route_table_association.private-asso-2c will be created\n+ resource \"aws_route_table_association\" \"private-asso-2c\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_route_table_association.public-asso-2a will be created\n+ resource \"aws_route_table_association\" \"public-asso-2a\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_route_table_association.public-asso-2c will be created\n+ resource \"aws_route_table_association\" \"public-asso-2c\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_security_group.public_ec2 will be created\n+ resource \"aws_security_group\" \"public_ec2\" {\n+ arn                    = (known after apply)\n+ description            = \"allow SSH from anywhere\"\n+ egress                 = [\n+ {\n+ cidr_blocks      = [\n+ \"0.0.0.0/0\",\n]\n+ description      = \"\"\n+ from_port        = 0\n+ ipv6_cidr_blocks = []\n+ prefix_list_ids  = []\n+ protocol         = \"-1\"\n+ security_groups  = []\n+ self             = false\n+ to_port          = 0\n},\n]\n+ id                     = (known after apply)\n+ ingress                = [\n+ {\n+ cidr_blocks      = [\n+ \"0.0.0.0/0\",\n]\n+ description      = \"\"\n+ from_port        = 22\n+ ipv6_cidr_blocks = []\n+ prefix_list_ids  = []\n+ protocol         = \"tcp\"\n+ security_groups  = []\n+ self             = false\n+ to_port          = 22\n},\n+ {\n+ cidr_blocks      = [\n+ \"0.0.0.0/0\",\n]\n+ description      = \"\"\n+ from_port        = 80\n+ ipv6_cidr_blocks = []\n+ prefix_list_ids  = []\n+ protocol         = \"tcp\"\n+ security_groups  = []\n+ self             = false\n+ to_port          = 80\n},\n]\n+ name                   = \"allow SSH and HTTP\"\n+ name_prefix            = (known after apply)\n+ owner_id               = (known after apply)\n+ revoke_rules_on_delete = false\n+ tags                   = {\n+ \"Name\" = \"SG-EC2-webserver\"\n}\n+ vpc_id                 = (known after apply)\n}\n# aws_subnet.private-2a will be created\n+ resource \"aws_subnet\" \"private-2a\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2a\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.2.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = false\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"private-2a\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_subnet.private-2c will be created\n+ resource \"aws_subnet\" \"private-2c\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2c\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.3.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = false\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"private-2c\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_subnet.public-2a will be created\n+ resource \"aws_subnet\" \"public-2a\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2a\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.0.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = true\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"public-2a-talent-pool\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_subnet.public-2c will be created\n+ resource \"aws_subnet\" \"public-2c\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2c\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.1.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = true\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"public-2c-talent-pool\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_vpc.main will be created\n+ resource \"aws_vpc\" \"main\" {\n+ arn                              = (known after apply)\n+ assign_generated_ipv6_cidr_block = false\n+ cidr_block                       = \"10.0.0.0/16\"\n+ default_network_acl_id           = (known after apply)\n+ default_route_table_id           = (known after apply)\n+ default_security_group_id        = (known after apply)\n+ dhcp_options_id                  = (known after apply)\n+ enable_classiclink               = (known after apply)\n+ enable_classiclink_dns_support   = (known after apply)\n+ enable_dns_hostnames             = true\n+ enable_dns_support               = true\n+ id                               = (known after apply)\n+ instance_tenancy                 = \"default\"\n+ ipv6_association_id              = (known after apply)\n+ ipv6_cidr_block                  = (known after apply)\n+ main_route_table_id              = (known after apply)\n+ owner_id                         = (known after apply)\n+ tags                             = {\n+ \"Name\" = \"vpc-talent-pool\"\n}\n}\nPlan: 17 to add, 0 to change, 0 to destroy.\nDo you want to perform these actions?\nTerraform will perform the actions described above.\nOnly 'yes' will be accepted to approve.\nEnter a value: yes\naws_key_pair.dotoryeee: Creating...\naws_vpc.main: Creating...\naws_key_pair.dotoryeee: Creation complete after 1s [id=dotoryeee]\naws_vpc.main: Still creating... [10s elapsed]\naws_vpc.main: Creation complete after 11s [id=vpc-0c885c480266a1609]\naws_route_table.public: Creating...\naws_subnet.private-2c: Creating...\naws_subnet.public-2a: Creating...\naws_route_table.private: Creating...\naws_internet_gateway.main: Creating...\naws_subnet.public-2c: Creating...\naws_subnet.private-2a: Creating...\naws_security_group.public_ec2: Creating...\naws_route_table.private: Creation complete after 0s [id=rtb-007ecd93701976184]\naws_route_table.public: Creation complete after 0s [id=rtb-07a3c28f427d9d9b0]\naws_internet_gateway.main: Creation complete after 1s [id=igw-08b4682de4ec8f301]\naws_subnet.private-2c: Creation complete after 1s [id=subnet-0f054920c100a9591]\naws_subnet.private-2a: Creation complete after 1s [id=subnet-05bfc7af15120b423]\naws_route_table_association.private-asso-2c: Creating...\naws_route.default: Creating...\naws_route_table_association.private-asso-2a: Creating...\naws_route_table_association.private-asso-2c: Creation complete after 0s [id=rtbassoc-0dbe25bb20f9f3fbf]\naws_route_table_association.private-asso-2a: Creation complete after 0s [id=rtbassoc-099fe2753e2de8eeb]\naws_route.default: Creation complete after 0s [id=r-rtb-07a3c28f427d9d9b01080289494]\naws_security_group.public_ec2: Creation complete after 2s [id=sg-0a3b2cfbd654e0211]\naws_subnet.public-2a: Still creating... [10s elapsed]\naws_subnet.public-2c: Still creating... [10s elapsed]\naws_subnet.public-2c: Creation complete after 11s [id=subnet-08dd1b40e3066df36]\naws_subnet.public-2a: Creation complete after 11s [id=subnet-03874ee39103bba68]\naws_route_table_association.public-asso-2c: Creating...\naws_route_table_association.public-asso-2a: Creating...\naws_instance.public_01: Creating...\naws_instance.public_02: Creating...\naws_route_table_association.public-asso-2a: Creation complete after 0s [id=rtbassoc-0b6bc559f38878ca0]\naws_route_table_association.public-asso-2c: Creation complete after 0s [id=rtbassoc-0eaa97ebcf00bcfd6]\naws_instance.public_01: Still creating... [10s elapsed]\naws_instance.public_02: Still creating... [10s elapsed]\naws_instance.public_01: Still creating... [20s elapsed]\naws_instance.public_02: Still creating... [20s elapsed]\naws_instance.public_01: Creation complete after 21s [id=i-00cb9f1261ba14494]\naws_instance.public_02: Creation complete after 21s [id=i-0a84d66623f8c2a83]\nApply complete! Resources: 17 added, 0 changed, 0 destroyed.\n</code></pre> <p></p> </li> <li> <p>EC2\uac00 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubcf4\uc548\uadf8\ub8f9\uacfc \uc5ed\ud560\uc774 \uc798 \ubd80\uc5ec\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>SSH\ub85c \uc778\uc2a4\ud134\uc2a4\uc5d0 \uc811\uc18d\ud574 Docker\uac00 \uc124\uce58\ub41c \uac83\uc744 \ud655\uc778\ud569\ub2c8\ub2e4 \ucd5c\ucd08 \uc811\uc18d\uc784\uc5d0\ub3c4 \ubd88\uad6c\ud558\uace0 \ub3c4\ucee4\uac00 \uc124\uce58\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uae43\ud5d9\uc5d0 Push \ud558\uc5ec CICD \ud30c\uc774\ud504\ub77c\uc778\uc5d0 \uc2dc\ub3d9\uc744 \uac78\uc5b4\ubd05\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uae43\ud5d9\uc5d0 Push \ud558\uba74 Travis CI\uac00 \uc790\ub3d9\uc73c\ub85c \ud1b5\ud569 \ud14c\uc2a4\ud2b8\ub97c \uc2dc\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CI\uac00 \uc131\uacf5\ud558\uba74</p> <p></p> </li> <li> <p>AWS S3\uc5d0 \ucf54\ub4dc\ub97c \uc5c5\ub85c\ub4dc \ud558\uace0 CodeDeploy\uc758 \ubc30\ud3ec \ud2b8\ub9ac\uac70\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>S3\uc5d0 \uc18c\uc2a4\ucf54\ub4dc\uac00 \uc5c5\ub85c\ub4dc \ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CodeDeploy\uac00 \uc124\uc815\uc5d0 \ub9e4\uce6d\ub418\ub294 EC2\ub97c \ucc3e\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CodeDeploy\uc5d0 \uc0c8\ub85c\uc6b4 \uc77c\uac70\ub9ac\uac00 \ub85c\ub4dc\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>CodeDeploy\uac00 S3 \u2192 EC2\ub85c \uc18c\uc2a4\ucf54\ub4dc\ub97c \uc9d1\uc5b4\ub123\uace0 \uc555\ucd95\uc744 \ud480\uc5b4\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc2e4\ud328\ud558\uba74 \uc5d0\ub7ec\uac00 \ub9e4\uc6b0 \uc798 \ub098\uc635\ub2c8\ub2e4. CodeDeploy\uac00 \uc774 \ubd80\ubd84\uc774 \ub108\ubb34 \uc798 \ub418\uc5b4\uc788\uc5b4\uc11c \ube48\uc2a4\ud1a1\uc740 \ubabb \uc4f0\uaca0\uc2b5\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>Travis CI\uc5d0\uc11c wait-until-deployed\uc635\uc158\uc744 \uc0ac\uc6a9\ud588\uae30 \ub54c\ubb38\uc5d0 \ubc30\ud3ec\uac00 \ucd5c\uc885 \uc644\ub8cc\ub420 \ub54c \uae4c\uc9c0 \uc9c0\ucf1c\ubcf4\uace0 \uc788\uc2b5\ub2c8\ub2e4. \ub3c4\ucee4 \ucef4\ud3ec\uc988 \ub05d\ub098\ub294 \uac83 \uae4c\uc9c0 \ud3ec\ud568\ud574\uc11c \ubc30\ud3ec \ucd1d \uacfc\uc815\uc774 \uc5bc\ub9c8\ub098 \uac78\ub9ac\ub294\uc9c0 \uc54c \uc218 \uc788\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>\ub450 \uc778\uc2a4\ud134\uc2a4 \ubaa8\ub450 \ubc30\ud3ec\uac00 \uc131\uacf5\ud558\uac8c \ub418\uba74</p> <p></p> </li> <li> <p>EC2\uc5d0 \ud30c\uc77c\uc774 \uc798 \uc0dd\uc131\ub418\uc5b4\uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubaa8\ub4e0 \ubc30\ud3ec\uacfc\uc815\uc744 \ub9c8\uce58\uba74 EC2\uc5d0\uc11c \uc790\ub3d9\uc73c\ub85c \ucef4\ud3ec\uc988\ub97c \uc774\uc6a9\ud574 Hub\uc5d0 \uc5c5\ub85c\ub4dc\ub41c \uc774\ubbf8\uc9c0\ub97c \uac00\uc838\uc640 \uc2e4\ud589\ud569\ub2c8\ub2e4.</p> </li> <li> <p>\uc11c\ubc84\uac00 \uc798 \uc2e4\ud589\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>EC2\uc758 \ud37c\ube14\ub9ad DNS\ub85c \uc811\uc18d\ud558\uba74 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#part-2-service","title":"Part 2 - Service","text":""},{"location":"Projects/Project-1/#_7","title":"\ube0c\ub79c\uce58","text":"<ol> <li> <p>\ube0c\ub79c\uce58\ub97c \ud558\ub098 \ub9cc\ub4e4\uc5b4\uc11c \uc791\uc5c5\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ube0c\ub79c\uce58\ub97c \uc0dd\uc131\ud574\uc11c \uc791\uc5c5\ud558\uace0 Pull Request\ub85c \uba38\uc9c0\ub97c \uc694\uccad \u2192 \uba38\uc9c0 \ud6c4 \ud2b8\ub808\ube44\uc2a4\uac00 \ud14c\uc2a4\ud2b8\ub97c \ud569\ub2c8\ub2e4. \uae43\ud5d9 \ud398\uc774\uc9c0\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc11c\ubc84\uac00 \uc644\uc131\ub418\uba74 pull request\ub97c \uc694\uccad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uae43\ud5d9\uc5d0\uc11c \ucf54\ub4dc \uac80\uc0ac \ud6c4 \ud569\ubcd1 \uac00\ub2a5\ud558\uba74 Merge\ub97c \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>PR\uc744 \uc694\uccad\ub418\uba74 \uc790\ub3d9\uc73c\ub85c \ud2b8\ub808\ube44\uc2a4\uc5d0\uc11c \uac80\uc0ac\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uac80\uc0ac \uc2dc\uc791</p> <p></p> </li> <li> <p>\uac80\uc0ac\uac00 \uc644\ub8cc\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \ud558\uc9c0\ub9cc PR\uc694\uccad\uc5d0 \ub530\ub978 \uac80\uc0ac\uc774\uae30 \ub584\ubb38\uc5d0 \ubc30\ud3ec\ub294 \uc9c4\ud589\ud558\uc9c0 \uc54a\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>github\uc5d0 \ud14c\uc2a4\ud2b8 \uc131\uacf5 \uacb0\uacfc\uac00 \uc815\uc0c1\uc801\uc73c\ub85c \ub9ac\ud134\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uadf8\ub3d9\uc548 \uc11c\ubc84 \uc81c\uc791 \ube0c\ub79c\uce58\ub97c \uc774\uc6a9\ud574\uc8fc\uc154\uc11c \uac10\uc0ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>PR\ub0b4\uc5ed\uc740 \ubaa8\ub450 \uae43\ud5d9\uc5d0 \uae30\ub85d\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Main Branch\uc5d0 Merge \ub418\uc5c8\uae30 \ub54c\ubb38\uc5d0 \ub2e4\uc2dc \ud2b8\ub808\ube44\uc2a4\uac00 \ubc18\uc751\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Deploy\uac00 \uc2dc\uc791\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS CodeDeploy \ubc30\ud3ec \uc131\uacf5</p> <p></p> </li> <li> <p>\uc6f9\uc11c\ubc84\uac00 RDS\uc640 \uc5f0\uacb0\ud558\uc5ec \uc798 \ub3d9\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#s3","title":"\uc815\uc801\ucee8\ud150\uce20 S3\uc5d0 \ubd84\ub9ac\ud558\uae30","text":"<ol> <li> <p>\uc815\uc801\ucee8\ud150\uce20\ub97c S3\ub85c \ubd84\ub9ac\ud569\ub2c8\ub2e4</p> <p></p> <p></p> </li> <li> <p>\ub2f9\uc5f0\ud788 \uad8c\ud55c\uc744 \uc5f4\uc5b4\uc918\uc57c \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubb38\uc81c\ub294 CICD\uc5d0 \uc758\ud574 \ub2e4\uc2dc S3\uc5d0 \uc5c5\ub85c\ub4dc\ud558\uba74 \uad8c\ud55c\uc774 \uc0ac\ub77c\uc9d1\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub530\ub77c\uc11c \uc815\ucc45\uc0dd\uc131\uae30\ub85c \uc774\ub3d9 \ud6c4</p> <p>AWS Policy Generator</p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \uc815\ucc45\uc744 \uc0dd\uc131\ud558\uace0 \ubcf5\uc0ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>S3 \ubc84\ud0b7\uc815\ucc45\uc744 \uc218\uc815\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc5d0\ub7ec\ub97c \uc2e0\ub098\uac8c \ubfdc\uc5b4\ub0b4\ub294\ub370 \ubc84\ud0b7\uc815\ucc45\uc5d0\uc11c resouce \ub9c8\uc9c0\ub9c9\uc5d0 /*\uc744 \ubd99\uc5ec\uc918\uc57c \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\uc81c \uc678\ubd80\uc5d0\uc11c \uc811\uadfc\uc774 \uc798 \ub429\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#rds","title":"RDS \uc5f0\uacb0\ud558\uae30","text":"<ol> <li> <p>\ud658\uacbd\ubcc0\uc218\ub97c \uc774\uc6a9\ud574 \ud0dc\uadf8\uac12\uc744 \uac00\uc838\uc624\uae30 \uc704\ud574 \uae30\uc874 EC2 \uc5ed\ud560\uc5d0 \uad8c\ud55c\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 EC2 \uc5d0\uc11c RDS\uc5d0 \uc5f0\uacb0\ud560 \uc218 \uc788\ub3c4\ub85d \uc124\uc815\uc744 \ud574\ub461\ub2c8\ub2e4</p> <pre><code>mysql -u root -p --host myapp.cnr20hoyd3cu.ap-northeast-2.rds.amazonaws.com\n</code></pre> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \ud14c\uc774\ube14\uc744 \ub9cc\ub4e4\uc5b4\uc90d\ub2c8\ub2e4</p> <p>\ud569\uaca9 \uacb0\uacfc\ub97c \ub744\uc5b4\uc904 result\ub294 \uae30\ubcf8 \uac12\uc5d0 0\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>create table {RDS_TABLE} (number int auto_increment primary key, name char(10) not null ,contact text not null ,resume text, blog text, result BOOLEAN default 0)\n</code></pre> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 \ud14c\uc2a4\ud2b8 \ud574\ubd05\ub2c8\ub2e4. \uc798 \uc5f0\uacb0\ub418\uc5c8\uc2b5\ub2c8\ub2e4.</p> <p></p> </li> <li> <p>\ub4f1\ub85d\uc11c\ubc84 \uc644\uc131</p> <p></p> </li> <li> <p>\uacb0\uacfc\uc11c\ubc84 \uc644\uc131</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#part-3-orchestration","title":"Part 3 - Orchestration","text":""},{"location":"Projects/Project-1/#swarm-mode","title":"Swarm mode","text":"<ol> <li>\uc2a4\uc6dc\uc744 \uc704\ud55c \ud3ec\ud2b8\ub97c \uac1c\ubc29\ud569\ub2c8\ub2e4<ul> <li>tcp 2377 - \ud074\ub7ec\uc2a4\ud130 \ub9e4\ub2c8\uc9c0\uba3c\ud2b8</li> <li>tcp udp 7946 - \ub178\ub4dc\uac04 \ud1b5\uc2e0</li> <li>udp 4789 - \uc624\ubc84\ub808\uc774 \ub124\ud2b8\uc6cc\ud06c</li> </ul> </li> <li> <p>\ub458 \uc911\uc5d0 \ub9c8\uc74c\uc5d0 \ub4dc\ub294\uac78\ub85c \uc0ac\uc6a9\ud558\uba74 \ub429\ub2c8\ub2e4</p> <p></p> <p></p> <p></p> </li> <li> <p>\ub9e4\ub2c8\uc800 \ub178\ub4dc\ub97c \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>docker swarm init --advertise-addr {ADDR}\n</code></pre> <p></p> </li> <li> <p>\uc6cc\ucee4 \ub178\ub4dc\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p></p> <p></p> <p></p> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc740 \ubc29\uc2dd\uc73c\ub85c Nginx \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud558\uace0 \uc815\ubcf4\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>docker service create --name nginx -p 80:80 nginx\ndocker service ls\ndocker service ps nginx\n</code></pre> <p></p> </li> <li> <p>\uc5b4\ub5a4 \uc778\uc2a4\ud134\uc2a4\ub85c \uc811\uc18d\ud558\ub358 \uc0c1\uad00\uc5c6\uc774 Nginx \ucee8\ud14c\uc774\ub108\uc5d0 \uc5f0\uacb0\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub3c4\ucee4 \uc2a4\uc6dc\uc740 detached\ub97c \uae30\ubcf8 \uc804\uc81c\ub85c \uae54\uace0 \uac00\uae30 \ub54c\ubb38\uc5d0 \ub2e4\uc74c\uacfc \uac19\uc774 process\uac00 \uc885\ub8cc\ub418\ub294 \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud558\uba74 \ud574\ub2f9 \ucee8\ud14c\uc774\ub108\uac00 \uc5d0\ub7ec\uac00 \ubc1c\uc0dd\ud55c \uac83\uc73c\ub85c \ud310\ub2e8\ud558\uc5ec \ubb34\ud55c \uc7ac\uc2e4\ud589 \ub429\ub2c8\ub2e4</p> <p></p> </li> <li></li> <li> <p>\ucee8\ud14c\uc774\ub108 \ud558\ub098\uc529 \ub85c\ub4dc\ud560 \uc218 \uc5c6\ub294 \uacbd\uc6b0 \uc2a4\ud0dd\uc744 \uc774\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> <pre><code>docker stack deploy --compose-file docker-compose-swarm.yml test\n</code></pre> </li> <li> <p>\uc11c\ube44\uc2a4\uac00 \uc798 \uc2e4\ud589\ub418\uba74 RDS\uc5d0 2\uac1c\uc758 \uc5f0\uacb0\uc774 \uc0dd\uc131\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc11c\ube44\uc2a4\uac00 \uc798 \ub85c\ub4dc\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Projects/Project-1/#links","title":"Links","text":"<ul> <li> <p>Docker Best Practices</p> <p>Docker Security Best Practices from the Dockerfile</p> </li> <li> <p>AWS ECS@beanstalk \uba40\ud2f0\ucee8\ud14c\uc774\ub108 DOCS</p> <p>\uba40\ud2f0\ucee8\ud14c\uc774\ub108 Docker \ud50c\ub7ab\ud3fc(Amazon Linux AMI)</p> </li> <li> <p>EC2</p> <ul> <li> <p>User_data ****\ud558\ub4dc\ucf54\ub529</p> <p>Terraform by examples. Part 1</p> </li> <li> <p>EC2 User_data YAML \uc791\uc131\ubc95</p> <p>Cloud config examples - cloud-init 21.1 documentation</p> </li> <li> <p>EC2\uc5d0\uc11c \ud658\uacbd\ubcc0\uc218\ub85c \ud0dc\uadf8 \uac00\uc838\uc624\ub294 \ubc29\ubc95</p> <p>AWS EC2 Tags\ub97c ENV\ub85c \uc0ac\uc6a9\ud558\uae30</p> </li> </ul> </li> <li> <p>Nginx \uc124\uc815</p> <ul> <li> <p>\uae30\ubcf8</p> <p>NGINX \ud658\uacbd\uc124\uc815 - NGINX</p> </li> <li> <p>Nginx \ub85c\uadf8</p> <p></p> </li> </ul> </li> <li> <p>Nginx\uc758 \uc5ed\ud560</p> <p>Nginx \uc774\ud574\ud558\uae30 \ubc0f \uae30\ubcf8 \ud658\uacbd\uc124\uc815 \uc138\ud305\ud558\uae30</p> <p>NGINX \uc18c\uac1c - NGINX</p> </li> <li> <p>WSGI\ub780</p> <p>WSGI\uc5d0 \ub300\ud55c \uc124\uba85, WSGI\ub780 \ubb34\uc5c7\uc778\uac00?</p> <p>wsgi\ub97c \uc65c \uc4f0\ub098\uc694</p> </li> <li> <p>Flask + uWSGI + Nginx</p> <ul> <li> <p>\uc0ac\ub840</p> <p>[Python] Flask + uWSGI + Nginx\ub97c \uc5f0\uacb0 \ubc0f \ubc30\ud3ec</p> <p>\ud558\ud558 \ud638\ud638 \uc990\uae30\ub294 \uac1c\ubc1c\u318d\ubcf4\uc548 \ube14\ub85c\uadf8 \ua242\ua242(\u1d54\u15dc\u1d54*) : \ub124\uc774\ubc84 \ube14\ub85c\uadf8</p> </li> <li> <p>Docs</p> <p>Nginx support - uWSGI 2.0 documentation</p> </li> <li> <p>uWSGI.ini \uc124\uba85</p> <p>[uWSGI] ini\ud30c\uc77c\uc744 \ud1b5\ud574 uWSGI \uc2e4\ud589\ud558\uae30</p> </li> </ul> </li> <li> <p>Flask + gunicorn + Nginx</p> <ul> <li> <p>uWSGI \u2192 gunicorn\uc73c\ub85c \ubcc0\uacbd\ud55c \uc0ac\ub840</p> <p>python\uac1c\ubc1c\uc790 uwsgi\ub97c \ubc84\ub9ac\uace0 gunicorn\uc73c\ub85c \uac08\uc544\ud0c0\ub2e4.</p> </li> <li> <p>Docs</p> <p>Full Example Configuration</p> </li> <li> <p>\uc0ac\ub840</p> <p>Flask + Gunicorn + Nginx + Docker\ub97c \uc0ac\uc6a9\ud558\uc5ec ML \ubaa8\ub378\uc744 \ubc30\ud3ec\ud558\ub294 \ubc29\ubc95</p> </li> </ul> </li> <li> <p>Python \u2194 RDS</p> <p>[AWS] RDS\uc5d0 \uc5f0\uacb0\ub41c MySQL \uacfc Python \uc5f0\ub3d9\ud558\uae30, MySQL \uc601\uc0c1 \uc800\uc7a5\ud558\uae30</p> <p>[AWS/RDS]RDS\uc640 Python \uc5f0\uacb0\ud558\uae30(4) - pymysql\uc744 \uc0ac\uc6a9\ud574 python\uc73c\ub85c DB \uc6b4\uc601\ud558\uae30</p> </li> <li> <p>Flask \u2194 RDS</p> <ul> <li> <p>\uc5f0\uacb0</p> <p>AWS EC2\uc5d0\uc11c RDS \uc5f0\ub3d9\ud6c4 Flask \uc801\uc6a9</p> </li> <li> <p>\ub370\uc774\ud130 \uc81c\uc5b4</p> <p>AWS RDS with MySQL using Flask</p> </li> </ul> </li> <li> <p>\ud30c\uc774\uc36c \ud14c\uc2a4\ud2b8\ucf54\ub4dc \uae30\ubcf8 \uc608\uc2dc</p> <p>Travis-ci\ub97c \uc774\uc6a9\ud558\uc5ec python 'Hello world' \uc791\uc131\ud558\uae30</p> </li> <li> <p>MySQL my.cnf \uc791\uc131\ubc95</p> <p>make my.cnf</p> <p>MySQL \uc124\uc815\ud30c\uc77c my.cnf</p> </li> <li> <p>AWS Elastic Beanstalk</p> <ul> <li> <p>Beanstalk\ud658\uacbd\uc5d0\uc11c Docker \ucee8\ud14c\uc774\ub108 \uc815\uc758 \ubc29\ubc95</p> <p>Docker \uad6c\uc131</p> </li> <li> <p>Beanstalk \uc791\uc5c5\uc815\uc758 \uacf5\uc2dd \uc791\uc131 \uac00\uc774\ub4dc</p> <p>\uba40\ud2f0\ucee8\ud14c\uc774\ub108 Docker \uad6c\uc131</p> </li> </ul> </li> <li> <p>Terraform</p> <ul> <li> <p>Beanstalk Docs</p> <p></p> </li> <li> <p>EC2\uc5d0 \ud658\uacbd\ubcc0\uc218 \ub123\ub294 \ubc95</p> <p>Set environment variables in an AWS instance</p> </li> <li> <p>VPC Docs</p> <p></p> </li> </ul> </li> <li> <p>Travis CI</p> <ul> <li> <p>CodeDeploy Docs</p> <p>Travis CI Documentation</p> </li> </ul> </li> <li> <p>Docker Swarm Docs</p> <ul> <li> <p>Docker official</p> <p>Getting started with swarm mode</p> </li> <li> <p>Stack \uc0ac\uc6a9\ubc95</p> <p>Deploy a stack to a swarm</p> </li> <li> <p>Terraform Module</p> <p></p> </li> <li> <p>\uc624\ubc84\ub808\uc774 \ub124\ud2b8\uc6cc\ud06c\uc5d0\uc11c \ucee8\ud14c\uc774\ub108 \ucc3e\uae30</p> <p>How to use Docker swarm DNS/Service names in Nginx upstream</p> </li> <li> <p>\uc2a4\uc6dc\ubaa8\ub4dc\ub97c \uc704\ud55c \uc2a4\ud0dd \uc791\uc131</p> <p>\ub3c4\ucee4 \uc2dc\uc791\ud558\uae30 11 : \ub3c4\ucee4 \uc2a4\uc6dc - \ub124\ud2b8\uc6cc\ud06c</p> </li> <li> <p>\uc11c\ube44\uc2a4 \uc2dc\uc791 \uc5d0\ub7ec</p> <p>Troubleshooting swarm service create</p> </li> <li> <p>\ubc1c\ud45c\uc6a9 ppt</p> <p>\uac1c\uc778\ud50c\uc81d.pptx</p> </li> </ul> </li> </ul>"},{"location":"SRE/ES%20Domain%20in%20VPC/","title":"ElasticSearch domain in VPC","text":"<p>Tip</p> <p>AWS\uc5d0\uc11c SaaS\ud615\ud0dc\ub85c \uc81c\uacf5\ud558\ub294 ElasticSearch\uc740 7.10\uae4c\uc9c0\ub9cc \uc9c0\uc6d0\ud558\uace0, \uc774\ud6c4 \ubc84\uc804\uc740 OpenSearch\ub85c\ub9cc \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4</p>"},{"location":"SRE/ES%20Domain%20in%20VPC/#_1","title":"\uc0ac\uc804\uc815\ubcf4","text":"<ul> <li>AWS\uc5d0\uc11c SaaS \ud615\ud0dc\ub85c \uc81c\uacf5\ud558\ub294 ElasticSearch(\uc774\ud558 ES)\uc758 \uacbd\uc6b0 domain\uc744 VPC\ub0b4\ubd80 \ub610\ub294 \uc678\ubd80\uc5d0 \uc0dd\uc131\ud560 \uc218 \uc788\ub2e4</li> <li>\ubcf4\uc548\uc744 \uc704\ud574 VPC \ub0b4\ubd80\uc5d0 \uc0dd\uc131\uc744 \uad8c\uace0\ud558\ub294\ub370, ES domain\uc774 private subnet\uc5d0 \uc704\uce58\ud558\ub294 \uacbd\uc6b0 public subnet\uc5d0 Nginx\ub97c \ud504\ub85d\uc2dc \uc11c\ubc84\ub85c \uc0dd\uc131\ud558\uace0 redirection \ud574\uc8fc\uc5b4\uc57c \ud55c\ub2e4</li> <li> <p>Redirection\uc2dc cognito\ub97c \uc774\uc6a9\ud55c \uc0ac\uc6a9\uc790\uc778\uc99d \uc720\ubb34\uc5d0 \ub530\ub77c Nginx \uc124\uc815\uc774 \ub2e4\ub974\ub2e4(\uc544\ub798 \ucc38\uc870)</p> </li> <li> <p>Nginx proxy config</p> <ol> <li>Cognito\ub97c \uc0ac\uc6a9\ud558\ub294 \uacbd\uc6b0  /etc/nginx/conf.d/default.conf<pre><code>server {\nlisten 443;\nserver_name $host;\nrewrite ^/$ https://$host/_dashboards redirect;\nresolver 10.0.0.2 ipv6=off valid=5s;\nset $domain_endpoint my_domain_host;\nset $cognito_host my_cognito_host;\nssl_certificate           /etc/nginx/cert.crt;\nssl_certificate_key       /etc/nginx/cert.key;\nssl on;\nssl_session_cache  builtin:1000  shared:SSL:10m;\nssl_protocols  TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;\nssl_prefer_server_ciphers on;\nlocation ^~ /_dashboards {\n# Forward requests to Dashboards\nproxy_pass https://$domain_endpoint;\n# Handle redirects to Cognito\nproxy_redirect https://$cognito_host https://$host;\n# Handle redirects to Dashboards\nproxy_redirect https://$domain_endpoint https://$host;\n# Update cookie domain and path\nproxy_cookie_domain $domain_endpoint $host;\nproxy_cookie_path ~*^/$ /_dashboards/;\n# Response buffer settings\nproxy_buffer_size 128k;\nproxy_buffers 4 256k;\nproxy_busy_buffers_size 256k;\n} location ~ \\/(log|sign|fav|forgot|change|saml|oauth2|confirm) {\n# Forward requests to Cognito\nproxy_pass https://$cognito_host;\n# Handle redirects to Dashboards\nproxy_redirect https://$domain_endpoint https://$host;\n# Handle redirects to Cognito\nproxy_redirect https://$cognito_host https://$host;\nproxy_cookie_domain $cognito_host $host;\n}\n}\n</code></pre> \uc791\uc131 \ud6c4 \uc544\ub798 \uba85\ub839\uc744 \uc774\uc6a9\ud558\uc5ec Config\ub97c \uc644\uc131\ud569\ub2c8\ub2e4 <pre><code>sudo sed -i 's/my_domain_host/vpc-cognito-private-xxxxxxxxxx.us-east-1.es.amazonaws.com/' /etc/nginx/conf.d/default.conf\nsudo sed -i 's/my_cognito_host/dean-kumo-xxxxxxx.auth.us-east-1.amazoncognito.com/' /etc/nginx/conf.d/default.conf\n</code></pre></li> <li>Cognito\ub97c \uc0ac\uc6a9\ud558\uc9c0 \uc54a\ub294 \uacbd\uc6b0  /etc/nginx/conf.d/default.conf<pre><code>server { # kibana domain\nlisten 443;\nserver_name $hostname;\nrewrite ^/$ https://$host/_plugin/kibana redirect;\nset $domain_endpoint my_domain_host;\nssl_certificate /etc/nginx/cert.crt;\nssl_certificate_key /etc/nginx/cert.key;\nssl on;\nssl_session_cache builtin:1000 shared:SSL:10m;\nssl_protocols TLSv1 TLSv1.1 TLSv1.2;\nssl_ciphers HIGH:!aNULL:!eNULL:!EXPORT:!CAMELLIA:!DES:!MD5:!PSK:!RC4;\nssl_prefer_server_ciphers on;\nlocation ^~ /_plugin/kibana {\n# Forward requests to Kibana\nproxy_pass https://$domain_endpoint/_plugin/kibana;\nproxy_set_header Accept-Encoding \"\";\nsub_filter_types *;\nsub_filter $domain_endpoint $host;\nsub_filter_once off;\n# Response buffer settings\nproxy_buffer_size 128k;\nproxy_buffers 8 1024k;\nproxy_busy_buffers_size 1024k;\nproxy_read_timeout 300s;\nproxy_connect_timeout 75s;\nproxy_ignore_headers Cache-Control;\nadd_header X-Proxy-Cache $upstream_cache_status;\nadd_header Cache-Control \"public\";\n}\n}\n</code></pre></li> </ol> </li> </ul> <p>\ucd9c\ucc98: https://aws.amazon.com/premiumsupport/knowledge-center/opensearch-outside-vpc-nginx/?nc1=h_ls</p>"},{"location":"SRE/Prometheus%20and%20Grafana/","title":"Prometheus and Grafana","text":""},{"location":"SRE/Prometheus%20and%20Grafana/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>\ud504\ub85c\uba54\ud14c\uc6b0\uc2a4\uc640 \uadf8\ub77c\ud30c\ub098\ub97c \uc5f0\uacb0\ud569\ub2c8\ub2e4</li> <li>\uadf8\ub77c\ud30c\ub098\uc5d0 \ub300\uc2dc\ubcf4\ub4dc\ub97c \ucd94\uac00\ud574 \uc2dc\uac01\uc801\uc778 \uc815\ubcf4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</li> </ul>"},{"location":"SRE/Prometheus%20and%20Grafana/#db","title":"DB\ucee8\ud14c\uc774\ub108 \uc900\ube44","text":"<ol> <li> <p>\uc5ec\ud0dc \uc791\uc5c5\ud588\ub358 DB\ucee8\ud14c\uc774\ub108\ub97c \ubaa8\ub450 \uc885\ub8cc\ud569\ub2c8\ub2e4</p> <pre><code>docker stop mydb db001 db002 db003\ndocker rm mydb db001 db002 db003\n</code></pre> </li> <li> <p>Docker HOST\uc5d0 MySQL\uadf8\ub8f9\uc744 \uc0dd\uc131\ud558\uace0 mysql \uc720\uc800\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p>\uc774\ub54c \uc0ac\uc804\uc5d0 \ub9cc\ub4e0 Docker Image\uc640 \ub3d9\uc77c\ud558\uac8c GID UID\ub97c \uac16\ub3c4\ub85d \ud569\ub2c8\ub2e4</p> <p>\uc774\ub807\uac8c \ud558\uba74 \ucee8\ud14c\uc774\ub108 \uc720\uc800\uc758 GID, UID\uac00 DOCKER HOST \uc720\uc800\uc758 GID, UID\uac00 \uac19\uc544\uc9c0\uac8c \ub429\ub2c8\ub2e4</p> <pre><code>groupadd -g 1001 mysql\nuseradd -u 1001 -r -g 1001 mysql\n</code></pre> </li> <li> <p>\ud638\uc2a4\ud2b8 \ub514\ub809\ud130\ub9ac\uc758 OWNER\ub97c mysql\ub85c \ubcc0\uacbd\ud558\uace0 \uad8c\ud55c\uc744 755\ub85c \ubcc0\uacbd\ud569\ub2c8\ub2e4</p> <pre><code>chown -R mysql:mysql /db/db001 /db/db002 /db/db003\n</code></pre> </li> <li> <p>mysql57 \uc774\ubbf8\uc9c0\ub97c \uc774\uc6a9\ud574 db001 \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db001 -h db001 -p 3306:3306 --net mybridge --net-alias=db001 -v /db/db001/data:/var/lib/mysql -v /db/db001/log:/var/log/mysql -v /db/db001/conf:/etc/percona-server.conf.d -e MYSQL_ROOT_PASSWORD=\"root\" -d mysql57:0.0\n</code></pre> </li> <li> <p>mysql57 \uc774\ubbf8\uc9c0\ub97c \uc774\uc6a9\ud574 db002 \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db002 -h db002 -p 3307:3306 --net mybridge --net-alias=db002 -v /db/db002/data:/var/lib/mysql -v /db/db002/log:/var/log/mysql -v /db/db002/conf:/etc/percona-server.conf.d -e MYSQL_ROOT_PASSWORD=\"root\" -d mysql57:0.0\n</code></pre> </li> <li> <p>mysql57 \uc774\ubbf8\uc9c0\ub97c \uc774\uc6a9\ud574 db003 \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name db003 -h db003 -p 3308:3306 --net mybridge --net-alias=db003 -v /db/db003/data:/var/lib/mysql -v /db/db003/log:/var/log/mysql -v /db/db003/conf:/etc/percona-server.conf.d -e MYSQL_ROOT_PASSWORD=\"root\" -d mysql57:0.0\n</code></pre> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#prometheus","title":"Prometheus \ucee8\ud14c\uc774\ub108 \uc900\ube44","text":"<ol> <li> <p>\ud504\ub85c\uba54\ud14c\uc6b0\uc2a4\uac00 \uc0ac\uc6a9\ud560 \ub514\ub809\ud130\ub9ac\ub97c \uc900\ube44\ud569\ub2c8\ub2e4</p> <p>\ud504\ub85c\uba54\ud14c\uc6b0\uc2a4\ub294 mysql \uc720\uc800\ub85c \uc0ac\uc6a9\ud558\ub294 \uac83\uc774 \uc544\ub2c8\uae30 \ub54c\ubb38\uc5d0 \uc77c\ub2e8 777\uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>mkdir -p /db/prom001 /db/prom001/data /db/prom001/conf\nchmod 777 /db/prom001 /db/prom001/data /db/prom001/conf\n</code></pre> </li> <li> <p>\ud504\ub85c\uba54\ud14c\uc6b0\uc2a4 \uc124\uc815\ud30c\uc77c\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>cd /db/prom001/conf\nvi prometheus.yml\n</code></pre> </li> <li> <p>\uc124\uc815 \ud30c\uc77c\uc740 \uac01 \ucee8\ud14c\uc774\ub108\ubcc4 node exporter\uc6a9 job\uacfc mysqld exporter\uc6a9 job\uc744 \ub4f1\ub85d\ud558\uace0</p> <p>\uac01 \ucee8\ud14c\uc774\ub108\ubcc4\ub85c \uc5f0\uacb0 \uc815\ubcf4\ub97c \ub4f1\ub85d\ud569\ub2c8\ub2e4</p> <pre><code>global:\nscrape_interval:     5s\nevaluation_interval: 5s\nscrape_configs:\n- job_name: linux_db001\nstatic_configs:\n- targets: ['db001:9100']\nlabels:\nalias: db001\n- job_name: mysql_db001\nstatic_configs:\n- targets: ['db001:9104']\nlabels:\nalias: db001\n- job_name: linux_db002\nstatic_configs:\n- targets: ['db002:9100']\nlabels:\nalias: db002\n- job_name: mysql_db002\nstatic_configs:\n- targets: ['db002:9104']\nlabels:\nalias: db002\n- job_name: linux_db003\nstatic_configs:\n- targets: ['db003:9100']\nlabels:\nalias: db003\n- job_name: mysql_db003\nstatic_configs:\n- targets: ['db003:9104']\nlabels:\nalias: db003\n</code></pre> </li> <li> <p>9090\ud3ec\ud2b8\ub97c \uc774\uc6a9\ud574 \ud504\ub85c\uba54\ud14c\uc6b0\uc2a4 \ucee8\ud14c\uc774\ub108\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name prom001 -h prom001 --net mybridge --net-alias=prom001 -p 9090:9090 \\\n-v /db/prom001/data:/prometheus \\\n-v /db/prom001/conf:/etc/prometheus \\\n-d prom/prometheus-linux-amd64\n</code></pre> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#prometheus-mysql-db","title":"Prometheus \u2194 MySQL DB \uc5f0\uacb0","text":""},{"location":"SRE/Prometheus%20and%20Grafana/#db001","title":"db001","text":"<ol> <li> <p>db001 \ucee8\ud14c\uc774\ub108 SQL\uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db001 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>mysqld exporter\uac00 \uc0ac\uc6a9\ud560 'exporter' \uc720\uc800\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'exporter123' WITH MAX_USER_CONNECTIONS 3;\n</code></pre> </li> <li> <p>exporter \uc720\uc800\uc5d0\uac8c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\n</code></pre> </li> <li> <p>\uc0ac\uc804 \uc774\ubbf8\uc9c0 \uc791\uc5c5\ub54c \uc791\uc131\ud588\ub358 \uc178\uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud574 exporter\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker exec db001 sh /opt/exporters/node_exporter/start_node_exporter.sh\ndocker exec db001 sh /opt/exporters/mysqld_exporter/start_mysqld_exporter.sh\n</code></pre> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#db002","title":"db002","text":"<ol> <li> <p>db002 \ucee8\ud14c\uc774\ub108 SQL\uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db002 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>mysqld exporter\uac00 \uc0ac\uc6a9\ud560 'exporter' \uc720\uc800\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'exporter123' WITH MAX_USER_CONNECTIONS 3;\n</code></pre> </li> <li> <p>exporter \uc720\uc800\uc5d0\uac8c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\n</code></pre> </li> <li> <p>\uc0ac\uc804 \uc774\ubbf8\uc9c0 \uc791\uc5c5\ub54c \uc791\uc131\ud588\ub358 \uc178\uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud574 exporter\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker exec db002 sh /opt/exporters/node_exporter/start_node_exporter.sh\ndocker exec db002 sh /opt/exporters/mysqld_exporter/start_mysqld_exporter.sh\n</code></pre> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#db003","title":"db003","text":"<ol> <li> <p>db003 \ucee8\ud14c\uc774\ub108 SQL\uc11c\ubc84\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>docker exec -it -uroot db003 /bin/bash\nmysql -uroot -p\n</code></pre> </li> <li> <p>mysqld exporter\uac00 \uc0ac\uc6a9\ud560 'exporter' \uc720\uc800\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>CREATE USER 'exporter'@'localhost' IDENTIFIED BY 'exporter123' WITH MAX_USER_CONNECTIONS 3;\n</code></pre> </li> <li> <p>exporter \uc720\uc800\uc5d0\uac8c \uad8c\ud55c\uc744 \ubd80\uc5ec\ud569\ub2c8\ub2e4</p> <pre><code>GRANT PROCESS, REPLICATION CLIENT, SELECT ON *.* TO 'exporter'@'localhost';\n</code></pre> </li> <li> <p>\uc0ac\uc804 \uc774\ubbf8\uc9c0 \uc791\uc5c5\ub54c \uc791\uc131\ud588\ub358 \uc178\uc2a4\ud06c\ub9bd\ud2b8\ub97c \uc2e4\ud589\ud574 exporter\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>docker exec db003 sh /opt/exporters/node_exporter/start_node_exporter.sh\ndocker exec db003 sh /opt/exporters/mysqld_exporter/start_mysqld_exporter.sh\n</code></pre> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#prometheus_1","title":"Prometheus \uc2dc\uc791","text":"<ol> <li> <p>http://{DOCKER HOST IP}:9090 \uc5d0 \uc811\uc18d\ud558\uc5ec Prometheus GUI \ucf58\uc194\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>localhost:9090\n</code></pre> <p>Tip</p> <p>\ud83d\udca1 AWS EC2 \ud658\uacbd\uc774\uba74 \uc778\ubc14\uc6b4\ub4dc\uc5d0\uc11c 9090\ud3ec\ud2b8\ub97c \uc5f4\uc5b4\ub46c\uc57c \ud569\ub2c8\ub2e4</p> </li> <li> <p>\ud504\ub85c\uba54\ud14c\uc6b0\uc2a4 \ucf58\uc194\uc5d0 \uc815\uc0c1\uc801\uc73c\ub85c \uc811\uc18d\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uc81c\ub300\ub85c \uc815\ubcf4\ub97c \uc218\uc9d1\ud558\uace0 \uc788\ub294\uc9c0 \uc54c\uc544\ubcf4\uae30 \uc704\ud574 'up'\ucffc\ub9ac\ub97c \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucee8\ud14c\uc774\ub108\uc5d0\uc11c \uac01\uac01 \ub450 \uac1c\uc529\uc758 exporter\uac00 \uc798 \uc218\ud589\ub418\uace0 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#grafana-prometheus","title":"Grafana \u2194 Prometheus \uc5f0\uacb0","text":"<ol> <li> <p>\ud638\uc2a4\ud2b8 13000\ud3ec\ud2b8\uc5d0 \uadf8\ub77c\ud30c\ub098\ucee8\ud14c\uc774\ub108 3000\ud3ec\ud2b8\ub85c \ub9e4\ud551\ud558\uc5ec \ucee8\ud14c\uc774\ub108\ub97c \ub85c\ub4dc\ud569\ub2c8\ub2e4</p> <pre><code>docker run -i -t --name grafana -h grafana -p 13000:3000 --net mybridge --net-alias=grafana -d grafana/grafana\n</code></pre> </li> <li> <p>http://{DOCKER HOST IP}:13000 \uc5d0 \uc811\uc18d\ud558\uc5ec Grafana \ucf58\uc194\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>localhost:13000\n</code></pre> </li> <li> <p>grafana \ucd08\uae30 \ube44\ubc00\uc811\uc18d \uc815\ubcf4\ub294 username : admin / password : admin \uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uadf8\ub77c\ud30c\ub098 \ucf58\uc194\uc5d0\uc11c \ub370\uc774\ud130 \uc18c\uc2a4 \uc5f0\uacb0 \uba54\ub274\uc5d0 \uc9c4\uc785\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc0c8\ub85c\uc6b4 \ub370\uc774\ud130\uc18c\uc2a4\ub97c \ud074\ub9ad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub370\uc774\ud130\uc18c\uc2a4 \uc885\ub958\uc5d0\uc11c \ud504\ub85c\uba54\ud14c\uc6b0\uc2a4\ub97c \uc120\ud0dd\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub370\uc774\ud130 \uc218\uc2e0 \uc8fc\uc18c\uc5d0 \ud638\uc2a4\ud2b8\uc774\ub984:\ud3ec\ud2b8\ubc88\ud638 (prom001:9090) \uc744 \uc785\ub825\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Save&amp;Test\ub97c \ud074\ub9ad\ud558\uba74 \uc790\ub3d9\uc73c\ub85c \ud14c\uc2a4\ud2b8 \ud6c4 \ub370\uc774\ud130\uc18c\uc2a4\uc5d0 \uc5f0\uacb0\ud569\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"SRE/Prometheus%20and%20Grafana/#dashboard","title":"Dashboard \uc0dd\uc131","text":"<ol> <li> <p>\uc774\ubbf8 \uc0dd\uc131\ub41c Dashboard\ub97c \uc0ac\uc6a9\ud558\uae30 \uc704\ud574 \ub2e4\uc74c \uc8fc\uc18c\uc5d0 \uc811\uc18d\ud569\ub2c8\ub2e4</p> <pre><code>http://github.com/percona/grafana-dashboards/tree/master/dashboards\n</code></pre> </li> <li> <p>MySQL Overview \ub300\uc2dc\ubcf4\ub4dc\ub97c \uc0ac\uc6a9\ud558\uaca0\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud574\ub2f9 JSON\ud30c\uc77c\uc5d0\uc11c RAW\ub97c \ud074\ub9ad\ud558\uace0 \ud30c\uc77c \uc804\uccb4 \ub0b4\uc6a9\uc744 \ubcf5\uc0ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uadf8\ub77c\ud30c\ub098 \ucf58\uc194\uc5d0\uc11c  Dashboard Import\ub97c \ud074\ub9ad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubcf5\uc0ac\ud55c JSON\ud30c\uc77c\uc744 \ubd99\uc5ec\ub123\uace0 LOAD \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc124\uc815\uac12\uc744 \ud655\uc778\ud558\uace0 IMPORT \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubb54\uac00 \uc788\uc5b4\ubcf4\uc774\ub294 \ub300\uc2dc\ubcf4\ub4dc\uac00 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4. \uc774\ucc98\ub7fc \ub2e4\ub978 \uc5ec\ub7ec \ub300\uc2dc\ubcf4\ub4dc\ub97c \ub2e4\uc6b4\ubc1b\uc544 \uc0ac\uc6a9\ud574\ubcfc \uc218 \uc788\uace0, PromQL\uc744 \uc774\uc6a9\ud574 Dashboard\ub97c \uc9c1\uc811 \uc0dd\uc131\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/","title":"Terraform AWS IAM","text":""},{"location":"Terraform/Terraform%20AWS%20IAM/#iam-user","title":"IAM User","text":"<ol> <li> <p>IAM \uc791\uc5c5 \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir iam\ncd iam\n</code></pre> </li> <li> <p>\uc774\uc81c \uc790\uc5f0\uc2a4\ub7fd\uac8c provider\ub97c \uba3c\uc800 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <p>\ub2e4\ub9cc IAM\uc11c\ube44\uc2a4\ub294 \ub9ac\uc804\uc5d0 \uc885\uc18d\ub418\ub294 \uc11c\ube44\uc2a4\uac00 \uc544\ub2cc \ub9cc\ud07c \uc544\ubb34 \ub9ac\uc804\uc774\ub098 \uc9c0\uc815\ud574\ub3c4 \ub429\ub2c8\ub2e4</p> <pre><code>vi provider.tf\n</code></pre> provider.tf<pre><code>provider \"aws\"{\nregion = \"ap-northeast-2\"\n}\n</code></pre> </li> <li> <p>IAM\uc744 \ucf54\ub529\ud558\uae30 \uc704\ud55c \ud30c\uc77c\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi iam.tf\n</code></pre> </li> <li> <p>gildong.hong \uc720\uc800\ub97c \uc0dd\uc131\ud558\ub294 \ucf54\ub4dc\ub97c \uc791\uc131\ud588\uc2b5\ub2c8\ub2e4</p> iam.tf<pre><code>resource \"aws_iam_user\" \"gildong_hong\" {\nname = \"gildong.hong\"\n}\n</code></pre> </li> <li> <p>\ud14c\ub77c\ud3fc \uc0ac\uc6a9\uc744 \uc120\uc5b8\ud569\ub2c8\ub2e4</p> <pre><code>terraform init\n</code></pre> </li> <li> <p>plan\uc744 \uc2e4\ud589\ud558\uba74 \ubb38\uc81c\uac00 \uc5c6\uc74c\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>terraform plan\n</code></pre> <p></p> </li> <li> <p>\uc720\uc800\uac00 \uc798 \uc0dd\uc131\ub418\uc5c8\ub2e4\uace0 \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>IAM \ucf58\uc194\uc5d0\uc11c \uc0dd\uc131\ub41c \uc720\uc800\ub97c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud558\uc9c0\ub9cc \ud604\uc7ac \ud64d\uae38\ub3d9 \uc720\uc800\ub294 \ud328\uc2a4\uc6cc\ub4dc\uac00 \uc5c6\uae30 \ub54c\ubb38\uc5d0 \ucf58\uc194\uc5d0 \uc811\uc18d\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4 \ube44\ubc00\ubc88\ud638\uc640 MFA\ub294 \ucf58\uc194 \ub610\ub294 AWS CLI\ub97c \ud1b5\ud574 \uc9c1\uc811 \uc124\uc815\ud574\uc57c \ud569\ub2c8\ub2e4 \ud14c\ub77c\ud3fc\uc744 \uc774\uc6a9\ud574 \ube44\ubc00\ubc88\ud638\ub97c \uc0dd\uc131\ud560 \uc218\ub3c4 \uc788\uc9c0\ub9cc \uadf8\ub807\uac8c\ub418\uba74 \ucf54\ub4dc\uc5d0 \ud328\uc2a4\uc6cc\ub4dc\ub97c \ub123\uc5b4\uc57c\ud574\uc11c \ubcf4\uc548\uc774 \ub9e4\uc6b0 \ucde8\uc57d\ud574\uc9d1\ub2c8\ub2e4</p> <p>IAM \uc0ac\uc6a9\uc790\uc758 \ucd08\uae30 \uc554\ud638 \uc124\uc815</p> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/#iam-group","title":"IAM Group","text":"<ol> <li>\uc21c\uc11c\ub294 \uadf8\ub8f9 \uc0dd\uc131 \u2192 \uba64\ubc84\uc2ed \uc0dd\uc131 \u2192 '\uba64\ubc84\uc2ed\uc744 \uadf8\ub8f9\uc5d0 \uc5f0\uacb0' \uc785\ub2c8\ub2e4</li> <li> <p>\uadf8\ub8f9 \uc0dd\uc131 \ucf54\ub4dc \uc791\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>vi user_group.tf\n</code></pre> </li> <li> <p>\ucf54\ub4dc \ub0b4\uc6a9\uc744 \ub2e4\uc74c\ucc98\ub7fc \ud544\uc218\uc694\uc18c\ub9cc \ub123\uc5b4\uc90d\ub2c8\ub2e4</p> user_group.tf<pre><code>resource \"aws_iam_group\" \"test_group\"{\nname = \"terra_group\"\n}\n</code></pre> </li> <li> <p>plan\ud574\ubcf4\uace0 \ubb38\uc81c \uc5c6\uc73c\uba74 \ubc14\ub85c apply \ud569\ub2c8\ub2e4</p> <p></p> <pre><code>terraform plan\nterraform apply\n</code></pre> </li> <li> <p>\uc5d0\ub7ec\uc5c6\uc774 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c\ub3c4 \ubc29\uae08 \ub9cc\ub4e0 \ub530\ub048\ud55c \uadf8\ub8f9\uc744 \ucc3e\uc744 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ubc88\uc5d4 \uadf8\ub8f9\uc5d0 \uc720\uc800\ub97c \ucd94\uac00\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>vi user_group.tf\n</code></pre> </li> <li> <p>\ucf54\ub4dc\ub294 \ub2e4\uc74c\uacfc \uac19\uc740 \ud615\ud0dc\uac00 \ub429\ub2c8\ub2e4</p> user_group.tf<pre><code>resource \"aws_iam_group\" \"test_group\"{\nname = \"terra_group\"\n}\nresource \"aws_iam_group_membership\" \"terra_group\"{\nname = aws_iam_group.test_group.name\nusers = [\naws_iam_user.gildong_hong.name\n]\ngroup = aws_iam_group.test_group.name\n}\n</code></pre> </li> <li> <p>plan\uc5d0 \ubb38\uc81c\uac00 \uc5c6\uc73c\ub2c8 \ubc14\ub85c apply \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uadf8\ub8f9 \uba64\ubc84\uc2ed\uc774 \uc798 \uc801\uc6a9\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud64d\uae38\ub3d9\uc774 \uadf8\ub8f9\uc5d0 \uc798 \uac00\uc785\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/#iam-role","title":"IAM Role","text":"<ol> <li>\uc5ed\ud560\uc0dd\uc131\uc740 \ub2e4\uc74c \uc21c\uc11c\ub85c \uc9c4\ud589\ub429\ub2c8\ub2e4<ul> <li>\uc5ed\ud560 \uc0dd\uc131 \u2192 \uc815\ucc45 \uc0dd\uc131 \u2192 \uc5ed\ud560\uacfc \uc815\ucc45 \ub9e4\ud551</li> <li>\ucd1d 3\uac1c\uc758 \ub9ac\uc18c\uc2a4\ub85c \uc774\ub904\uc9d1\ub2c8\ub2e4</li> </ul> </li> <li> <p>'hello' \uc774\ub984\uc744 \uac00\uc9c0\ub294 \uc5ed\ud560\uc0dd\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>vi iam_role_hello.tf\n</code></pre> </li> <li> <p>\uc5ed\ud560 \uc124\uc815 \ucf54\ub4dc\ub294 \uad8c\ud55c \uc815\ucc45\uc774 \ud3ec\ud568\ub429\ub2c8\ub2e4</p> iam_role_hello.tf<pre><code>resource \"aws_iam_role\" \"hello\" {\nname                    = \"hello-iam-role\"\npath                    = \"/\"\nassume_role_policy      = &lt;&lt;EOF\n{\n        \"Version\" : \"2012-10-17\",\n        \"Statement\" : [\n        {\n        \"Sid\" : \"\",\n        \"Effect\" : \"Allow\",\n        \"Principal\" : {\n                \"Service\" : \"ec2.amazonaws.com\"\n        },\n        \"Action\" : \"sts:AssumeRole\"\n        }\n        ]\n}\nEOF\n}\n</code></pre> </li> <li> <p>plan\uc740 \uc131\uacf5\uc801\uc73c\ub85c \ub9c8\ucce4\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc14\ub85c apply \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\uc5ed\ud560\uc774 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c \uc5ed\ud560\uc5d0 \uad8c\ud55c\uc774 \ubd80\uc5ec\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>edit trust relationship\uc744 \ud074\ub9ad\ud558\uba74 \uc815\ucc45\uc744 JSON\uc73c\ub85c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ubc88\uc5d0\ub294 Permission\uc744 \ucd94\uac00\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>vi iam_role_hello.tf\n</code></pre> </li> <li> <p>\ub2e4\uc74c \ub0b4\uc6a9\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p>\uc815\ucc45\uc744 \ub9cc\ub4e0 \ud6c4 Role\uc5d0 \ub9e4\ud551\ud558\ub294 \uad6c\uc870\uac00 \ub429\ub2c8\ub2e4</p> iam_role_hello.tf<pre><code>resource \"aws_iam_role_policy\" \"hello_s3\"{\nname   = \"hello-s3-download\"\nrole   = aws_iam_role.hello.id\npolicy = &lt;&lt;EOF\n{\n    \"Statement\" : [\n        {\n            \"Sid\" : \"AllowAppArtifactsReadAccess\",\n            \"Action\" : [\n                \"s3:GetObject\"\n            ],\n            \"Resource\" : [\n            \"*\"\n            ],\n            \"Effect\" : \"Allow\"\n        }\n        ]\n}\nEOF\n}\nresource \"aws_iam_instance_profile\" \"hello\"{\nname = \"hello-profile\"\nrole = aws_iam_role.hello.name\n}\n</code></pre> </li> <li> <p>plan\uc5d0\uc11c \uc815\ucc45\uc774 \uc798 \ucd94\uac00\ub418\uba74 apply \uc9c4\ud589\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uad8c\ud55c\uc774 \uc798 \ubd99\uc740\uac83\uc744 \ucf58\uc194\uc5d0\uc11c \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>Iam_instance_profile \ub9ac\uc18c\uc2a4\ub294 \ub2e4\uc74c \uc5ed\ud560\uc744 \uc218\ud589\ud569\ub2c8\ub2e4</p> <p>Tip</p> <p>\ud83d\udca1 IAM \uc5ed\ud560\uc744 \uc704\ud55c \ucee8\ud14c\uc774\ub108\ub85c \uc778\uc2a4\ud134\uc2a4 \uc2dc\uc791\uc2dc EC2\uc5d0 \uc5ed\ud560 \uc815\ubcf4 \uc804\ub2ec\uc5d0 \uc0ac\uc6a9\ud55c\ub2e4 EC2\uc5d0 IAM Role\uc744 \ud560\ub2f9\ud558\ub824\uba74 \uc774 \ub9ac\uc18c\uc2a4\uac00 \ud544\uc694\ud55c, \ud14c\ub77c\ud3fc\ub9cc\uc758 \ud2b9\uc9d5\uc785\ub2c8\ub2e4</p> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/#iam-policy","title":"IAM Policy","text":"<ol> <li>AWS\uac00 \uc81c\uacf5\ud558\ub294 Policy\uac00 \ub9e4\uc6b0 \ub9ce\uc9c0\ub9cc, \uadf8\ub798\ub3c4 Customer\uac00 \uc9c1\uc811 \ucee8\ud2b8\ub864 \ud558\ub294 \uac83\uc774 \ud0c0\uc774\ud2b8\ud55c \uad8c\ud55c \uad00\ub9ac\uac00 \uac00\ub2a5\ud558\uae30 \ub54c\ubb38\uc5d0 \uc774\ub97c \uad8c\uc7a5\ud569\ub2c8\ub2e4</li> <li> <p>\ub530\ub77c\uc11c \uc774\ubc88\uc5d4 \ud64d\uae38\ub3d9 \uc720\uc800\uc5d0\uac8c Customer Managed \uad8c\ud55c\uc744 \ubd80\uc5ec\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>vi iam.tf\n</code></pre> </li> <li> <p>\ub2e4\uc74c \ucf54\ub4dc\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p>IAM user\uc5d0 \ud560\ub2f9\ud560 super-admin\uc774\ub77c\ub294 policy\ub97c \ucd94\uac00\ud588\uc2b5\ub2c8\ub2e4</p> iam.tf<pre><code>resource \"aws_iam_user_policy\" \"art_devops_black\" {\nname  = \"super-admin\"\nuser  = aws_iam_user.gildong_hong.name\npolicy = &lt;&lt;EOF\n{\n    \"Version\": \"2012-10-17\",\n    \"Statement\": [\n        {\n            \"Effect\": \"Allow\",\n            \"Action\": [\n                \"*\"\n            ],\n            \"Resource\": [\n                \"*\"\n            ]\n        }\n    ]\n}\nEOF\n}\n</code></pre> </li> <li> <p>\ud14c\ub77c\ud3fc\uc5d0\uc11c plan\uc740 \uc88b\uc740 \uc2b5\uad00\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\uc0c1 \uc5c6\uc73c\uba74 \ubc14\ub85c \uc801\uc6a9\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\ud64d\uae38\ub3d9\uc5d0\uac8c super-admin \uc815\ucc45\uc774 \uc798 \ubd99\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uadf8\ub8f9\uc815\ucc45\uc744 \uc124\uc815\ud560 \ub54c\ub294 aws iam user policy \ub300\uc2e0 aws_iam_group_policy\ub97c \uc124\uc815\ud569\ub2c8\ub2e4</p> <pre><code>aws_iam_group_policy\n</code></pre> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/#ec2-role","title":"EC2-Role","text":"<ol> <li>EC2\uc5d0 \ud0a4\ub97c \uc9c1\uc811 \ubcf4\uad00\ud558\ub294\uac83\uc744 \ubcf4\uc548\uc0c1 \uc88b\uc9c0 \uc54a\uae30 \ub54c\ubb38\uc5d0 EC2\uc5d0 \uc5ed\ud560\uc744 \ud560\ub2f9\ud574 \uc4f0\ub294\uac83\uc774 \uad8c\uc7a5\ub429\ub2c8\ub2e4</li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc4f0\uba74 AK, SK\uac00 \uadf8\ub300\ub85c \ub178\ucd9c\ub418\ub294\uac83\uc744 \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>cat ~/.aws/credentials\n</code></pre> </li> <li> <p>\ub530\ub77c\uc11c \uc774 \uac12\uc744 \ubaa8\ub450 \uc0ad\uc81c\ud558\uace0</p> <pre><code>rm -rf ~/.aws/credentials\n</code></pre> </li> <li> <p>\uad8c\ud55c\uc774 \uc798 \uc81c\uac70\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>ec2 \ucf58\uc194\uc5d0\uc11c \uc5ed\ud560 \uc124\uc815\uc744 \ud074\ub9ad\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc544\uae4c \ub9cc\ub4e0 hello profile\uc744 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\ub85c\uc368 \uc778\uc2a4\ud134\uc2a4\uc5d0 \ud0a4\ub97c \ubcf4\uad00\ud558\uc9c0 \uc54a\uace0 \uc548\uc804\ud558\uac8c \uad8c\ud55c\uc774 \uc798 \ubd80\uc5ec\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub514\ub809\ud130\ub9ac \ub0b4 \ud604\uc7ac\uae4c\uc9c0 \uc791\uc131\ub41c \ubaa8\ub4e0 \ub9ac\uc18c\uc2a4\ub97c \ubcf4\uace0 \uc2f6\uc73c\uba74 \ub2e4\uc74c \uba85\ub839\uc73c\ub85c \uc870\ud68c\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>terraform state list\n</code></pre> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20AWS%20IAM/#link","title":"Link","text":"<ul> <li>\ubc18\ub4dc\uc2dc \uc77d\uc5b4\ubcfc \uac83</li> </ul> <p>\uc815\ucc45 \ud3c9\uac00 \ub85c\uc9c1</p>"},{"location":"Terraform/Terraform%20Backend/","title":"Terraform Backend","text":""},{"location":"Terraform/Terraform%20Backend/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>Terraform\uc758 Backend \uae30\ub2a5\uc744 \uc774\uc6a9\ud574 state\ud30c\uc77c\uc744 \uc548\uc804\ud558\uac8c \uad00\ub9ac\ud574\ubd05\ub2c8\ub2e4.</li> <li>.tfstate\ub97c \ub85c\uceec\uc774 \uc544\ub2cc S3\uc5d0 \uc800\uc7a5\ud558\uace0 DynamoDB\ub97c \uc774\uc6a9\ud574 \ud30c\uc77c\uc744 Locking\ud569\ub2c8\ub2e4</li> <li> <p>Backend\ub97c \uc774\uc6a9\ud568\uc5d0 \ub530\ub978 \uc774\uc810</p> <ul> <li> <p>Locking</p> <p>\ud611\uc5c5\uc2dc \uc6d0\uaca9 \uc800\uc7a5\uc18c\ub97c \uc0ac\uc6a9\ud558\uc5ec \uc5ec\ub7ec\uba85\uc774 \ub3d9\uc2dc\uc5d0 \uac19\uc740 state \uc811\uadfc\ud558\ub294\uac83\uc744 \ub9c9\uc2b5\ub2c8\ub2e4</p> </li> <li> <p>Backup</p> <p>\uc6d0\uaca9\uc800\uc7a5\uc18c\uc5d0 \uc800\uc7a5\ud568\uc73c\ub85c\uc368 \ub370\uc774\ud130 \uc720\uc2e4\uc744 \ubc29\uc9c0\ud569\ub2c8\ub2e4. \ud2b9\ud788 S3\uc5d0 \uc800\uc7a5\ud558\ub294 \ubc29\ubc95\uc740 \ubc84\uc804\uad00\ub9ac\uac00 \uac00\ub2a5\ud55c \ud3b8\ub9ac\ud558\uace0 \uc548\uc804\ud55c \ubc29\ubc95\uc785\ub2c8\ub2e4.</p> </li> </ul> </li> </ul>"},{"location":"Terraform/Terraform%20Backend/#backend","title":"Backend \uc900\ube44","text":"<ol> <li> <p>\uc791\uc5c5\uc744 \uc704\ud55c \ub514\ub809\ud130\ub9ac\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>mkdir init\ncd init\n</code></pre> </li> <li> <p>\ubc31\uc5d4\ub4dc\uc5d0 \uc0ac\uc6a9\ud560 S3\ubc84\ud0b7\uacfc DynamoDB \ud14c\uc774\ube14\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi init.tf\n</code></pre> init.if<pre><code>provider \"aws\" {\nregion = \"ap-northeast-2\" # Please use the default region ID\nversion = \"~&gt; 2.49.0\" # Please choose any version or delete this line if you want the latest version\n}\n# S3 bucket for backend\nresource \"aws_s3_bucket\" \"tfstate\" {\nbucket = \"ljw-terra-backend\" #Global Unique\nversioning {\nenabled = true # Prevent from deleting tfstate file\n}\n}\n# DynamoDB for terraform state lock\n######### DO NOT TOUCH #############\nresource \"aws_dynamodb_table\" \"terraform_state_lock\" {\nname           = \"terraform-lock\"\nhash_key       = \"LockID\"\nbilling_mode   = \"PAY_PER_REQUEST\"\nattribute {\nname = \"LockID\"\ntype = \"S\"\n}\n}\n######### DO NOT TOUCH #############\n</code></pre> </li> <li> <p>plan\uc5d0 \ub530\ub974\uba74 \ub450 \uac1c\uc758 \ub9ac\uc18c\uc2a4\uac00 \uc0dd\uc131\ub428\uc744 \uc548\ub0b4\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4     <pre><code>terraform plan\n</code></pre></p> <p></p> </li> <li> <p>\uc758\ub3c4\ud55c \ubc14\uac00 \ub9de\uc73c\ub2c8 \uc801\uc6a9\ud574\uc90d\ub2c8\ub2e4     <pre><code>terraform apply\n</code></pre></p> <p></p> </li> <li> <p>\ubc84\ud0b7\uacfc \ud14c\uc774\ube14\uc774 \uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4      </p> </li> </ol>"},{"location":"Terraform/Terraform%20Backend/#backend_1","title":"Backend \uc801\uc6a9","text":"<ol> <li>iam\uc744 \uc81c\uc5b4\ud558\ub294 \ucf54\ub4dc\ub97c \ubc31\uc5d4\ub4dc\ub85c \uad00\ub9ac\ud574\ubd05\ub2c8\ub2e4</li> <li> <p>\uc791\uc5c5\uc911\uc778 \ud3f4\ub354(init)\uc5d0\uc11c \ub098\uc640\uc11c iam \ub514\ub809\ud130\ub9ac\ub85c \uc774\ub3d9\ud569\ub2c8\ub2e4</p> <pre><code>cd ../iam\n</code></pre> </li> <li> <p>\ubc31\uc5d4\ub4dc\ub85c \uc81c\uc5b4\ud558\uae30 \uc704\ud574 \ucf54\ub4dc\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi backend.tf\n</code></pre> </li> <li> <p>\ubc31\uc5d4\ub4dc\ub85c S3\ub97c \uc0ac\uc6a9\ud558\uace0 DynamoDB\ub97c \uc774\uc6a9\ud574 Lock \ud560 \uac83\uc744 \uba85\uc2dc\ud569\ub2c8\ub2e4</p> backend.tf<pre><code>terraform {\nbackend \"s3\" {\nbucket         = \"ljw-terra-backend\"\nkey            = \"terraform_source/iam/terraform.tfstate\"\n                    #s3\ub0b4 \uacbd\ub85c\ub294 \ud604\uc7ac \uacbd\ub85c\uc640 \uc77c\uce58 \uc2dc\ud0a4\ub294 \uac83\uc774 \uad00\ub9ac\ud558\uae30 \ud3b8\ub9ac\ud569\ub2c8\ub2e4\nregion         = \"ap-northeast-2\"\nencrypt        = true\ndynamodb_table = \"terraform-lock\"\n}\n}\n</code></pre> </li> <li> <p>s3\ub0b4 \uacbd\ub85c\ub294 \ud604\uc7ac \uacbd\ub85c\uc640 \uc77c\uce58 \uc2dc\ud0a4\ub294\uac83\uc774 \uad00\ub9ac\ud558\uae30 \ud3b8\ub9ac\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc31\uc5d4\ub4dc \uc124\uc815 \ud6c4\uc5d0\ub294 \ub2e4\uc2dc init \ud558\ub294 \uacfc\uc815\uc774 \ud544\uc694\ud569\ub2c8\ub2e4</p> <pre><code>terraform init\n</code></pre> <p></p> </li> <li> <p>\ub85c\uceec \ud30c\uc77c\uc744 S3\uc5d0 \uc5c5\ub85c\ub4dc \ud558\ub294\uac83\uc5d0 \ub300\ud574 \ub3d9\uc758\uc5ec\ubd80\ub97c \ubb3b\uc2b5\ub2c8\ub2e4. yes</p> <p></p> </li> <li> <p>\uc5c5\ub85c\ub4dc\uac00 \uc644\ub8cc\ub418\uba74 init\uc744 \uc5d0\ub7ec\uc5c6\uc774 \uc798 \ub9c8\uce58\uac8c \ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\uc81c \ub85c\uceec\uc5d0 \uc788\ub294 tfstate\ud30c\uc77c\ub4e4\uc740 \uc4f8\ubaa8\uac00 \uc5c6\uc2b5\ub2c8\ub2e4(legacy)</p> <p></p> </li> <li> <p>\uc774\uc81c s3\uc5d0 \uc5c5\ub85c\ub4dc \ub41c tfstate\ud30c\uc77c\uc744 \uc0ac\uc6a9\ud558\uae30 \ub584\ubb38\uc785\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc774\uc81c \ub85c\uceec\uc5d0 tfstate \ud30c\uc77c\uc774 \uc5c6\uc5b4\ub3c4 plan\uc774 \uc798 \ub3d9\uc791\ud569\ub2c8\ub2e4</p> <pre><code>rm -rf terraform.tfstate terraform.tfstate.backup\nterraform plan\n</code></pre> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20Practice/","title":"Terraform Practice","text":"\ud83d\udca1 \ud14c\ub77c\ud3fc\uc744 \uc544\ud0a4\ud14d\ucc98\ub97c \uc5f0\uc2b5\ud574\ubd05\ub2c8\ub2e4   <ul> <li> <p>EC2\uc5d0 SSH \uc811\uc18d\uc744 \uc704\ud55c \ud0a4\ud398\uc5b4 \uc0dd\uc131</p> <ol> <li>\ube44\ubc00\ud0a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</li> </ol> <pre><code>ssh-keygen -t rsa -b 2048 -f ~/dotoryeee.pem -q -P </code></pre> <ol> <li>pem\uc744 \uc0ac\uc6a9\ud558\ub824\uba74 \uad8c\ud55c\uc744 \uc218\uc815\ud574\uc57c \ud569\ub2c8\ub2e4</li> </ol> <pre><code>chmod 400 ~/dotoryeee.pem\n</code></pre> <ol> <li>AWS\uc5d0 \ub118\uaca8\uc904 \uacf5\uac1c\ud0a4\ub97c \uc0dd\uc131\ud569\ub2c8\ub2e4</li> </ol> <pre><code>ssh-keygen -y -f ~/dotoryeee.pem &gt; ~/dotoryeee.pub\n</code></pre> </li> <li> <p>Terraform Docs</p> <p></p> </li> <li> <p>\uc5d0\ub7ec\uac00 \uc790\uc8fc \ub0ac\ub358 \ubd80\ubd84</p> <ol> <li>EC2 t2.micro\ub294 \uc11c\uc6b8\uae30\uc900 2a, 2c\uc5d0\uc11c\ub9cc \uc9c0\uc6d0\ub429\ub2c8\ub2e4</li> <li>VPC \uc0ac\uc774\ub354 \ubc94\uc704\uac00 \uc11c\ube0c\ub137\ubcf4\ub2e4 \ub113\uc740\uc9c0 \ud655\uc778</li> <li>MySQL RDS\uc0dd\uc131\uc2dc allocated_storage\uac12\uc5d0 0\uc740 \ubd88\uac00\ub2a5</li> <li>DB\uc778\uc2a4\ud134\uc2a4\ub294 \ubcc4\ub3c4\ub85c \uc11c\ube0c\ub137 \uadf8\ub8f9\uc744 \uc0dd\uc131\ud574\uc57c \ud568</li> </ol> <pre><code>Error: Error creating DB Instance: InvalidParameterCombination: The DB instance and EC2 security group are in different VPCs. The DB instance is in vpc-7ae25b11 and the EC2 security group is in vpc-07d48e73dba07404a\nstatus code: 400, request id: 25f97e75-89d9-4323-9cd3-b09e83675d4e on [rds.tf](http://rds.tf/) line 16, in resource \"aws_db_instance\" \"rds\":\n16: resource \"aws_db_instance\" \"rds\" {\n</code></pre> <ol> <li>RDS\ub294 \ubc18\ub4dc\uc2dc \uc11c\ube0c\ub137 2\uac1c \uc774\uc0c1\uc744 \ubb36\uc5b4\uc11c \uad6c\uc131</li> <li>\ubca0\uc2a4\ucc9c \ud638\uc2a4\ud2b8 \uc0ac\uc6a9\ud558\ub294 RDS\ub294 \ub2f9\uc5f0\uc2dc \ud37c\ube14\ub9ad \uc5d1\uc138\uc2a4 \uc81c\ud55c</li> </ol> <pre><code>Error: Error creating DB Instance: InvalidVPCNetworkStateFault: Cannot create a publicly accessible DBInstance.  The specified VPC does not support DNS resolution, DNS hostnames, or both. Update the VPC and then try again\nstatus code: 400, request id: d26672f9-7f0a-40ac-9e17-6fd0b9fa2558\n</code></pre> <ol> <li>ssh \uc811\uc18d\uc744 \uc704\ud55c map_public_ip_on_launch (\uc11c\ube0c\ub137) \ub2f9\uc5f0\ud788 true</li> <li> <p>RDS\ub294 \uc0dd\uc131\uc5d0 \uc624\ub79c \uc2dc\uac04\uc774 \uac78\ub9ac\ub294 \uc810 \uc720\uc758</p> <p></p> </li> <li> <p>\ubcf4\uc548\uadf8\ub8f8 \uc774\ub984\uc740 \uc18c\ubb38\uc790 sg\ub85c \uc2dc\uc791\ud560 \uc218 \uc5c6\uc74c</p> </li> <li>RDS \ubcf4\uc548\uadf8\ub8f9\uc740 security_group_names \ub300\uc2e0 vpc_security_group_ids \uc0ac\uc6a9</li> </ol> <pre><code>Error: Error creating DB Instance: InvalidParameterCombination: DB Security Groups can only be associated with VPC DB Instances using API versions 2012-01-15 through 2012-09-17.\n</code></pre> </li> </ul>"},{"location":"Terraform/Terraform%20Practice/#1-vpc-subnets-ec2-igw","title":"\uc5f0\uc2b51 (VPC, Subnets, EC2, IGW)","text":"<ul> <li> <p>\uad6c\uc131</p> <p></p> </li> <li> <p>\ucf54\ub4dc</p> <pre><code>#---------------VPC-----------------\nresource \"aws_vpc\" \"main\" {\ncidr_block = \"10.0.0.0/16\"\ninstance_tenancy = \"default\" #\uc804\uc6a9\uc778\uc2a4\ud134\uc2a4 \uc0ac\uc6a9, default\ub294 \uc0ac\uc6a9 \ud558\uc9c0 \uc54a\uc74c\uc744 \uc758\ubbf8\nenable_dns_hostnames = true\ntags = {\nName = \"vpc_practice_01\"\n}\n}\n#---------------IGW-----------------\nresource \"aws_internet_gateway\" \"default\" {\nvpc_id = aws_vpc.main.id\ntags = {\nName = \"igw_practice_01\"\n}\n}\n#---------------Subnet-----------------\nresource \"aws_subnet\" \"public_01\" {\nvpc_id = aws_vpc.main.id\ncidr_block = \"10.0.0.0/24\"\navailability_zone = \"ap-northeast-2a\"\nmap_public_ip_on_launch = true\ntags = {\nName = \"public_subnet_01\"\n}\n}\nresource \"aws_subnet\" \"public_02\" {\nvpc_id = aws_vpc.main.id\ncidr_block = \"10.0.1.0/24\"\navailability_zone = \"ap-northeast-2c\"\nmap_public_ip_on_launch = true\ntags = {\nName = \"public_subnet_02\"\n}\n}\n#--------------Association--------------\nresource \"aws_route_table_association\" \"public_01_association\" {\nsubnet_id = aws_subnet.public_01.id\nroute_table_id = aws_route_table.public.id\n}\nresource \"aws_route_table_association\" \"public_02_association\" {\nsubnet_id = aws_subnet.public_02.id\nroute_table_id = aws_route_table.public.id\n}\n#-------------Route table---------------\nresource \"aws_route_table\" \"public\" {\nvpc_id = aws_vpc.main.id\ntags = {\nName = \"public_route_table\"\n}\n}\n#-----------Route table Routes------------\nresource \"aws_route\" \"public_sub_IGW\" {\nroute_table_id = aws_route_table.public.id\ndestination_cidr_block = \"0.0.0.0/0\"\ngateway_id = aws_internet_gateway.default.id\n}\n#----------Security Group for EC2----------\nresource \"aws_security_group\" \"practice_01\" {\nvpc_id = aws_vpc.main.id\nname = \"practice_01_SG\"\ndescription = \"SG_for_EC2\"\n    #-----------\uc778\ubc14\uc6b4\ub4dc-----------\ningress {\nfrom_port = 22\nto_port = 22\nprotocol = \"tcp\"\ncidr_blocks = [\"0.0.0.0/0\"]\ndescription = \"open SSH from Anywhere\"\n}\n    #----------\uc544\uc6c3\ubc14\uc6b4\ub4dc-----------\negress {\nfrom_port = 0 #\ubaa8\ub4e0 \ud3ec\ud2b8\nto_port = 0 protocol = \"-1\" #\ubaa8\ub4e0 \ud504\ub85c\ud1a0\ucf5c\ncidr_blocks = [\"0.0.0.0/0\"] #\ub9ac\uc2a4\ud2b8 \ud615\ud0dc\ub3c4 \uac00\ub2a5\ndescription = \"open all port from anywhere\"\n}\n}\n#----------ready Public Key--------------\nresource \"aws_key_pair\" \"practice_01\" {\nkey_name = \"practice_01\"\npublic_key = \"ssh-rsa...... \ud0a4 \uc0ad\uc81c\"\n}\n#---------public_01  EC2 Instance---------\nresource \"aws_instance\" \"dotoryeee-EC2-01\" {\nami = \"ami-006e2f9fa7597680a\"\ninstance_type = \"t2.micro\"\nsubnet_id = aws_subnet.public_01.id\nkey_name = aws_key_pair.practice_01.key_name\nsecurity_groups = [aws_security_group.practice_01.id]\ntags = {\nName = \"doto_EC2_01\"\n}\n}\n#---------public_02  EC2 Instance---------\nresource \"aws_instance\" \"dotoryeee-EC2-02\" {\nami = \"ami-006e2f9fa7597680a\"\ninstance_type = \"t2.micro\"\nsubnet_id = aws_subnet.public_02.id\nkey_name = aws_key_pair.practice_01.key_name\nsecurity_groups = [aws_security_group.practice_01.id]\ntags = {\nName = \"doto_EC2_02\"\n}\n}\n</code></pre> </li> <li> <p>terraform apply</p> <pre><code>An execution plan has been generated and is shown below.\nResource actions are indicated with the following symbols:\n+ create\nTerraform will perform the following actions:\n# aws_instance.dotoryeee-EC2-01 will be created\n+ resource \"aws_instance\" \"dotoryeee-EC2-01\" {\n+ ami                          = \"ami-006e2f9fa7597680a\"\n+ arn                          = (known after apply)\n+ associate_public_ip_address  = (known after apply)\n+ availability_zone            = (known after apply)\n+ cpu_core_count               = (known after apply)\n+ cpu_threads_per_core         = (known after apply)\n+ get_password_data            = false\n+ host_id                      = (known after apply)\n+ id                           = (known after apply)\n+ instance_state               = (known after apply)\n+ instance_type                = \"t2.micro\"\n+ ipv6_address_count           = (known after apply)\n+ ipv6_addresses               = (known after apply)\n+ key_name                     = \"practice_01\"\n+ outpost_arn                  = (known after apply)\n+ password_data                = (known after apply)\n+ placement_group              = (known after apply)\n+ primary_network_interface_id = (known after apply)\n+ private_dns                  = (known after apply)\n+ private_ip                   = (known after apply)\n+ public_dns                   = (known after apply)\n+ public_ip                    = (known after apply)\n+ secondary_private_ips        = (known after apply)\n+ security_groups              = (known after apply)\n+ subnet_id                    = (known after apply)\n+ tags                         = {\n+ \"Name\" = \"doto_EC2_01\"\n}\n+ tenancy                      = (known after apply)\n+ vpc_security_group_ids       = (known after apply)\n+ ebs_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ snapshot_id           = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n+ enclave_options {\n+ enabled = (known after apply)\n}\n+ ephemeral_block_device {\n+ device_name  = (known after apply)\n+ no_device    = (known after apply)\n+ virtual_name = (known after apply)\n}\n+ metadata_options {\n+ http_endpoint               = (known after apply)\n+ http_put_response_hop_limit = (known after apply)\n+ http_tokens                 = (known after apply)\n}\n+ network_interface {\n+ delete_on_termination = false\n+ device_index          = 0\n+ network_interface_id  = (known after apply)\n}\n+ root_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n}\n# aws_instance.dotoryeee-EC2-02 will be created\n+ resource \"aws_instance\" \"dotoryeee-EC2-02\" {\n+ ami                          = \"ami-006e2f9fa7597680a\"\n+ arn                          = (known after apply)\n+ associate_public_ip_address  = (known after apply)\n+ availability_zone            = (known after apply)\n+ cpu_core_count               = (known after apply)\n+ cpu_threads_per_core         = (known after apply)\n+ get_password_data            = false\n+ host_id                      = (known after apply)\n+ id                           = (known after apply)\n+ instance_state               = (known after apply)\n+ instance_type                = \"t2.micro\"\n+ ipv6_address_count           = (known after apply)\n+ ipv6_addresses               = (known after apply)\n+ key_name                     = \"practice_01\"\n+ outpost_arn                  = (known after apply)\n+ password_data                = (known after apply)\n+ placement_group              = (known after apply)\n+ primary_network_interface_id = (known after apply)\n+ private_dns                  = (known after apply)\n+ private_ip                   = (known after apply)\n+ public_dns                   = (known after apply)\n+ public_ip                    = (known after apply)\n+ secondary_private_ips        = (known after apply)\n+ security_groups              = (known after apply)\n+ subnet_id                    = (known after apply)\n+ tags                         = {\n+ \"Name\" = \"doto_EC2_02\"\n}\n+ tenancy                      = (known after apply)\n+ vpc_security_group_ids       = (known after apply)\n+ ebs_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ snapshot_id           = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n+ enclave_options {\n+ enabled = (known after apply)\n}\n+ ephemeral_block_device {\n+ device_name  = (known after apply)\n+ no_device    = (known after apply)\n+ virtual_name = (known after apply)\n}\n+ metadata_options {\n+ http_endpoint               = (known after apply)\n+ http_put_response_hop_limit = (known after apply)\n+ http_tokens                 = (known after apply)\n}\n+ network_interface {\n+ delete_on_termination = false\n+ device_index          = 0\n+ network_interface_id  = (known after apply)\n}\n+ root_block_device {\n+ delete_on_termination = (known after apply)\n+ device_name           = (known after apply)\n+ encrypted             = (known after apply)\n+ iops                  = (known after apply)\n+ kms_key_id            = (known after apply)\n+ tags                  = (known after apply)\n+ throughput            = (known after apply)\n+ volume_id             = (known after apply)\n+ volume_size           = (known after apply)\n+ volume_type           = (known after apply)\n}\n}\n# aws_internet_gateway.default will be created\n+ resource \"aws_internet_gateway\" \"default\" {\n+ arn      = (known after apply)\n+ id       = (known after apply)\n+ owner_id = (known after apply)\n+ tags     = {\n+ \"Name\" = \"igw_practice_01\"\n}\n+ vpc_id   = (known after apply)\n}\n# aws_key_pair.practice_01 will be created\n+ resource \"aws_key_pair\" \"practice_01\" {\n+ arn         = (known after apply)\n+ fingerprint = (known after apply)\n+ id          = (known after apply)\n+ key_name    = \"practice_01\"\n+ key_pair_id = (known after apply)\n+ public_key  = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDD5D5mHSD/vdgcGmh6Kd57DqLxebcvbrUsHj8DYDW0+9MSvvK874Bm4hpqHliYze/ht7VnzL5+A5qZkCevKGBDeJNmR/QDHccCsCfRuyEmzMlvj3SxzYSH2N4lBG6eZZbQ+0yRl7ny3aeyol5boDkztLZ/PZwVR5IH6BgsNiGClSDtuf2CYoKN7hQufjeuCDcLlQa+ItFa4abMe/mWtMeEh7+ZpC+0KAFFvqY80OCtuUdqq7tcP8uHzQy9mPKvKBieJYitUoStjFEMAro1v34u6193Qgk6DAhyMom4GmLc2+tTyKMsvBlRKUOb87F+2zsATX3Ahz9cMpEkfPTkY15V dotoryeee@i5-6500\"\n}\n# aws_network_interface.public_01 will be created\n+ resource \"aws_network_interface\" \"public_01\" {\n+ id                 = (known after apply)\n+ ipv6_address_count = (known after apply)\n+ ipv6_addresses     = (known after apply)\n+ mac_address        = (known after apply)\n+ outpost_arn        = (known after apply)\n+ private_dns_name   = (known after apply)\n+ private_ip         = (known after apply)\n+ private_ips        = (known after apply)\n+ private_ips_count  = (known after apply)\n+ security_groups    = (known after apply)\n+ source_dest_check  = true\n+ subnet_id          = (known after apply)\n+ tags               = {\n+ \"Name\" = \"interface_public_01\"\n}\n+ attachment {\n+ attachment_id = (known after apply)\n+ device_index  = (known after apply)\n+ instance      = (known after apply)\n}\n}\n# aws_network_interface.public_02 will be created\n+ resource \"aws_network_interface\" \"public_02\" {\n+ id                 = (known after apply)\n+ ipv6_address_count = (known after apply)\n+ ipv6_addresses     = (known after apply)\n+ mac_address        = (known after apply)\n+ outpost_arn        = (known after apply)\n+ private_dns_name   = (known after apply)\n+ private_ip         = (known after apply)\n+ private_ips        = (known after apply)\n+ private_ips_count  = (known after apply)\n+ security_groups    = (known after apply)\n+ source_dest_check  = true\n+ subnet_id          = (known after apply)\n+ tags               = {\n+ \"Name\" = \"interface_public_02\"\n}\n+ attachment {\n+ attachment_id = (known after apply)\n+ device_index  = (known after apply)\n+ instance      = (known after apply)\n}\n}\n# aws_route.public_sub_IGW will be created\n+ resource \"aws_route\" \"public_sub_IGW\" {\n+ destination_cidr_block     = \"0.0.0.0/0\"\n+ destination_prefix_list_id = (known after apply)\n+ egress_only_gateway_id     = (known after apply)\n+ gateway_id                 = (known after apply)\n+ id                         = (known after apply)\n+ instance_id                = (known after apply)\n+ instance_owner_id          = (known after apply)\n+ local_gateway_id           = (known after apply)\n+ nat_gateway_id             = (known after apply)\n+ network_interface_id       = (known after apply)\n+ origin                     = (known after apply)\n+ route_table_id             = (known after apply)\n+ state                      = (known after apply)\n}\n# aws_route_table.public will be created\n+ resource \"aws_route_table\" \"public\" {\n+ id               = (known after apply)\n+ owner_id         = (known after apply)\n+ propagating_vgws = (known after apply)\n+ route            = (known after apply)\n+ tags             = {\n+ \"Name\" = \"public_route_table\"\n}\n+ vpc_id           = (known after apply)\n}\n# aws_route_table_association.public_01_association will be created\n+ resource \"aws_route_table_association\" \"public_01_association\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_route_table_association.public_02_association will be created\n+ resource \"aws_route_table_association\" \"public_02_association\" {\n+ id             = (known after apply)\n+ route_table_id = (known after apply)\n+ subnet_id      = (known after apply)\n}\n# aws_security_group.practice_01 will be created\n+ resource \"aws_security_group\" \"practice_01\" {\n+ arn                    = (known after apply)\n+ description            = \"SG_for_EC2\"\n+ egress                 = [\n+ {\n+ cidr_blocks      = [\n+ \"0.0.0.0/0\",\n]\n+ description      = \"open all port from anywhere\"\n+ from_port        = 0\n+ ipv6_cidr_blocks = []\n+ prefix_list_ids  = []\n+ protocol         = \"-1\"\n+ security_groups  = []\n+ self             = false\n+ to_port          = 0\n},\n]\n+ id                     = (known after apply)\n+ ingress                = [\n+ {\n+ cidr_blocks      = [\n+ \"0.0.0.0/0\",\n]\n+ description      = \"open SSH from Anywhere\"\n+ from_port        = 22\n+ ipv6_cidr_blocks = []\n+ prefix_list_ids  = []\n+ protocol         = \"tcp\"\n+ security_groups  = []\n+ self             = false\n+ to_port          = 22\n},\n]\n+ name                   = \"practice_01_SG\"\n+ name_prefix            = (known after apply)\n+ owner_id               = (known after apply)\n+ revoke_rules_on_delete = false\n+ vpc_id                 = (known after apply)\n}\n# aws_subnet.public_01 will be created\n+ resource \"aws_subnet\" \"public_01\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2a\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.0.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = true\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"public_subnet_01\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_subnet.public_02 will be created\n+ resource \"aws_subnet\" \"public_02\" {\n+ arn                             = (known after apply)\n+ assign_ipv6_address_on_creation = false\n+ availability_zone               = \"ap-northeast-2c\"\n+ availability_zone_id            = (known after apply)\n+ cidr_block                      = \"10.0.1.0/24\"\n+ id                              = (known after apply)\n+ ipv6_cidr_block_association_id  = (known after apply)\n+ map_public_ip_on_launch         = true\n+ owner_id                        = (known after apply)\n+ tags                            = {\n+ \"Name\" = \"public_subnet_02\"\n}\n+ vpc_id                          = (known after apply)\n}\n# aws_vpc.main will be created\n+ resource \"aws_vpc\" \"main\" {\n+ arn                              = (known after apply)\n+ assign_generated_ipv6_cidr_block = false\n+ cidr_block                       = \"10.0.0.0/16\"\n+ default_network_acl_id           = (known after apply)\n+ default_route_table_id           = (known after apply)\n+ default_security_group_id        = (known after apply)\n+ dhcp_options_id                  = (known after apply)\n+ enable_classiclink               = (known after apply)\n+ enable_classiclink_dns_support   = (known after apply)\n+ enable_dns_hostnames             = true\n+ enable_dns_support               = true\n+ id                               = (known after apply)\n+ instance_tenancy                 = \"default\"\n+ ipv6_association_id              = (known after apply)\n+ ipv6_cidr_block                  = (known after apply)\n+ main_route_table_id              = (known after apply)\n+ owner_id                         = (known after apply)\n+ tags                             = {\n+ \"Name\" = \"vpc_practice_01\"\n}\n}\nPlan: 14 to add, 0 to change, 0 to destroy.\n</code></pre> </li> <li> <p>\uacb0\uacfc</p> <p></p> <p></p> <p></p> <p>EC2 SSH \uc811\uc18d\uae4c\uc9c0 \uc131\uacf5</p> </li> </ul>"},{"location":"Terraform/Terraform%20Practice/#2-rds-bastion","title":"\uc5f0\uc2b52 (RDS, Bastion)","text":"<ul> <li> <p>\uad6c\uc131</p> <p></p> </li> <li> <p>\ucf54\ub4dc</p> <ul> <li>variables.tf</li> </ul> variables.tf<pre><code>variable \"aws_region\" {\ndescription = \"region for AWS\"\n}\nvariable \"vpc_name\" {\ndescription = \"name for practice_02 VPC\"\n}\nvariable \"subnet_name\" {\n}\nvariable \"instance_names\" {\ntype = list(string)\n}\nvariable \"az\" {\ntype    = list(string)\ndefault = [\"ap-northeast-2a\"]\n}\nvariable \"ami_id_maps\" {\ntype    = map(any)\ndefault = {}\n}\nvariable \"instance_type\" {\n}\n</code></pre> <pre><code>- terraform.tfvars\n</code></pre> <pre><code>aws_region = \"ap-northeast-2\"\n\nvpc_name = \"vpc_practice_02\"\n\nsubnet_name = \"subnet_practice_02\"\n\naz = [\n    \"ap-northeast-2a\", \n    \"ap-northeast-2c\"\n]\n\ninstance_names = [\n    \"public-01\", \n    \"public-02\"\n]\n\nami_id_maps = {\n    amazon_linux_2 = \"ami-006e2f9fa7597680a\"\n    ubuntu_20_04 = \"ami-00f1068284b9eca92\"\n}\n\ninstance_type = \"t2.micro\"\n</code></pre> <ul> <li>provider.tf</li> </ul> <pre><code>provider \"aws\" {\n  region = var.aws_region\n}\n</code></pre> <ul> <li>vpc.tf</li> </ul> <pre><code>#------------VPC-------------\nresource \"aws_vpc\" \"main\" {\n  cidr_block       = \"10.0.0.0/16\"\n  instance_tenancy = \"default\"\n\n  enable_dns_support = \"true\"\n\n  tags = {\n    Name = var.vpc_name\n  }\n}\n################PUBLIC SUBNET#################\n#-------------IGW---------------\nresource \"aws_internet_gateway\" \"default\" {\n  vpc_id = aws_vpc.main.id\n\n  tags = {\n    Name = \"practice_02\"\n  }\n}\n#------------subnet-------------\nresource \"aws_subnet\" \"public\" {\n  vpc_id     = aws_vpc.main.id\n  cidr_block = \"10.0.0.0/24\"\n\n  availability_zone = var.az[0]\n\n  map_public_ip_on_launch = true\n\n  tags = {\n    \"Name\" = \"public_subnet\"\n  }\n}\n#------------association-------------\nresource \"aws_route_table_association\" \"association1\" {\n  subnet_id      = aws_subnet.public.id\n  route_table_id = aws_route_table.public.id\n}\n#------------router table------------\nresource \"aws_route_table\" \"public\" {\n  vpc_id = aws_vpc.main.id\n\n  route {\n    cidr_block = \"0.0.0.0/0\"\n    gateway_id = aws_internet_gateway.default.id\n  }\n\n  tags = {\n    \"Name\" = \"public_table\"\n  }\n}\n################PRIVATE SUBNET#################\n#-------------subnet-------------\nresource \"aws_subnet\" \"private\" {\n  vpc_id = aws_vpc.main.id\n\n  availability_zone = var.az[0]\n\n  cidr_block = \"10.0.1.0/24\"\n}\n\nresource \"aws_subnet\" \"private2\" {\n  vpc_id = aws_vpc.main.id\n\n  availability_zone = var.az[1]\n\n  cidr_block = \"10.0.2.0/24\"\n}\n</code></pre> <ul> <li>ec2.tf</li> </ul> <pre><code>#----------------SG---------------------\nresource \"aws_security_group\" \"public_ec2\" {\n  vpc_id = aws_vpc.main.id\n\n  name        = \"allow SSH\"\n  description = \"allow SSH from anywhere\"\n\n  ingress {\n    from_port   = 22\n    to_port     = 22\n    protocol    = \"tcp\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  egress {\n    from_port   = 0\n    to_port     = 0\n    protocol    = \"-1\"\n    cidr_blocks = [\"0.0.0.0/0\"]\n  }\n\n  tags = {\n    \"Name\" = \"SG-for-publicEC2\"\n  }\n}\n#-------------Key pair--------------\nresource \"aws_key_pair\" \"dotoryeee\" {\n  key_name   = \"dotoryeee\"\n  public_key = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDD5D5mHSD/vdgcGmh6Kd57DqLxebcvbrUsHj8DYDW0+9MSvvK874Bm4hpqHliYze/ht7VnzL5+A5qZkCevKGBDeJNmR/QDHccCsCfRuyEmzMlvj3SxzYSH2N4lBG6eZZbQ+0yRl7ny3aeyol5boDkztLZ/PZwVR5IH6BgsNiGClSDtuf2CYoKN7hQufjeuCDcLlQa+ItFa4abMe/mWtMeEh7+ZpC+0KAFFvqY80OCtuUdqq7tcP8uHzQy9mPKvKBieJYitUoStjFEMAro1v34u6193Qgk6DAhyMom4GmLc2+tTyKMsvBlRKUOb87F+2zsATX3Ahz9cMpEkfPTkY15V dotoryeee@i5-6500\"\n}\n#----------------EC2---------------------\nresource \"aws_instance\" \"public_01\" {\n  ami           = var.ami_id_maps[\"amazon_linux_2\"]\n  instance_type = var.instance_type\n\n  subnet_id = aws_subnet.public.id\n\n  security_groups = [aws_security_group.public_ec2.id]\n\n  key_name = aws_key_pair.dotoryeee.key_name\n\n  tags = {\n    Name = var.instance_names[0]\n  }\n}\n\nresource \"aws_instance\" \"public_02\" {\n  ami           = var.ami_id_maps[\"ubuntu_20_04\"]\n  instance_type = var.instance_type\n\n  subnet_id = aws_subnet.public.id\n\n  security_groups = [aws_security_group.public_ec2.id]\n\n  key_name = aws_key_pair.dotoryeee.key_name\n\n  tags = {\n    Name = var.instance_names[1]\n  }\n}\n</code></pre> </li> <li> <p>rds.tf</p> rds.tf<pre><code>#--------------Security Group----------------\nresource \"aws_security_group\" \"rds\" {\nvpc_id = aws_vpc.main.id\nname   = \"SG-for-RDS\"\ningress {\nfrom_port       = 3306\nto_port         = 3306\nprotocol        = \"tcp\"\nsecurity_groups = [aws_security_group.public_ec2.id]\n}\n}\n#---------------RDS Subnet Group--------\nresource \"aws_db_subnet_group\" \"_\" {\nname = \"subnet_for_rds\"\nsubnet_ids = [\naws_subnet.private.id,\naws_subnet.private2.id\n]\n}\n#----------------RDS instance-------------\nresource \"aws_db_instance\" \"_\" {\n  #settings for Free tier\ninstance_class      = \"db.t2.micro\"\nskip_final_snapshot = true\nallocated_storage   = 10\nengine              = \"mysql\"\nengine_version      = \"5.7\"\n  #settings for Free tier\nidentifier = \"demodb\"\nusername   = \"root\"\npassword   = \"password\"\nname       = \"mydb\"\ndb_subnet_group_name = aws_db_subnet_group._.name\nvpc_security_group_ids = [aws_security_group.rds.id]\n}\n</code></pre> <ul> <li>terraform apply</li> </ul> <pre><code>An execution plan has been generated and is shown below.\nResource actions are indicated with the following symbols:\n  + create\n\nTerraform will perform the following actions:\n\n  # aws_db_instance._ will be created\n  + resource \"aws_db_instance\" \"_\" {\n      + address                               = (known after apply)\n      + allocated_storage                     = 10\n      + apply_immediately                     = (known after apply)\n      + arn                                   = (known after apply)\n      + auto_minor_version_upgrade            = true\n      + availability_zone                     = (known after apply)\n      + backup_retention_period               = (known after apply)\n      + backup_window                         = (known after apply)\n      + ca_cert_identifier                    = (known after apply)\n      + character_set_name                    = (known after apply)\n      + copy_tags_to_snapshot                 = false\n      + db_subnet_group_name                  = \"subnet_for_rds\"\n      + delete_automated_backups              = true\n      + endpoint                              = (known after apply)\n      + engine                                = \"mysql\"\n      + engine_version                        = \"5.7\"\n      + hosted_zone_id                        = (known after apply)\n      + id                                    = (known after apply)\n      + identifier                            = \"demodb\"\n      + identifier_prefix                     = (known after apply)\n      + instance_class                        = \"db.t2.micro\"\n      + kms_key_id                            = (known after apply)\n      + latest_restorable_time                = (known after apply)\n      + license_model                         = (known after apply)\n      + maintenance_window                    = (known after apply)\n      + monitoring_interval                   = 0\n      + monitoring_role_arn                   = (known after apply)\n      + multi_az                              = (known after apply)\n      + name                                  = \"mydb\"\n      + option_group_name                     = (known after apply)\n      + parameter_group_name                  = (known after apply)\n      + password                              = (sensitive value)\n      + performance_insights_enabled          = false\n      + performance_insights_kms_key_id       = (known after apply)\n      + performance_insights_retention_period = (known after apply)\n      + port                                  = (known after apply)\n      + publicly_accessible                   = false\n      + replicas                              = (known after apply)\n      + resource_id                           = (known after apply)\n      + skip_final_snapshot                   = true\n      + status                                = (known after apply)\n      + storage_type                          = (known after apply)\n      + timezone                              = (known after apply)\n      + username                              = \"root\"\n      + vpc_security_group_ids                = (known after apply)\n    }\n\n  # aws_db_subnet_group._ will be created\n  + resource \"aws_db_subnet_group\" \"_\" {\n      + arn         = (known after apply)\n      + description = \"Managed by Terraform\"\n      + id          = (known after apply)\n      + name        = \"subnet_for_rds\"\n      + name_prefix = (known after apply)\n      + subnet_ids  = (known after apply)\n    }\n\n  # aws_instance.public_01 will be created\n  + resource \"aws_instance\" \"public_01\" {\n      + ami                          = \"ami-006e2f9fa7597680a\"\n      + arn                          = (known after apply)\n      + associate_public_ip_address  = (known after apply)\n      + availability_zone            = (known after apply)\n      + cpu_core_count               = (known after apply)\n      + cpu_threads_per_core         = (known after apply)\n      + get_password_data            = false\n      + host_id                      = (known after apply)\n      + id                           = (known after apply)\n      + instance_state               = (known after apply)\n      + instance_type                = \"t2.micro\"\n      + ipv6_address_count           = (known after apply)\n      + ipv6_addresses               = (known after apply)\n      + key_name                     = \"dotoryeee\"\n      + outpost_arn                  = (known after apply)\n      + password_data                = (known after apply)\n      + placement_group              = (known after apply)\n      + primary_network_interface_id = (known after apply)\n      + private_dns                  = (known after apply)\n      + private_ip                   = (known after apply)\n      + public_dns                   = (known after apply)\n      + public_ip                    = (known after apply)\n      + secondary_private_ips        = (known after apply)\n      + security_groups              = (known after apply)\n      + source_dest_check            = true\n      + subnet_id                    = (known after apply)\n      + tags                         = {\n          + \"Name\" = \"public-01\"\n        }\n      + tenancy                      = (known after apply)\n      + vpc_security_group_ids       = (known after apply)\n\n      + ebs_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + snapshot_id           = (known after apply)\n          + tags                  = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n\n      + enclave_options {\n          + enabled = (known after apply)\n        }\n\n      + ephemeral_block_device {\n          + device_name  = (known after apply)\n          + no_device    = (known after apply)\n          + virtual_name = (known after apply)\n        }\n\n      + metadata_options {\n          + http_endpoint               = (known after apply)\n          + http_put_response_hop_limit = (known after apply)\n          + http_tokens                 = (known after apply)\n        }\n\n      + network_interface {\n          + delete_on_termination = (known after apply)\n          + device_index          = (known after apply)\n          + network_interface_id  = (known after apply)\n        }\n\n      + root_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + tags                  = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n    }\n\n  # aws_instance.public_02 will be created\n  + resource \"aws_instance\" \"public_02\" {\n      + ami                          = \"ami-00f1068284b9eca92\"\n      + arn                          = (known after apply)\n      + associate_public_ip_address  = (known after apply)\n      + availability_zone            = (known after apply)\n      + cpu_core_count               = (known after apply)\n      + cpu_threads_per_core         = (known after apply)\n      + get_password_data            = false\n      + host_id                      = (known after apply)\n      + id                           = (known after apply)\n      + instance_state               = (known after apply)\n      + instance_type                = \"t2.micro\"\n      + ipv6_address_count           = (known after apply)\n      + ipv6_addresses               = (known after apply)\n      + key_name                     = \"dotoryeee\"\n      + outpost_arn                  = (known after apply)\n      + password_data                = (known after apply)\n      + placement_group              = (known after apply)\n      + primary_network_interface_id = (known after apply)\n      + private_dns                  = (known after apply)\n      + private_ip                   = (known after apply)\n      + public_dns                   = (known after apply)\n      + public_ip                    = (known after apply)\n      + secondary_private_ips        = (known after apply)\n      + security_groups              = (known after apply)\n      + source_dest_check            = true\n      + subnet_id                    = (known after apply)\n      + tags                         = {\n          + \"Name\" = \"public-02\"\n        }\n      + tenancy                      = (known after apply)\n      + vpc_security_group_ids       = (known after apply)\n\n      + ebs_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + snapshot_id           = (known after apply)\n          + tags                  = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n\n      + enclave_options {\n          + enabled = (known after apply)\n        }\n\n      + ephemeral_block_device {\n          + device_name  = (known after apply)\n          + no_device    = (known after apply)\n          + virtual_name = (known after apply)\n        }\n\n      + metadata_options {\n          + http_endpoint               = (known after apply)\n          + http_put_response_hop_limit = (known after apply)\n          + http_tokens                 = (known after apply)\n        }\n\n      + network_interface {\n          + delete_on_termination = (known after apply)\n          + device_index          = (known after apply)\n          + network_interface_id  = (known after apply)\n        }\n\n      + root_block_device {\n          + delete_on_termination = (known after apply)\n          + device_name           = (known after apply)\n          + encrypted             = (known after apply)\n          + iops                  = (known after apply)\n          + kms_key_id            = (known after apply)\n          + tags                  = (known after apply)\n          + throughput            = (known after apply)\n          + volume_id             = (known after apply)\n          + volume_size           = (known after apply)\n          + volume_type           = (known after apply)\n        }\n    }\n\n  # aws_internet_gateway.default will be created\n  + resource \"aws_internet_gateway\" \"default\" {\n      + arn      = (known after apply)\n      + id       = (known after apply)\n      + owner_id = (known after apply)\n      + tags     = {\n          + \"Name\" = \"practice_02\"\n        }\n      + vpc_id   = (known after apply)\n    }\n\n  # aws_key_pair.dotoryeee will be created\n  + resource \"aws_key_pair\" \"dotoryeee\" {\n      + arn         = (known after apply)\n      + fingerprint = (known after apply)\n      + id          = (known after apply)\n      + key_name    = \"dotoryeee\"\n      + key_pair_id = (known after apply)\n      + public_key  = \"ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQDD5D5mHSD/vdgcGmh6Kd57DqLxebcvbrUsHj8DYDW0+9MSvvK874Bm4hpqHliYze/ht7VnzL5+A5qZkCevKGBDeJNmR/QDHccCsCfRuyEmzMlvj3SxzYSH2N4lBG6eZZbQ+0yRl7ny3aeyol5boDkztLZ/PZwVR5IH6BgsNiGClSDtuf2CYoKN7hQufjeuCDcLlQa+ItFa4abMe/mWtMeEh7+ZpC+0KAFFvqY80OCtuUdqq7tcP8uHzQy9mPKvKBieJYitUoStjFEMAro1v34u6193Qgk6DAhyMom4GmLc2+tTyKMsvBlRKUOb87F+2zsATX3Ahz9cMpEkfPTkY15V dotoryeee@i5-6500\"\n    }\n\n  # aws_route_table.public will be created\n  + resource \"aws_route_table\" \"public\" {\n      + id               = (known after apply)\n      + owner_id         = (known after apply)\n      + propagating_vgws = (known after apply)\n      + route            = [\n          + {\n              + cidr_block                = \"0.0.0.0/0\"\n              + egress_only_gateway_id    = \"\"\n              + gateway_id                = (known after apply)\n              + instance_id               = \"\"\n              + ipv6_cidr_block           = \"\"\n              + local_gateway_id          = \"\"\n              + nat_gateway_id            = \"\"\n              + network_interface_id      = \"\"\n              + transit_gateway_id        = \"\"\n              + vpc_endpoint_id           = \"\"\n              + vpc_peering_connection_id = \"\"\n            },\n        ]\n      + tags             = {\n          + \"Name\" = \"public_table\"\n        }\n      + vpc_id           = (known after apply)\n    }\n\n  # aws_route_table_association.association1 will be created\n  + resource \"aws_route_table_association\" \"association1\" {\n      + id             = (known after apply)\n      + route_table_id = (known after apply)\n      + subnet_id      = (known after apply)\n    }\n\n  # aws_security_group.public_ec2 will be created\n  + resource \"aws_security_group\" \"public_ec2\" {\n      + arn                    = (known after apply)\n      + description            = \"allow SSH from anywhere\"\n      + egress                 = [\n          + {\n              + cidr_blocks      = [\n                  + \"0.0.0.0/0\",\n                ]\n              + description      = \"\"\n              + from_port        = 0\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"-1\"\n              + security_groups  = []\n              + self             = false\n              + to_port          = 0\n            },\n        ]\n      + id                     = (known after apply)\n      + ingress                = [\n          + {\n              + cidr_blocks      = [\n                  + \"0.0.0.0/0\",\n                ]\n              + description      = \"\"\n              + from_port        = 22\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"tcp\"\n              + security_groups  = []\n              + self             = false\n              + to_port          = 22\n            },\n        ]\n      + name                   = \"allow SSH\"\n      + name_prefix            = (known after apply)\n      + owner_id               = (known after apply)\n      + revoke_rules_on_delete = false\n      + tags                   = {\n          + \"Name\" = \"SG-for-publicEC2\"\n        }\n      + vpc_id                 = (known after apply)\n    }\n\n  # aws_security_group.rds will be created\n  + resource \"aws_security_group\" \"rds\" {\n      + arn                    = (known after apply)\n      + description            = \"Managed by Terraform\"\n      + egress                 = (known after apply)\n      + id                     = (known after apply)\n      + ingress                = [\n          + {\n              + cidr_blocks      = []\n              + description      = \"\"\n              + from_port        = 3306\n              + ipv6_cidr_blocks = []\n              + prefix_list_ids  = []\n              + protocol         = \"tcp\"\n              + security_groups  = (known after apply)\n              + self             = false\n              + to_port          = 3306\n            },\n        ]\n      + name                   = \"SG-for-RDS\"\n      + name_prefix            = (known after apply)\n      + owner_id               = (known after apply)\n      + revoke_rules_on_delete = false\n      + vpc_id                 = (known after apply)\n    }\n\n  # aws_subnet.private will be created\n  + resource \"aws_subnet\" \"private\" {\n      + arn                             = (known after apply)\n      + assign_ipv6_address_on_creation = false\n      + availability_zone               = \"ap-northeast-2a\"\n      + availability_zone_id            = (known after apply)\n      + cidr_block                      = \"10.0.1.0/24\"\n      + id                              = (known after apply)\n      + ipv6_cidr_block_association_id  = (known after apply)\n      + map_public_ip_on_launch         = false\n      + owner_id                        = (known after apply)\n      + vpc_id                          = (known after apply)\n    }\n\n  # aws_subnet.private2 will be created\n  + resource \"aws_subnet\" \"private2\" {\n      + arn                             = (known after apply)\n      + assign_ipv6_address_on_creation = false\n      + availability_zone               = \"ap-northeast-2c\"\n      + availability_zone_id            = (known after apply)\n      + cidr_block                      = \"10.0.2.0/24\"\n      + id                              = (known after apply)\n      + ipv6_cidr_block_association_id  = (known after apply)\n      + map_public_ip_on_launch         = false\n      + owner_id                        = (known after apply)\n      + vpc_id                          = (known after apply)\n    }\n\n  # aws_subnet.public will be created\n  + resource \"aws_subnet\" \"public\" {\n      + arn                             = (known after apply)\n      + assign_ipv6_address_on_creation = false\n      + availability_zone               = \"ap-northeast-2a\"\n      + availability_zone_id            = (known after apply)\n      + cidr_block                      = \"10.0.0.0/24\"\n      + id                              = (known after apply)\n      + ipv6_cidr_block_association_id  = (known after apply)\n      + map_public_ip_on_launch         = true\n      + owner_id                        = (known after apply)\n      + tags                            = {\n          + \"Name\" = \"public_subnet\"\n        }\n      + vpc_id                          = (known after apply)\n    }\n\n  # aws_vpc.main will be created\n  + resource \"aws_vpc\" \"main\" {\n      + arn                              = (known after apply)\n      + assign_generated_ipv6_cidr_block = false\n      + cidr_block                       = \"10.0.0.0/16\"\n      + default_network_acl_id           = (known after apply)\n      + default_route_table_id           = (known after apply)\n      + default_security_group_id        = (known after apply)\n      + dhcp_options_id                  = (known after apply)\n      + enable_classiclink               = (known after apply)\n      + enable_classiclink_dns_support   = (known after apply)\n      + enable_dns_hostnames             = (known after apply)\n      + enable_dns_support               = true\n      + id                               = (known after apply)\n      + instance_tenancy                 = \"default\"\n      + ipv6_association_id              = (known after apply)\n      + ipv6_cidr_block                  = (known after apply)\n      + main_route_table_id              = (known after apply)\n      + owner_id                         = (known after apply)\n      + tags                             = {\n          + \"Name\" = \"vpc_practice_02\"\n        }\n    }\n\nPlan: 14 to add, 0 to change, 0 to destroy.\n</code></pre> </li> <li> <p>\uacb0\uacfc</p> <ul> <li> <p>\ucf58\uc194\uc5d0\uc11c EC2 \ud655\uc778</p> <p></p> </li> <li> <p>\ubc30\uc2a4\ucc9c \uc778\uc2a4\ud134\uc2a4\uc5d0 SSH \uc811\uc18d</p> <p></p> </li> <li> <p>\uc790\ub3d9\uc73c\ub85c \uc138\ud305 \uc644\ub8cc\ub41c RDS \uc11c\ubc84</p> <p></p> </li> <li> <p>Datagrip \ud130\ub110\ub9c1 \uc138\ud305</p> <p></p> </li> <li> <p>Datagrip DB\uc811\uc18d \uc138\ud305</p> <p></p> </li> <li> <p>Bastion\uc744 \uc774\uc6a9\ud55c RDS DB \uc811\uc18d \uc131\uacf5</p> <p></p> </li> </ul> </li> </ul>"},{"location":"Terraform/Terraform%20Practice/#3-application-load-balancer","title":"\uc5f0\uc2b53 (Application Load Balancer)","text":"<ul> <li> <p>\uad6c\uc131</p> <p></p> </li> <li> <p>\ucf54\ub4dc</p> </li> <li> <p>\uad6c\uc131</p> </li> <li> <p>\ucf54\ub4dc</p> </li> </ul>"},{"location":"Terraform/Terraform%20deploy%20VPC%20and%20Subnet/","title":"Terraform deploy VPC and Subnet","text":""},{"location":"Terraform/Terraform%20deploy%20VPC%20and%20Subnet/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>AWS \uc11c\ube44\uc2a4\uc758 \uadfc\uac04\uc774\ub77c\uace0 \ud560 \uc218 \uc788\ub294 VPC\ubd80\ud130 IaC\ub97c \uad6c\ud604\ud574\ubd05\ub2c8\ub2e4</li> <li>VPC\uc5d0 \uc11c\ube0c\ub137\ub3c4 \uc0dd\uc131\ud574\ubd05\ub2c8\ub2e4</li> </ul>"},{"location":"Terraform/Terraform%20deploy%20VPC%20and%20Subnet/#deploy-vpc","title":"deploy VPC","text":"<p>Warning</p> <p>\ud83d\udca1 git \uc0ac\uc6a9\uc2dc .terraform \ub514\ub809\ud130\ub9ac\ub97c ignore \ucc98\ub9ac\ud569\ub2c8\ub2e4</p> <ol> <li> <p>provider \uc124\uc815\uc744 \ubd84\ub9ac\ud558\uc5ec \ub530\ub85c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi provider.tf\n</code></pre> provider.tf<pre><code>provider \"aws\" {\nregion = \"ap-northeast-2\"\n}\n</code></pre> </li> <li> <p>vpc\uc6a9 \ud14c\ub77c\ud3fc \ucf54\ub4dc\ub97c \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> vpc.tf<pre><code>resource \"aws_vpc\" \"terra-test\" {\ncidr_block = \"10.0.0.0/16\"\ntags = {\nName = \"Terraform TEST1\"\n}\n}\n</code></pre> </li> <li> <p>\ud14c\ub77c\ud3fc \ud50c\ub79c\uc744 \uc2e4\ud589\ud569\ub2c8\ub2e4</p> <pre><code>terraform plan\n</code></pre> </li> <li> <p>\ub2f9\uc5f0\ud788 init\uc744 \ud558\uc9c0 \uc54a\uc73c\uba74 \uc9c4\ud589\ud560 \uc218 \uc5c6\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ud14c\ub77c\ud3fc \uc2dc\uc791\uc744 \uc120\uc5b8\ud569\ub2c8\ub2e4</p> <pre><code>terraform init\n</code></pre> </li> <li> <p>\ud14c\ub77c\ud3fc\uc774 AWS\ub97c \ucee8\ud2b8\ub864 \ud560 \uc218 \uc788\ub294 \ud50c\ub7ec\uadf8\uc778\uc744 \ub2e4\uc6b4\ub85c\ub4dc \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc2dc plan\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>terraform plan\n</code></pre> </li> <li> <p>\ud604\uc7ac \uc791\uc131\ub41c \ud14c\ub77c\ud3fc \ucf54\ub4dc\uc5d0 \ub530\ub974\uba74 \uc544\ub798\uc640 \uac19\uc774 \uc778\ud504\ub77c\uac00 \uc0dd\uc131\ub41c\ub2e4\ub294 \uc608\uc0c1 \uacb0\uacfc\ub97c \ubcf4\uc5ec\uc90d\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubcf8\uaca9\uc801\uc73c\ub85c AWS\uc5d0 \uc778\ud504\ub77c \uc0dd\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\uacbd\uace0\ucc3d\uc774 \ub728\uba74 yes\ub97c \uc785\ub825\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc778\ud504\ub77c \uc0dd\uc131\uc5d0 \uc131\uacf5\ud558\uc600\uace0 \ud55c \uac1c\uc758 \ub9ac\uc18c\uc2a4(\uc5ec\uae30\uc120 terra-test\ub77c\ub294 VPC)\uac00 \uc0dd\uc131\ub418\uc5c8\uc74c\uc744 \uc548\ub0b4\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS \ucf58\uc194\uc5d0\uc11c \ud574\ub2f9 VPC\uc640 CIDR\uc744 \uc9c1\uc811 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20deploy%20VPC%20and%20Subnet/#deploy-subnet","title":"deploy Subnet","text":"<ol> <li> <p>\uc774\uc81c \uc11c\ube0c\ub137\uc744 \ucd94\uac00\ud569\ub2c8\ub2e4. </p> <p>\ud30c\uc77c\uc744 \ub530\ub85c \ubd84\ub9ac\ud560 \uc218 \uc788\uc9c0\ub9cc \uc77c\ub2e8 \ubcf4\uae30 \ud3b8\ud558\uac8c vpc\ucf54\ub4dc\uc5d0 \uc774\uc5b4\uc11c \uc791\uc5c5\ud569\ub2c8\ub2e4</p> <ul> <li>\uc11c\ube0c\ub137\uc744 \uc0dd\uc131\ud560 \ub54c VPC\ub97c \uc9c0\uc815\ud558\ub824\uba74 \ubcc0\uc218\ub97c \ub123\ub294 \uac83 \ucc98\ub7fc aws_vpc.{NAME}.id \ud615\ud0dc\ub85c \uc791\uc131\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</li> </ul> <pre><code>vi vpc.tf\n</code></pre> vpc.tf<pre><code>resource \"aws_vpc\" \"terra-test\" {\ncidr_block = \"10.0.0.0/16\"\ntags = {\nName = \"Terraform TEST1\"\n}\n}\nresource\"aws_subnet\" \"public01\" {\nvpc_id = aws_vpc.terra-test.id\ncidr_block = \"10.0.0.0/24\"\navailability_zone = \"ap-northeast-2a\"\ntags = {\nName = \"terra-public-01-subnet\"\n}\n}\nresource \"aws_subnet\" \"private01\" {\nvpc_id = aws_vpc.terra-test.id\ncidr_block = \"10.0.1.0/24\"\ntags = {\nName = \"terra-private-01-subnet\"\n}\n}\n</code></pre> </li> <li> <p>\ud14c\ub77c\ud3fc \ud50c\ub79c\uc744 \uc774\uc6a9\ud574 \uc798 \uc791\uc131\ud588\ub294\uc9c0 \uccb4\ud06c\ud569\ub2c8\ub2e4</p> <pre><code>terraform plan\n</code></pre> </li> <li> <p>\ud604\uc7ac \ucf54\ub4dc\uc5d0 3\uac1c\uc758 \ub9ac\uc18c\uc2a4(VPC, public subnet, private subnet)\uc774 \uc791\uc131\ub418\uc5b4\uc788\uc9c0\ub9cc</p> <p>VPC\ub294 \uc544\uae4c \ub9cc\ub4e4\uc5c8\uae30 \ub54c\ubb38\uc5d0 2\uac1c\uac00 \ucd94\uac00\ub41c\ub2e4\uace0 \uc548\ub0b4\ud558\uace0 \uc788\uc2b5\ub2c8\ub2e4</p> <p>AZ\ub97c \uc120\ud0dd\ud558\uc9c0 \uc54a\uc740 \uc11c\ube0c\ub137\uc740 \uc544\ubb34\ub370\ub098 \ub9cc\ub4e4\uc5b4\uc9d1\ub2c8\ub2e4</p> <p></p> </li> <li> <p>AWS \uc778\ud504\ub77c\uc5d0 \uc801\uc6a9\ud574\ubd05\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\uae08\ubc29 \uc0dd\uc131\ub429\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c \ud655\uc778\ud574\ubcf4\uba74 \uc798 \uc0dd\uc131\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ub2e4\uc74c \uba85\ub839\uc744 \uc774\uc6a9\ud558\uba74 \ud604\uc7ac \uc0dd\uc131\ub41c \ub9ac\uc2a4\ud2b8\ub97c \ubcfc \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <pre><code>terraform state list\n</code></pre> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20deploy%20VPC/","title":"Terraform deploy VPC","text":""},{"location":"Terraform/Terraform%20deploy%20VPC/#_1","title":"\ubaa9\ud45c","text":"<ul> <li>\uc11c\ube0c\ub137\uc774 public\uc778\uc9c0 private\uc778\uc9c0 \uacb0\uc815\ud558\ub294 \uac83\uc740 IGW\uc720\ubb34\uc785\ub2c8\ub2e4</li> <li>terraform\uc744 \uc774\uc6a9\ud574 IGW\uc640 NAT Gateway\ub97c \uc0dd\uc131\ubd05\ub2c8\ub2e4</li> <li>\ub124\ud2b8\uc6cc\ud06c \ud2b8\ub798\ud53d\uc758 Destination\uc744 \uc54c\ub824\uc8fc\ub294, \uc774\uc815\ud45c \uc5ed\ud560\uc744 \ud558\ub294 \ub77c\uc6b0\ud305 \ud14c\uc774\ube14\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</li> <li>\ub77c\uc6b0\ud2b8\ud14c\uc774\ube14\uc740 \uc0dd\uc131 \ud6c4 association(=\ub9e4\ud551)\uc744 \uc9c4\ud589\ud569\ub2c8\ub2e4. Terraform\uc73c\ub85c \uc774\ub97c \uad6c\ud604\ud574\ubd05\ub2c8\ub2e4</li> </ul>"},{"location":"Terraform/Terraform%20deploy%20VPC/#deploy-igw-nat","title":"deploy IGW, NAT","text":"<ol> <li> <p>\uc774\uc804\uc5d0 \uc791\uc131\ud588\ub358 vpc.tf\uc5d0 \uc774\uc5b4\uc11c \uc791\uc5c5\ud569\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> vpc.tf<pre><code>resource \"aws_internet_gateway\" \"igw\" {\nvpc_id = aws_vpc.terra-test.id\ntags = {\nName = \"terra-IGW\"\n}\n}\n</code></pre> </li> <li> <p>\uc791\uc131\ud588\uc73c\uba74 \ud50c\ub79c \uba85\ub839\uc73c\ub85c \ud655\uc778\ud569\ub2c8\ub2e4</p> <pre><code>terraform plan\n</code></pre> </li> <li> <p>\ud50c\ub79c\uc73c\ub85c \ud655\uc778\ud55c \uc608\uc0c1\uc791\uc5c5\uc774 \uc758\ub3c4\ud55c\ub300\ub85c IGW\ub97c \ucd94\uac00\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc778\ud504\ub77c\uc5d0 \uc801\uc6a9\ud569\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\uc774\uc5b4\uc11c NAT Gateway\ub97c \ud55c \uac1c \uc791\uc131\ud569\ub2c8\ub2e4</p> <p>NAT Gateway\ub294 EIP\uac00 \ud544\uc694\ud558\uae30 \ub54c\ubb38\uc5d0 \ubc18\ub4dc\uc2dc \uac19\uc774 \uc791\uc131\ud569\ub2c8\ub2e4</p> <p>NAT Gateway\ub294 public \uc11c\ube0c\ub137\uc5d0 \uc874\uc7ac\ud574\uc57c \ud568\uc744 \uc0dd\uac01\ud558\uace0 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi VPC.tf\n</code></pre> vpc.tf<pre><code>resource \"aws_eip\" \"terraEIP\" {\nvpc = true\nlifecycle {\ncreate_before_destroy = true\n}\n}\nresource \"aws_nat_gateway\" \"nat\" {\nallocation_id = aws_eip.terraEIP.id\nsubnet_id = aws_subnet.private01.id\ntags = {\nName = \"terra_NAT\"\n}\n}\n</code></pre> </li> <li> <p>terraform plan\uc744 \uc774\uc6a9\ud558\uba74 \uc774\ubc88\uc5d0\ub3c4 \uc798 \uc791\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\ubc14\ub85c \uc801\uc6a9\ud569\ub2c8\ub2e4. \ub2e4\ub9cc NAT Gateway \uc0dd\uc131\uc740 \ub2e4\ub978 \ub9ac\uc18c\uc2a4\uc5d0 \ube44\ud574 \ub9ce\uc740 \uc2dc\uac04\uc774 \uc18c\ubaa8\ub429\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> <p></p> </li> <li> <p>NAT Gateway\uac00 \uc798 \uc0dd\uc131\ub41c \uac83\uc744 \ucf58\uc194\uc5d0\uc11c\ub3c4 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> <p></p> </li> <li> <p>NAT Gateway\ub294 \uc874\uc7ac\ub9cc\uc73c\ub85c\ub3c4 \ube44\uc6a9\uc774 \ubc1c\uc0dd\ud558\uae30 \ub584\ubb38\uc5d0 \uc0ac\uc6a9\ud558\uc9c0 \uc54a\uc73c\uba74 \ubc14\ub85c \uc0ad\uc81c\ud569\ub2c8\ub2e4</p> </li> <li> <p>\ud14c\ub77c\ud3fc\uc5d0\uc11c \uc0dd\uc131\ud55c \uc778\ud504\ub77c\ub97c \uc804\ubd80 \ub0a0\ub9ac\ub294 \uba85\ub839\uc5b4\ub294 \ub2e4\uc74c\uacfc \uac19\uc2b5\ub2c8\ub2e4</p> <pre><code>terraform destroy\n</code></pre> </li> <li> <p>NAT Gateway\ub9cc \uc0ad\uc81c\ud558\ub824\ub294 \uacbd\uc6b0 NAT Gateway\ub97c \uc8fc\uc11d\ucc98\ub9ac\ud558\uace0 \uc5c5\ub370\uc774\ud2b8 \ud558\uba74 \ub429\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> </ol>"},{"location":"Terraform/Terraform%20deploy%20VPC/#build-route-table","title":"build Route-table","text":"<ol> <li> <p>\ubc14\ub85c \ucf54\ub4dc \uc218\uc815\uc5d0 \ub4e4\uc5b4\uac11\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> </li> <li> <p>\ub450 \uac1c\uc758 \ub77c\uc6b0\ud305 \ud14c\uc774\ube14\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> vpc.tf<pre><code>resource \"aws_route_table\" \"public\"{\nvpc_id = aws_vpc.terra-test.id\ntags = {\nName = \"terra_public_rt\"\n}\n}\nresource \"aws_route_table\" \"private\"{\nvpc_id = aws_vpc.terra-test.id\ntags = {\nName = \"terra_private_rt\"\n}\n}\n</code></pre> <p></p> </li> <li> <p>plan \ud574\ubcf4\uace0 \ubb38\uc81c \uc5c6\uc73c\uba74 \ubc14\ub85c \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\uc798 \uc0dd\uc131\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20deploy%20VPC/#association","title":"Association","text":"<ol> <li> <p>\uc774\uc81c \uc5b4\uc18c\uc2dc\uc5d0\uc774\uc158\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> </li> <li> <p>\uc5b4\uc18c\uc2dc\uc5d0\uc774\uc158\uc744 \uc791\uc131\ud569\ub2c8\ub2e4</p> </li> </ol> <p>\uc11c\ube0c\ub137id\uc640 \ub77c\uc6b0\ud305\ud14c\uc774\ube14id\uac00 \ud544\uc694\ud569\ub2c8\ub2e4</p> <pre><code>```terraform title=\"vpc.tf\" linenums=\"1\"\nresource \"aws_route_table_association\" \"public_association\"{\nsubnet_id = aws_subnet.public01.id\nroute_table_id = aws_route_table.public.id\n}\n\nresource \"aws_route_table_association\" \"private_association\" {\nsubnet_id = aws_subnet.private01.id\nroute_table_id = aws_route_table.private.id\n}\n```\n</code></pre> <ol> <li> <p>plan\uc5d0 \ubb38\uc81c\uac00 \uc5c6\uc73c\uba74 \ubc14\ub85c \uc0dd\uc131\uc744 \uc2dc\uc791\ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>\uc0dd\uc131\uc4f0</p> <pre><code>terraform apply\n</code></pre> </li> <li> <p>\ub77c\uc6b0\ud305\ud14c\uc774\ube14\uc774 \uc11c\ube0c\ub137\uc5d0 \uac01\uac01 \uc54c\ub9de\uac8c \ub9e4\ud551\ub418\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> <p></p> </li> </ol>"},{"location":"Terraform/Terraform%20deploy%20VPC/#make-routing-rule","title":"make Routing Rule","text":"<ol> <li> <p>\uc77c\ub2e8 \uc5ec\uae30\ub2e4 \uadf8\ub0e5 \uc791\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> </li> <li> <p>\ud37c\ube14\ub9ad\uc6a9 \ub77c\uc6b0\ud305\ud14c\uc774\ube14 \ub0b4\uc5d0\uc11c \ub77c\uc6b0\ud305\uc744 \uc120\uc5b8\ud560 \uc218\ub3c4 \uc788\uc2b5\ub2c8\ub2e4(inner rule)</p> vpc.tf<pre><code>route { cidr_block = \"0.0.0.0/0\"\ngateway_id = aws_internet_gateway.igw.id\n}\n</code></pre> <p></p> </li> <li> <p>\ucf58\uc194\uc5d0\uc11c Public Routing table\uc5d0 IGW\uac00 \uc5f0\uacb0\ub41c \uac83\uc744 \ud655\uc778\ud560 \uc218 \uc788\uc2b5\ub2c8\ub2e4</p> </li> </ol> <p>\uc774\uc81c public subnet\uc740 \uc778\ud130\ub137 \uc0ac\uc6a9\uc774 \uac00\ub2a5\ud574\uc84c\uc2b5\ub2c8\ub2e4</p> <p></p> <ol> <li> <p>\uc774\ubc88\uc5d4 inner rule\uc774 \uc544\ub2cc \ubc14\uae65\uc5d0\uc11c rule\uc744 \uc0dd\uc131\ud569\ub2c8\ub2e4</p> <pre><code>vi vpc.tf\n</code></pre> </li> <li> <p>\ub2e4\uc74c\uacfc \uac19\uc774 private route table\uc5d0 NAT \uac8c\uc774\ud2b8\uc6e8\uc774\ub97c \ubd80\ucc29\ud569\ub2c8\ub2e4</p> vpc.tf<pre><code>resource \"aws_route\" \"private_nat\" {\nroute_table_id = aws_route_table.private.id\ndestination_cidr_block = \"0.0.0.0/0\"\nnat_gateway_id = aws_nat_gateway.nat.id\n}\n</code></pre> </li> <li> <p>plan\ud6c4 \uc798 \uc791\uc131\ub418\uc5c8\uc73c\uba74 \ubc14\ub85c apply \ud569\ub2c8\ub2e4</p> <p></p> </li> <li> <p>private route table\uc5d0 NAT \uac8c\uc774\ud2b8\uc6e8\uc774\uac00 \uc798 \ubd99\uc5c8\uc2b5\ub2c8\ub2e4</p> <p></p> </li> </ol>"}]}